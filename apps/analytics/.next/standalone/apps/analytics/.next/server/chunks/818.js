"use strict";exports.id=818,exports.ids=[818],exports.modules={20168:(t,r,a)=>{let n;try{(n=a(6005).webcrypto)||(n=new(a(57903)).w)}catch(t){n=new(a(57903)).w}t.exports=n},25940:(t,r,a)=>{let{fetch:n,Blob:o,FormData:i,Headers:s,Request:l,Response:u,AbortController:c}=a(88829);t.exports=n,t.exports.RuntimeBlob=o,t.exports.RuntimeFormData=i,t.exports.RuntimeHeaders=s,t.exports.RuntimeRequest=l,t.exports.RuntimeResponse=u,t.exports.RuntimeAbortController=c,t.exports.RuntimeFetch=n},45767:(t,r,a)=>{a.d(r,{El:()=>tr,Ns:()=>ta});var n,o,i=a(82667),s=a.n(i);let mergeNextClerkPropsWithEnv=t=>({...t,frontendApi:t.frontendApi||process.env.NEXT_PUBLIC_CLERK_FRONTEND_API||"",publishableKey:t.publishableKey||"pk_test_Z3Jvd24tbmV3dC0zMy5jbGVyay5hY2NvdW50cy5kZXYk",clerkJSUrl:t.clerkJSUrl||process.env.NEXT_PUBLIC_CLERK_JS,clerkJSVersion:t.clerkJSVersion||process.env.NEXT_PUBLIC_CLERK_JS_VERSION,proxyUrl:t.proxyUrl||process.env.NEXT_PUBLIC_CLERK_PROXY_URL||"",domain:t.domain||process.env.NEXT_PUBLIC_CLERK_DOMAIN||"",isSatellite:t.isSatellite||"true"===process.env.NEXT_PUBLIC_CLERK_IS_SATELLITE,signInUrl:t.signInUrl||process.env.NEXT_PUBLIC_CLERK_SIGN_IN_URL||"",signUpUrl:t.signUpUrl||process.env.NEXT_PUBLIC_CLERK_SIGN_UP_URL||"",afterSignInUrl:t.afterSignInUrl||process.env.NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL||"",afterSignUpUrl:t.afterSignUpUrl||process.env.NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL||"",sdkMetadata:{name:"@clerk/nextjs",version:"4.27.1"}});var l=a(84535);let u=(0,l.createProxy)(String.raw`/Users/buckhalt/Code/complexdatacollective/error-analytics-microservice/node_modules/.pnpm/@clerk+nextjs@4.27.1_next@14.0.1_react-dom@18.2.0_react@18.2.0/node_modules/@clerk/nextjs/dist/esm/app-router/client/ClerkProvider.js`),{__esModule:c,$$typeof:d}=u;u.default;let h=(0,l.createProxy)(String.raw`/Users/buckhalt/Code/complexdatacollective/error-analytics-microservice/node_modules/.pnpm/@clerk+nextjs@4.27.1_next@14.0.1_react-dom@18.2.0_react@18.2.0/node_modules/@clerk/nextjs/dist/esm/app-router/client/ClerkProvider.js#ClientClerkProvider`);var isTestEnvironment=()=>!1,isProductionEnvironment=()=>{try{return!0}catch(t){}return!1},p=new Set,chunk_KJVJ4CFF_deprecated=(t,r,a)=>{let n=isTestEnvironment()||isProductionEnvironment(),o=a??t;p.has(o)||n||(p.add(o),console.warn(`Clerk - DEPRECATION WARNING: "${t}" is deprecated and will be removed in the next major release.
${r}`))},deprecatedProperty=(t,r,a,n=!1)=>{let o=n?t:t.prototype,i=o[r];Object.defineProperty(o,r,{get:()=>(chunk_KJVJ4CFF_deprecated(r,a,`${t.name}:${r}`),i),set(t){i=t}})},deprecatedObjectProperty=(t,r,a,n)=>{let o=t[r];Object.defineProperty(t,r,{get:()=>(chunk_KJVJ4CFF_deprecated(r,a,n),o),set(t){o=t}})};function isStaging(t){return t.endsWith(".lclstage.dev")||t.endsWith(".stgstage.dev")||t.endsWith(".clerkstage.dev")||t.endsWith(".accountsstage.dev")}function addClerkPrefix(t){let r;if(!t)return"";if(t.match(/^(clerk\.)+\w*$/))r=/(clerk\.)*(?=clerk\.)/;else{if(t.match(/\.clerk.accounts/))return t;r=/^(clerk\.)*/gi}let a=t.replace(r,"");return`clerk.${a}`}Object.getOwnPropertyDescriptor,Object.getOwnPropertyNames,Object.prototype.hasOwnProperty;var getClerkJsMajorVersionOrTag=(t,r)=>!r&&isStaging(t)?"canary":r&&r.split(".")[0]||"latest",getScriptUrl=(t,{pkgVersion:r,clerkJSVersion:a})=>{let n=t.replace(/http(s)?:\/\//,""),o=getClerkJsMajorVersionOrTag(t,r);return`https://${n}/npm/@clerk/clerk-js@${a||o}/dist/clerk.browser.js`};function wait(t){return new Promise(r=>setTimeout(r,t))}async function callWithRetry(t,r=1,a=5){try{return await t()}catch(n){if(r>=a)throw n;return await wait(2**r*100),callWithRetry(t,r+1,a)}}var isomorphicAtob=t=>"undefined"!=typeof atob&&"function"==typeof atob?atob(t):"undefined"!=typeof global&&global.Buffer?new global.Buffer(t,"base64").toString():t,m="pk_live_";function parsePublishableKey(t){if(!isPublishableKey(t=t||""))return null;let r=t.startsWith(m)?"production":"development",a=isomorphicAtob(t.split("_")[2]);return a.endsWith("$")?{instanceType:r,frontendApi:a=a.slice(0,-1)}:null}function isPublishableKey(t){t=t||"";let r=t.startsWith(m)||t.startsWith("pk_test_"),a=isomorphicAtob(t.split("_")[2]||"").endsWith("$");return r&&a}function createDevOrStagingUrlCache(){let t=[".lcl.dev",".stg.dev",".lclstage.dev",".stgstage.dev",".dev.lclclerk.com",".stg.lclclerk.com",".accounts.lclclerk.com","accountsstage.dev","accounts.dev"],r=new Map;return{isDevOrStagingUrl:a=>{if(!a)return!1;let n="string"==typeof a?a:a.hostname,o=r.get(n);return void 0===o&&(o=t.some(t=>n.endsWith(t)),r.set(n,o)),o}}}function isDevelopmentFromApiKey(t){return t.startsWith("test_")||t.startsWith("sk_test_")}function isProductionFromApiKey(t){return t.startsWith("live_")||t.startsWith("sk_live_")}function parseErrors(t=[]){return t.length>0?t.map(parseError):[]}function parseError(t){return{code:t.code,message:t.message,longMessage:t.long_message,meta:{paramName:t?.meta?.param_name,sessionId:t?.meta?.session_id,emailAddresses:t?.meta?.email_addresses,identifiers:t?.meta?.identifiers,zxcvbn:t?.meta?.zxcvbn}}}var y=class _ClerkAPIResponseError extends Error{constructor(t,{data:r,status:a,clerkTraceId:n}){super(t),this.toString=()=>{let t=`[${this.name}]
Message:${this.message}
Status:${this.status}
Serialized errors: ${this.errors.map(t=>JSON.stringify(t))}`;return this.clerkTraceId&&(t+=`
Clerk Trace ID: ${this.clerkTraceId}`),t},Object.setPrototypeOf(this,_ClerkAPIResponseError.prototype),this.status=a,this.message=t,this.clerkTraceId=n,this.clerkError=!0,this.errors=parseErrors(r)}};new Proxy({Expired:"expired",Failed:"failed"},{get:(t,r,a)=>(chunk_KJVJ4CFF_deprecated("MagicLinkErrorCode","Use `EmailLinkErrorCode` instead."),Reflect.get(t,r,a))});var g=Object.freeze({InvalidFrontendApiErrorMessage:"The frontendApi passed to Clerk is invalid. You can get your Frontend API key at https://dashboard.clerk.com/last-active?path=api-keys. (key={{key}})",InvalidProxyUrlErrorMessage:"The proxyUrl passed to Clerk is invalid. The expected value for proxyUrl is an absolute URL or a relative path with a leading '/'. (key={{url}})",InvalidPublishableKeyErrorMessage:"The publishableKey passed to Clerk is invalid. You can get your Publishable key at https://dashboard.clerk.com/last-active?path=api-keys. (key={{key}})",MissingPublishableKeyErrorMessage:"Missing publishableKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys."});function buildErrorThrower({packageName:t,customMessages:r}){let a=t,n={...g,...r};function buildMessage(t,r){if(!r)return`${a}: ${t}`;let n=t,o=t.matchAll(/{{([a-zA-Z0-9-_]+)}}/g);for(let t of o){let a=(r[t[1]]||"").toString();n=n.replace(`{{${t[1]}}}`,a)}return`${a}: ${n}`}return{setPackageName({packageName:t}){return"string"==typeof t&&(a=t),this},setMessages({customMessages:t}){return Object.assign(n,t||{}),this},throwInvalidPublishableKeyError(t){throw Error(buildMessage(n.InvalidPublishableKeyErrorMessage,t))},throwInvalidFrontendApiError(t){throw Error(buildMessage(n.InvalidFrontendApiErrorMessage,t))},throwInvalidProxyUrl(t){throw Error(buildMessage(n.InvalidProxyUrlErrorMessage,t))},throwMissingPublishableKeyError(){throw Error(buildMessage(n.MissingPublishableKeyErrorMessage))}}}var b=a(20168),S=a.n(b),v=a(25940),C=a(93970),w=a.n(C),A=a(42292),_=a.n(A),k=a(94403),E=class{constructor(t){this.request=t}requireId(t){if(!t)throw Error("A valid resource ID is required.")}},R=RegExp("/{1,}","g");function joinPaths(...t){return t.filter(t=>t).join("/").replace(R,"/")}var B="/allowlist_identifiers",P=class extends E{async getAllowlistIdentifierList(){return this.request({method:"GET",path:B})}async createAllowlistIdentifier(t){return this.request({method:"POST",path:B,bodyParams:t})}async deleteAllowlistIdentifier(t){return this.requireId(t),this.request({method:"DELETE",path:joinPaths(B,t)})}},I="/clients",T=class extends E{async getClientList(){return this.request({method:"GET",path:I})}async getClient(t){return this.requireId(t),this.request({method:"GET",path:joinPaths(I,t)})}verifyClient(t){return this.request({method:"POST",path:joinPaths(I,"verify"),bodyParams:{token:t}})}},O=class extends E{async deleteDomain(t){return this.request({method:"DELETE",path:joinPaths("/domains",t)})}},K="/email_addresses",U=class extends E{async getEmailAddress(t){return this.requireId(t),this.request({method:"GET",path:joinPaths(K,t)})}async createEmailAddress(t){return this.request({method:"POST",path:K,bodyParams:t})}async updateEmailAddress(t,r={}){return this.requireId(t),this.request({method:"PATCH",path:joinPaths(K,t),bodyParams:r})}async deleteEmailAddress(t){return this.requireId(t),this.request({method:"DELETE",path:joinPaths(K,t)})}},N=class extends E{async createEmail(t){return this.request({method:"POST",path:"/emails",bodyParams:t})}},L=buildErrorThrower({packageName:"@clerk/backend"}),{isDevOrStagingUrl:D}=createDevOrStagingUrlCache(),j=class extends E{async getInterstitial(){return chunk_KJVJ4CFF_deprecated("getInterstitial()",'Switch to `Clerk(...).localInterstitial(...)` from `import { Clerk } from "@clerk/backend"`.'),this.request({path:"internal/interstitial",method:"GET",headerParams:{"Content-Type":"text/html"}})}},W="/invitations",q=class extends E{async getInvitationList(t={}){return this.request({method:"GET",path:W,queryParams:t})}async createInvitation(t){return this.request({method:"POST",path:W,bodyParams:t})}async revokeInvitation(t){return this.requireId(t),this.request({method:"POST",path:joinPaths(W,t,"revoke")})}},{RuntimeFetch:H,RuntimeAbortController:M,RuntimeBlob:F,RuntimeFormData:V,RuntimeHeaders:z,RuntimeRequest:$,RuntimeResponse:J}=v,G=H.bind(globalThis),Y={crypto:S(),fetch:G,AbortController:M,Blob:F,FormData:V,Headers:z,Request:$,Response:J},Q="/organizations",X=class extends E{async getOrganizationList(t){return this.request({method:"GET",path:Q,queryParams:t})}async createOrganization(t){return this.request({method:"POST",path:Q,bodyParams:t})}async getOrganization(t){let r="organizationId"in t?t.organizationId:t.slug;return this.requireId(r),this.request({method:"GET",path:joinPaths(Q,r)})}async updateOrganization(t,r){return this.requireId(t),this.request({method:"PATCH",path:joinPaths(Q,t),bodyParams:r})}async updateOrganizationLogo(t,r){this.requireId(t);let a=new Y.FormData;return a.append("file",r?.file),a.append("uploader_user_id",r?.uploaderUserId),this.request({method:"PUT",path:joinPaths(Q,t,"logo"),formData:a})}async deleteOrganizationLogo(t){return this.requireId(t),this.request({method:"DELETE",path:joinPaths(Q,t,"logo")})}async updateOrganizationMetadata(t,r){return this.requireId(t),this.request({method:"PATCH",path:joinPaths(Q,t,"metadata"),bodyParams:r})}async deleteOrganization(t){return this.request({method:"DELETE",path:joinPaths(Q,t)})}async getOrganizationMembershipList(t){let{organizationId:r,limit:a,offset:n}=t;return this.requireId(r),this.request({method:"GET",path:joinPaths(Q,r,"memberships"),queryParams:{limit:a,offset:n}})}async createOrganizationMembership(t){let{organizationId:r,userId:a,role:n}=t;return this.requireId(r),this.request({method:"POST",path:joinPaths(Q,r,"memberships"),bodyParams:{userId:a,role:n}})}async updateOrganizationMembership(t){let{organizationId:r,userId:a,role:n}=t;return this.requireId(r),this.request({method:"PATCH",path:joinPaths(Q,r,"memberships",a),bodyParams:{role:n}})}async updateOrganizationMembershipMetadata(t){let{organizationId:r,userId:a,publicMetadata:n,privateMetadata:o}=t;return this.request({method:"PATCH",path:joinPaths(Q,r,"memberships",a,"metadata"),bodyParams:{publicMetadata:n,privateMetadata:o}})}async deleteOrganizationMembership(t){let{organizationId:r,userId:a}=t;return this.requireId(r),this.request({method:"DELETE",path:joinPaths(Q,r,"memberships",a)})}async getOrganizationInvitationList(t){let{organizationId:r,status:a,limit:n,offset:o}=t;return this.requireId(r),this.request({method:"GET",path:joinPaths(Q,r,"invitations"),queryParams:{status:a,limit:n,offset:o}})}async getPendingOrganizationInvitationList(t){chunk_KJVJ4CFF_deprecated("getPendingOrganizationInvitationList","Use `getOrganizationInvitationList` instead.");let{organizationId:r,limit:a,offset:n}=t;return this.requireId(r),this.request({method:"GET",path:joinPaths(Q,r,"invitations","pending"),queryParams:{limit:a,offset:n}})}async createOrganizationInvitation(t){let{organizationId:r,...a}=t;return this.requireId(r),this.request({method:"POST",path:joinPaths(Q,r,"invitations"),bodyParams:{...a}})}async getOrganizationInvitation(t){let{organizationId:r,invitationId:a}=t;return this.requireId(r),this.requireId(a),this.request({method:"GET",path:joinPaths(Q,r,"invitations",a)})}async revokeOrganizationInvitation(t){let{organizationId:r,invitationId:a,requestingUserId:n}=t;return this.requireId(r),this.request({method:"POST",path:joinPaths(Q,r,"invitations",a,"revoke"),bodyParams:{requestingUserId:n}})}},Z="/phone_numbers",ee=class extends E{async getPhoneNumber(t){return this.requireId(t),this.request({method:"GET",path:joinPaths(Z,t)})}async createPhoneNumber(t){return this.request({method:"POST",path:Z,bodyParams:t})}async updatePhoneNumber(t,r={}){return this.requireId(t),this.request({method:"PATCH",path:joinPaths(Z,t),bodyParams:r})}async deletePhoneNumber(t){return this.requireId(t),this.request({method:"DELETE",path:joinPaths(Z,t)})}},et="/redirect_urls",er=class extends E{async getRedirectUrlList(){return this.request({method:"GET",path:et})}async getRedirectUrl(t){return this.requireId(t),this.request({method:"GET",path:joinPaths(et,t)})}async createRedirectUrl(t){return this.request({method:"POST",path:et,bodyParams:t})}async deleteRedirectUrl(t){return this.requireId(t),this.request({method:"DELETE",path:joinPaths(et,t)})}},ea="/sessions",en=class extends E{async getSessionList(t){return this.request({method:"GET",path:ea,queryParams:t})}async getSession(t){return this.requireId(t),this.request({method:"GET",path:joinPaths(ea,t)})}async revokeSession(t){return this.requireId(t),this.request({method:"POST",path:joinPaths(ea,t,"revoke")})}async verifySession(t,r){return this.requireId(t),this.request({method:"POST",path:joinPaths(ea,t,"verify"),bodyParams:{token:r}})}async getToken(t,r){return this.requireId(t),(await this.request({method:"POST",path:joinPaths(ea,t,"tokens",r||"")})).jwt}},eo="/sign_in_tokens",ei=class extends E{async createSignInToken(t){return this.request({method:"POST",path:eo,bodyParams:t})}async revokeSignInToken(t){return this.requireId(t),this.request({method:"POST",path:joinPaths(eo,t,"revoke")})}},es=class extends E{async createSMSMessage(t){return this.request({method:"POST",path:"/sms_messages",bodyParams:t})}},el="/users",eu=class extends E{async getUserList(t={}){return this.request({method:"GET",path:el,queryParams:t})}async getUser(t){return this.requireId(t),this.request({method:"GET",path:joinPaths(el,t)})}async createUser(t){return this.request({method:"POST",path:el,bodyParams:t})}async updateUser(t,r={}){return this.requireId(t),this.request({method:"PATCH",path:joinPaths(el,t),bodyParams:r})}async updateUserProfileImage(t,r){this.requireId(t);let a=new Y.FormData;return a.append("file",r?.file),this.request({method:"POST",path:joinPaths(el,t,"profile_image"),formData:a})}async updateUserMetadata(t,r){return this.requireId(t),this.request({method:"PATCH",path:joinPaths(el,t,"metadata"),bodyParams:r})}async deleteUser(t){return this.requireId(t),this.request({method:"DELETE",path:joinPaths(el,t)})}async getCount(t={}){return this.request({method:"GET",path:joinPaths(el,"count"),queryParams:t})}async getUserOauthAccessToken(t,r){return this.requireId(t),this.request({method:"GET",path:joinPaths(el,t,"oauth_access_tokens",r)})}async disableUserMFA(t){return this.requireId(t),this.request({method:"DELETE",path:joinPaths(el,t,"mfa")})}async getOrganizationMembershipList(t){let{userId:r,limit:a,offset:n}=t;return this.requireId(r),this.request({method:"GET",path:joinPaths(el,r,"organization_memberships"),queryParams:{limit:a,offset:n}})}async verifyPassword(t){let{userId:r,password:a}=t;return this.requireId(r),this.request({method:"POST",path:joinPaths(el,r,"verify_password"),bodyParams:{password:a}})}async verifyTOTP(t){let{userId:r,code:a}=t;return this.requireId(r),this.request({method:"POST",path:joinPaths(el,r,"verify_totp"),bodyParams:{code:a}})}},ec="https://api.clerk.dev",ed="@clerk/backend",eh={AuthStatus:"x-clerk-auth-status",AuthReason:"x-clerk-auth-reason",AuthMessage:"x-clerk-auth-message",EnableDebug:"x-clerk-debug",ClerkRedirectTo:"x-clerk-redirect-to",CloudFrontForwardedProto:"cloudfront-forwarded-proto",Authorization:"authorization",ForwardedPort:"x-forwarded-port",ForwardedProto:"x-forwarded-proto",ForwardedHost:"x-forwarded-host",Referrer:"referer",UserAgent:"user-agent",Origin:"origin",Host:"host",ContentType:"content-type"},ef={AuthStatus:eh.AuthStatus},ep={Attributes:{AuthStatus:"__clerkAuthStatus",AuthReason:"__clerkAuthReason",AuthMessage:"__clerkAuthMessage"},Cookies:{Session:"__session",ClientUat:"__client_uat"},Headers:eh,SearchParams:ef,ContentTypes:{Json:"application/json"}};function assertValidSecretKey(t){if(!t||"string"!=typeof t)throw Error("Missing Clerk Secret Key or API Key. Go to https://dashboard.clerk.com and get your key for your instance.")}var em=class _AllowlistIdentifier{constructor(t,r,a,n,o){this.id=t,this.identifier=r,this.createdAt=a,this.updatedAt=n,this.invitationId=o}static fromJSON(t){return new _AllowlistIdentifier(t.id,t.identifier,t.created_at,t.updated_at,t.invitation_id)}},ey=class _Session{constructor(t,r,a,n,o,i,s,l,u){this.id=t,this.clientId=r,this.userId=a,this.status=n,this.lastActiveAt=o,this.expireAt=i,this.abandonAt=s,this.createdAt=l,this.updatedAt=u}static fromJSON(t){return new _Session(t.id,t.client_id,t.user_id,t.status,t.last_active_at,t.expire_at,t.abandon_at,t.created_at,t.updated_at)}},eg=class _Client{constructor(t,r,a,n,o,i,s,l){this.id=t,this.sessionIds=r,this.sessions=a,this.signInId=n,this.signUpId=o,this.lastActiveSessionId=i,this.createdAt=s,this.updatedAt=l}static fromJSON(t){return new _Client(t.id,t.session_ids,t.sessions.map(t=>ey.fromJSON(t)),t.sign_in_id,t.sign_up_id,t.last_active_session_id,t.created_at,t.updated_at)}},eb=class _DeletedObject{constructor(t,r,a,n){this.object=t,this.id=r,this.slug=a,this.deleted=n}static fromJSON(t){return new _DeletedObject(t.object,t.id||null,t.slug||null,t.deleted)}},eS=class _Email{constructor(t,r,a,n,o,i,s,l,u,c,d){this.id=t,this.fromEmailName=r,this.emailAddressId=a,this.toEmailAddress=n,this.subject=o,this.body=i,this.bodyPlain=s,this.status=l,this.slug=u,this.data=c,this.deliveredByClerk=d}static fromJSON(t){return new _Email(t.id,t.from_email_name,t.email_address_id,t.to_email_address,t.subject,t.body,t.body_plain,t.status,t.slug,t.data,t.delivered_by_clerk)}},ev=class _IdentificationLink{constructor(t,r){this.id=t,this.type=r}static fromJSON(t){return new _IdentificationLink(t.id,t.type)}},eC=class _Verification{constructor(t,r,a=null,n=null,o=null,i=null){this.status=t,this.strategy=r,this.externalVerificationRedirectURL=a,this.attempts=n,this.expireAt=o,this.nonce=i}static fromJSON(t){return new _Verification(t.status,t.strategy,t.external_verification_redirect_url?new URL(t.external_verification_redirect_url):null,t.attempts,t.expire_at,t.nonce)}},ew=class _EmailAddress{constructor(t,r,a,n){this.id=t,this.emailAddress=r,this.verification=a,this.linkedTo=n}static fromJSON(t){return new _EmailAddress(t.id,t.email_address,t.verification&&eC.fromJSON(t.verification),t.linked_to.map(t=>ev.fromJSON(t)))}},eA=class _ExternalAccount{constructor(t,r,a,n,o,i,s,l,u,c,d,h={},p,m){this.id=t,this.provider=r,this.identificationId=a,this.externalId=n,this.approvedScopes=o,this.emailAddress=i,this.firstName=s,this.lastName=l,this.picture=u,this.imageUrl=c,this.username=d,this.publicMetadata=h,this.label=p,this.verification=m}static fromJSON(t){return new _ExternalAccount(t.id,t.provider,t.identification_id,t.provider_user_id,t.approved_scopes,t.email_address,t.first_name,t.last_name,t.avatar_url,t.image_url,t.username,t.public_metadata,t.label,t.verification&&eC.fromJSON(t.verification))}};deprecatedProperty(eA,"picture","Use `imageUrl` instead.");var e_=class _Invitation{constructor(t,r,a,n,o,i,s){this.id=t,this.emailAddress=r,this.publicMetadata=a,this.createdAt=n,this.updatedAt=o,this.status=i,this.revoked=s}static fromJSON(t){return new _Invitation(t.id,t.email_address,t.public_metadata,t.created_at,t.updated_at,t.status,t.revoked)}},ek=((n=ek||{}).AllowlistIdentifier="allowlist_identifier",n.Client="client",n.Email="email",n.EmailAddress="email_address",n.ExternalAccount="external_account",n.FacebookAccount="facebook_account",n.GoogleAccount="google_account",n.Invitation="invitation",n.OauthAccessToken="oauth_access_token",n.Organization="organization",n.OrganizationInvitation="organization_invitation",n.OrganizationMembership="organization_membership",n.PhoneNumber="phone_number",n.RedirectUrl="redirect_url",n.Session="session",n.SignInAttempt="sign_in_attempt",n.SignInToken="sign_in_token",n.SignUpAttempt="sign_up_attempt",n.SmsMessage="sms_message",n.User="user",n.Web3Wallet="web3_wallet",n.Token="token",n.TotalCount="total_count",n),eE=class _OauthAccessToken{constructor(t,r,a={},n,o,i){this.provider=t,this.token=r,this.publicMetadata=a,this.label=n,this.scopes=o,this.tokenSecret=i}static fromJSON(t){return new _OauthAccessToken(t.provider,t.token,t.public_metadata,t.label,t.scopes,t.token_secret)}},eR=class _Organization{constructor(t,r,a,n,o,i,s,l,u,c={},d={},h,p,m){this.id=t,this.name=r,this.slug=a,this.logoUrl=n,this.imageUrl=o,this.hasImage=i,this.createdBy=s,this.createdAt=l,this.updatedAt=u,this.publicMetadata=c,this.privateMetadata=d,this.maxAllowedMemberships=h,this.adminDeleteEnabled=p,this.members_count=m}static fromJSON(t){return new _Organization(t.id,t.name,t.slug,t.logo_url,t.image_url,t.has_image,t.created_by,t.created_at,t.updated_at,t.public_metadata,t.private_metadata,t.max_allowed_memberships,t.admin_delete_enabled,t.members_count)}};deprecatedProperty(eR,"logoUrl","Use `imageUrl` instead.");var eB=class _OrganizationInvitation{constructor(t,r,a,n,o,i,s,l={},u={}){this.id=t,this.emailAddress=r,this.role=a,this.organizationId=n,this.createdAt=o,this.updatedAt=i,this.status=s,this.publicMetadata=l,this.privateMetadata=u}static fromJSON(t){return new _OrganizationInvitation(t.id,t.email_address,t.role,t.organization_id,t.created_at,t.updated_at,t.status,t.public_metadata,t.private_metadata)}},eP=class _OrganizationMembership{constructor(t,r,a={},n={},o,i,s,l){this.id=t,this.role=r,this.publicMetadata=a,this.privateMetadata=n,this.createdAt=o,this.updatedAt=i,this.organization=s,this.publicUserData=l}static fromJSON(t){return new _OrganizationMembership(t.id,t.role,t.public_metadata,t.private_metadata,t.created_at,t.updated_at,eR.fromJSON(t.organization),ex.fromJSON(t.public_user_data))}},ex=class _OrganizationMembershipPublicUserData{constructor(t,r,a,n,o,i,s){this.identifier=t,this.firstName=r,this.lastName=a,this.profileImageUrl=n,this.imageUrl=o,this.hasImage=i,this.userId=s}static fromJSON(t){return new _OrganizationMembershipPublicUserData(t.identifier,t.first_name,t.last_name,t.profile_image_url,t.image_url,t.has_image,t.user_id)}};deprecatedProperty(ex,"profileImageUrl","Use `imageUrl` instead.");var eI=class _PhoneNumber{constructor(t,r,a,n,o,i){this.id=t,this.phoneNumber=r,this.reservedForSecondFactor=a,this.defaultSecondFactor=n,this.verification=o,this.linkedTo=i}static fromJSON(t){return new _PhoneNumber(t.id,t.phone_number,t.reserved_for_second_factor,t.default_second_factor,t.verification&&eC.fromJSON(t.verification),t.linked_to.map(t=>ev.fromJSON(t)))}},eT=class _RedirectUrl{constructor(t,r,a,n){this.id=t,this.url=r,this.createdAt=a,this.updatedAt=n}static fromJSON(t){return new _RedirectUrl(t.id,t.url,t.created_at,t.updated_at)}},eO=class _SignInToken{constructor(t,r,a,n,o,i,s){this.id=t,this.userId=r,this.token=a,this.status=n,this.url=o,this.createdAt=i,this.updatedAt=s}static fromJSON(t){return new _SignInToken(t.id,t.user_id,t.token,t.status,t.url,t.created_at,t.updated_at)}},eK=class _SMSMessage{constructor(t,r,a,n,o,i,s){this.id=t,this.fromPhoneNumber=r,this.toPhoneNumber=a,this.message=n,this.status=o,this.phoneNumberId=i,this.data=s}static fromJSON(t){return new _SMSMessage(t.id,t.from_phone_number,t.to_phone_number,t.message,t.status,t.phone_number_id,t.data)}},eU=class _Token{constructor(t){this.jwt=t}static fromJSON(t){return new _Token(t.jwt)}},eN=class _Web3Wallet{constructor(t,r,a){this.id=t,this.web3Wallet=r,this.verification=a}static fromJSON(t){return new _Web3Wallet(t.id,t.web3_wallet,t.verification&&eC.fromJSON(t.verification))}},eL=class _User{constructor(t,r,a,n,o,i,s,l,u,c,d,h,p,m,y,g,b,S,v,C,w,A={},_={},k={},E=[],R=[],B=[],P=[]){this.id=t,this.passwordEnabled=r,this.totpEnabled=a,this.backupCodeEnabled=n,this.twoFactorEnabled=o,this.banned=i,this.createdAt=s,this.updatedAt=l,this.profileImageUrl=u,this.imageUrl=c,this.hasImage=d,this.gender=h,this.birthday=p,this.primaryEmailAddressId=m,this.primaryPhoneNumberId=y,this.primaryWeb3WalletId=g,this.lastSignInAt=b,this.externalId=S,this.username=v,this.firstName=C,this.lastName=w,this.publicMetadata=A,this.privateMetadata=_,this.unsafeMetadata=k,this.emailAddresses=E,this.phoneNumbers=R,this.web3Wallets=B,this.externalAccounts=P}static fromJSON(t){return new _User(t.id,t.password_enabled,t.totp_enabled,t.backup_code_enabled,t.two_factor_enabled,t.banned,t.created_at,t.updated_at,t.profile_image_url,t.image_url,t.has_image,t.gender,t.birthday,t.primary_email_address_id,t.primary_phone_number_id,t.primary_web3_wallet_id,t.last_sign_in_at,t.external_id,t.username,t.first_name,t.last_name,t.public_metadata,t.private_metadata,t.unsafe_metadata,(t.email_addresses||[]).map(t=>ew.fromJSON(t)),(t.phone_numbers||[]).map(t=>eI.fromJSON(t)),(t.web3_wallets||[]).map(t=>eN.fromJSON(t)),(t.external_accounts||[]).map(t=>eA.fromJSON(t)))}};function deserialize(t){return Array.isArray(t)?t.map(t=>jsonToObject(t)):isPaginated(t)?t.data.map(t=>jsonToObject(t)):jsonToObject(t)}function isPaginated(t){return Array.isArray(t.data)&&void 0!==t.data}function getCount(t){return t.total_count}function jsonToObject(t){if("string"!=typeof t&&"object"in t&&"deleted"in t)return eb.fromJSON(t);switch(t.object){case"allowlist_identifier":return em.fromJSON(t);case"client":return eg.fromJSON(t);case"email_address":return ew.fromJSON(t);case"email":return eS.fromJSON(t);case"invitation":return e_.fromJSON(t);case"oauth_access_token":return eE.fromJSON(t);case"organization":return eR.fromJSON(t);case"organization_invitation":return eB.fromJSON(t);case"organization_membership":return eP.fromJSON(t);case"phone_number":return eI.fromJSON(t);case"redirect_url":return eT.fromJSON(t);case"sign_in_token":return eO.fromJSON(t);case"session":return ey.fromJSON(t);case"sms_message":return eK.fromJSON(t);case"token":return eU.fromJSON(t);case"total_count":return getCount(t);case"user":return eL.fromJSON(t);default:return t}}deprecatedProperty(eL,"profileImageUrl","Use `imageUrl` instead.");var withLegacyReturn=t=>async(...r)=>{let{data:a,errors:n,status:o,statusText:i,clerkTraceId:s}=await t(...r);if(null===n)return a;throw new y(i||"",{data:n,status:o||"",clerkTraceId:s})};function buildRequest(t){let request=async r=>{let a;let{apiKey:n,secretKey:o,httpOptions:i,apiUrl:s=ec,apiVersion:l="v1",userAgent:u=ed}=t;n&&chunk_KJVJ4CFF_deprecated("apiKey","Use `secretKey` instead."),i&&chunk_KJVJ4CFF_deprecated("httpOptions","This option has been deprecated and will be removed with the next major release.\nA RequestInit init object used by the `request` method.");let{path:c,method:d,queryParams:h,headerParams:p,bodyParams:m,formData:y}=r,g=o||n;assertValidSecretKey(g);let b=joinPaths(s,l,c),S=new URL(b);if(h){let t=_()({...h});for(let[r,a]of Object.entries(t))a&&[a].flat().forEach(t=>S.searchParams.append(r,t))}let v={Authorization:`Bearer ${g}`,"Clerk-Backend-SDK":u,...p};try{if(y)a=await Y.fetch(S.href,{...i,method:d,headers:v,body:y});else{v["Content-Type"]="application/json";let t="GET"!==d&&m&&Object.keys(m).length>0,r=t?{body:JSON.stringify(_()(m,{deep:!1}))}:null;a=await Y.fetch(S.href,w()(i||{},{method:d,headers:v,...r}))}let t=a?.headers&&a.headers?.get(ep.Headers.ContentType)===ep.ContentTypes.Json,r=await (t?a.json():a.text());if(!a.ok)throw r;return{data:deserialize(r),errors:null}}catch(t){if(t instanceof Error)return{data:null,errors:[{code:"unexpected_error",message:t.message||"Unexpected error"}],clerkTraceId:getTraceId(t,a?.headers)};return{data:null,errors:esm_parseErrors(t),status:a?.status,statusText:a?.statusText,clerkTraceId:getTraceId(t,a?.headers)}}};return withLegacyReturn(request)}function getTraceId(t,r){if(t&&"object"==typeof t&&"clerk_trace_id"in t&&"string"==typeof t.clerk_trace_id)return t.clerk_trace_id;let a=r?.get("cf-ray");return a||""}function esm_parseErrors(t){if(t&&"object"==typeof t&&"errors"in t){let r=t.errors;return r.length>0?r.map(esm_parseError):[]}return[]}function esm_parseError(t){return{code:t.code,message:t.message,longMessage:t.long_message,meta:{paramName:t?.meta?.param_name,sessionId:t?.meta?.session_id}}}function createBackendApiClient(t){let r=buildRequest(t);return{allowlistIdentifiers:new P(r),clients:new T(r),emailAddresses:new U(r),emails:new N(r),interstitial:new j(r),invitations:new q(r),organizations:new X(r),phoneNumbers:new ee(r),redirectUrls:new er(r),sessions:new en(r),signInTokens:new ei(r),smsMessages:new es(r),users:new eu(r),domains:new O(r)}}var createDebug=t=>()=>{let r={...t};return r.apiKey=(r.apiKey||"").substring(0,7),r.secretKey=(r.secretKey||"").substring(0,7),r.jwtKey=(r.jwtKey||"").substring(0,7),{...r}};function signedInAuthObject(t,r,a){let{act:n,sid:o,org_id:i,org_role:s,org_slug:l,sub:u}=t,{apiKey:c,secretKey:d,apiUrl:h,apiVersion:p,token:m,session:y,user:g,organization:b}=r;c&&chunk_KJVJ4CFF_deprecated("apiKey","Use `secretKey` instead.");let{sessions:S}=createBackendApiClient({apiKey:c,secretKey:d,apiUrl:h,apiVersion:p}),v=createGetToken({sessionId:o,sessionToken:m,fetcher:(...t)=>S.getToken(...t)});return{actor:n,sessionClaims:t,sessionId:o,session:y,userId:u,user:g,orgId:i,orgRole:s,orgSlug:l,organization:b,getToken:v,experimental__has:createHasAuthorization({orgId:i,orgRole:s,userId:u}),debug:createDebug({...r,...a})}}function signedOutAuthObject(t){return t?.apiKey&&chunk_KJVJ4CFF_deprecated("apiKey","Use `secretKey` instead."),{sessionClaims:null,sessionId:null,session:null,userId:null,user:null,actor:null,orgId:null,orgRole:null,orgSlug:null,organization:null,getToken:()=>Promise.resolve(null),experimental__has:()=>!1,debug:createDebug(t)}}function prunePrivateMetadata(t){return t&&(delete t.privateMetadata,delete t.private_metadata),t}function sanitizeAuthObject(t){let r=t.user?{...t.user}:t.user,a=t.organization?{...t.organization}:t.organization;return prunePrivateMetadata(r),prunePrivateMetadata(a),{...t,user:r,organization:a}}var makeAuthObjectSerializable=t=>{let{debug:r,getToken:a,experimental__has:n,...o}=t;return o},createGetToken=t=>{let{fetcher:r,sessionToken:a,sessionId:n}=t||{};return async(t={})=>n?t.template?r(n,t.template):a:null},createHasAuthorization=({orgId:t,orgRole:r,userId:a})=>n=>!!t&&!!a&&(n.role?r===n.role:!!n.some&&!!n.some.find(t=>!!t.role&&r===t.role)),eD=class _TokenVerificationError extends Error{constructor({action:t,message:r,reason:a}){super(r),Object.setPrototypeOf(this,_TokenVerificationError.prototype),this.reason=a,this.message=r,this.action=t}getFullMessage(){return`${[this.message,this.action].filter(t=>t).join(" ")} (reason=${this.reason}, token-carrier=${this.tokenCarrier})`}};function loadInterstitialFromLocal(t){t.frontendApi&&chunk_KJVJ4CFF_deprecated("frontendApi","Use `publishableKey` instead."),t.pkgVersion&&chunk_KJVJ4CFF_deprecated("pkgVersion","Use `clerkJSVersion` instead."),t.frontendApi=parsePublishableKey(t.publishableKey)?.frontendApi||t.frontendApi||"";let r=D(t.frontendApi)?"":addClerkPrefix(t.domain),{debugData:a,frontendApi:n,pkgVersion:o,clerkJSUrl:i,clerkJSVersion:s,publishableKey:l,proxyUrl:u,isSatellite:c=!1,domain:d,signInUrl:h}=t;return`
    <head>
        <meta charset="UTF-8" />
        <style>
          @media (prefers-color-scheme: dark) {
            body {
              background-color: black;
            }
          }
        </style>
    </head>
    <body>
        <script>
            window.__clerk_frontend_api = '${n}';
            window.__clerk_debug = ${JSON.stringify(a||{})};
            ${u?`window.__clerk_proxy_url = '${u}'`:""}
            ${d?`window.__clerk_domain = '${d}'`:""}
            window.startClerk = async () => {
                function formRedirect(){
                    const form = '<form method="get" action="" name="redirect"></form>';
                    document.body.innerHTML = document.body.innerHTML + form;

                    const searchParams = new URLSearchParams(window.location.search);
                    for (let paramTuple of searchParams) {
                        const input = document.createElement("input");
                        input.type = "hidden";
                        input.name = paramTuple[0];
                        input.value = paramTuple[1];
                        document.forms.redirect.appendChild(input);
                    }
                    const url = new URL(window.location.origin + window.location.pathname + window.location.hash);
                    window.history.pushState({}, '', url);

                    document.forms.redirect.action = window.location.pathname + window.location.hash;
                    document.forms.redirect.submit();
                }

                const Clerk = window.Clerk;
                try {
                    await Clerk.load({
                        isSatellite: ${c},
                        isInterstitial: true,
                        signInUrl: ${h?`'${h}'`:void 0}
                    });
                    if(Clerk.loaded){
                      if(window.location.href.indexOf("#") === -1){
                        window.location.href = window.location.href;
                      } else if (window.navigator.userAgent.toLowerCase().includes("firefox/")){
                          formRedirect();
                      } else {
                          window.location.reload();
                      }
                    }
                } catch (err) {
                    console.error('Clerk: ', err);
                }
            };
            (() => {
                const script = document.createElement('script');
                ${l?`script.setAttribute('data-clerk-publishable-key', '${l}');`:`script.setAttribute('data-clerk-frontend-api', '${n}');`}

                ${d?`script.setAttribute('data-clerk-domain', '${d}');`:""}
                ${u?`script.setAttribute('data-clerk-proxy-url', '${u}')`:""};
                script.async = true;
                script.src = '${i||getScriptUrl(u||r||n,{pkgVersion:o,clerkJSVersion:s})}';
                script.crossOrigin = 'anonymous';
                script.addEventListener('load', startClerk);
                document.body.appendChild(script);
            })();
        </script>
    </body>
`}async function loadInterstitialFromBAPI(t){t.frontendApi&&chunk_KJVJ4CFF_deprecated("frontendApi","Use `publishableKey` instead."),t.pkgVersion&&chunk_KJVJ4CFF_deprecated("pkgVersion","Use `clerkJSVersion` instead."),t.frontendApi=parsePublishableKey(t.publishableKey)?.frontendApi||t.frontendApi||"";let r=buildPublicInterstitialUrl(t),a=await callWithRetry(()=>Y.fetch(buildPublicInterstitialUrl(t),{method:"GET",headers:{"Clerk-Backend-SDK":t.userAgent||ed}}));if(!a.ok)throw new eD({action:"Contact support@clerk.com",message:`Error loading Clerk Interstitial from ${r} with code=${a.status}`,reason:"interstitial-remote-failed-to-load"});return a.text()}function buildPublicInterstitialUrl(t){t.frontendApi&&chunk_KJVJ4CFF_deprecated("frontendApi","Use `publishableKey` instead."),t.frontendApi=parsePublishableKey(t.publishableKey)?.frontendApi||t.frontendApi||"";let{apiUrl:r,frontendApi:a,pkgVersion:n,clerkJSVersion:o,publishableKey:i,proxyUrl:s,isSatellite:l,domain:u,signInUrl:c}=t,d=new URL(r);return d.pathname=joinPaths(d.pathname,"v1","/public/interstitial"),d.searchParams.append("clerk_js_version",o||getClerkJsMajorVersionOrTag(a,n)),i?d.searchParams.append("publishable_key",i):d.searchParams.append("frontend_api",a),s&&d.searchParams.append("proxy_url",s),l&&d.searchParams.append("is_satellite","true"),d.searchParams.append("sign_in_url",c||""),D(t.frontendApi)||d.searchParams.append("use_domain_for_script","true"),u&&d.searchParams.append("domain",u),d.href}var getFirstValueFromHeader=t=>t?.split(",")[0],buildOrigin=({protocol:t,forwardedProto:r,forwardedHost:a,host:n})=>{let o=getFirstValueFromHeader(a)??n,i=getFirstValueFromHeader(r)??t?.replace(/[:/]/,"");return o&&i?`${i}://${o}`:""},buildRequest2=t=>{if(!t)return{};let r=parseIsomorphicRequestCookies(t),a=getHeaderFromIsomorphicRequest(t),n=getSearchParamsFromIsomorphicRequest(t);return{cookies:r,headers:a,searchParams:n}},decode=t=>t?t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent):t,parseIsomorphicRequestCookies=t=>{let r=t.headers&&t.headers?.get("cookie")?(0,k.Q)(t.headers.get("cookie")):{};return t=>{let a=r?.[t];if(void 0!==a)return decode(a)}},getHeaderFromIsomorphicRequest=t=>r=>t?.headers?.get(r)||void 0,getSearchParamsFromIsomorphicRequest=t=>t?.url?new URL(t.url)?.searchParams:void 0,stripAuthorizationHeader=t=>t?.replace("Bearer ",""),ej=((o=ej||{}).SignedIn="signed-in",o.SignedOut="signed-out",o.Interstitial="interstitial",o.Unknown="unknown",o);async function signedIn(t,r){let{apiKey:a,secretKey:n,apiUrl:o,apiVersion:i,cookieToken:s,frontendApi:l,proxyUrl:u,publishableKey:c,domain:d,isSatellite:h,headerToken:p,loadSession:m,loadUser:y,loadOrganization:g,signInUrl:b,signUpUrl:S,afterSignInUrl:v,afterSignUpUrl:C}=t,{sid:w,org_id:A,sub:_}=r,{sessions:k,users:E,organizations:R}=createBackendApiClient({apiKey:a,secretKey:n,apiUrl:o,apiVersion:i}),[B,P,I]=await Promise.all([m?k.getSession(w):Promise.resolve(void 0),y?E.getUser(_):Promise.resolve(void 0),g&&A?R.getOrganization({organizationId:A}):Promise.resolve(void 0)]),T=signedInAuthObject(r,{secretKey:n,apiKey:a,apiUrl:o,apiVersion:i,token:s||p||"",session:B,user:P,organization:I},{...t,status:"signed-in"});return{status:"signed-in",reason:null,message:null,frontendApi:l,proxyUrl:u,publishableKey:c,domain:d,isSatellite:h,signInUrl:b,signUpUrl:S,afterSignInUrl:v,afterSignUpUrl:C,isSignedIn:!0,isInterstitial:!1,isUnknown:!1,toAuth:()=>T}}function signedOut(t,r,a=""){let{frontendApi:n,publishableKey:o,proxyUrl:i,isSatellite:s,domain:l,signInUrl:u,signUpUrl:c,afterSignInUrl:d,afterSignUpUrl:h}=t;return{status:"signed-out",reason:r,message:a,frontendApi:n,proxyUrl:i,publishableKey:o,isSatellite:s,domain:l,signInUrl:u,signUpUrl:c,afterSignInUrl:d,afterSignUpUrl:h,isSignedIn:!1,isInterstitial:!1,isUnknown:!1,toAuth:()=>signedOutAuthObject({...t,status:"signed-out",reason:r,message:a})}}function interstitial(t,r,a=""){let{frontendApi:n,publishableKey:o,proxyUrl:i,isSatellite:s,domain:l,signInUrl:u,signUpUrl:c,afterSignInUrl:d,afterSignUpUrl:h}=t;return{status:"interstitial",reason:r,message:a,frontendApi:n,publishableKey:o,isSatellite:s,domain:l,proxyUrl:i,signInUrl:u,signUpUrl:c,afterSignInUrl:d,afterSignUpUrl:h,isSignedIn:!1,isInterstitial:!0,isUnknown:!1,toAuth:()=>null}}function unknownState(t,r,a=""){let{frontendApi:n,publishableKey:o,isSatellite:i,domain:s,signInUrl:l,signUpUrl:u,afterSignInUrl:c,afterSignUpUrl:d}=t;return{status:"unknown",reason:r,message:a,frontendApi:n,publishableKey:o,isSatellite:i,domain:s,signInUrl:l,signUpUrl:u,afterSignInUrl:c,afterSignUpUrl:d,isSignedIn:!1,isInterstitial:!1,isUnknown:!0,toAuth:()=>null}}function checkCrossOrigin({originURL:t,host:r,forwardedHost:a,forwardedProto:n}){let o=buildOrigin({forwardedProto:n,forwardedHost:a,protocol:t.protocol,host:r});return o&&new URL(o).origin!==t.origin}var getErrorObjectByCode=(t,r)=>t?t.find(t=>t.code===r):null,eW={parse:(t,r)=>parse2(t,eq,r),stringify:(t,r)=>stringify(t,eq,r)},eq={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bits:6};function parse2(t,r,a={}){if(!r.codes){r.codes={};for(let t=0;t<r.chars.length;++t)r.codes[r.chars[t]]=t}if(!a.loose&&t.length*r.bits&7)throw SyntaxError("Invalid padding");let n=t.length;for(;"="===t[n-1];)if(--n,!a.loose&&!((t.length-n)*r.bits&7))throw SyntaxError("Invalid padding");let o=new(a.out??Uint8Array)(n*r.bits/8|0),i=0,s=0,l=0;for(let a=0;a<n;++a){let n=r.codes[t[a]];if(void 0===n)throw SyntaxError("Invalid character "+t[a]);s=s<<r.bits|n,(i+=r.bits)>=8&&(i-=8,o[l++]=255&s>>i)}if(i>=r.bits||255&s<<8-i)throw SyntaxError("Unexpected end of data");return o}function stringify(t,r,a={}){let{pad:n=!0}=a,o=(1<<r.bits)-1,i="",s=0,l=0;for(let a=0;a<t.length;++a)for(l=l<<8|255&t[a],s+=8;s>r.bits;)s-=r.bits,i+=r.chars[o&l>>s];if(s&&(i+=r.chars[o&l<<r.bits-s]),n)for(;i.length*r.bits&7;)i+="=";return i}var eH={RS256:"SHA-256",RS384:"SHA-384",RS512:"SHA-512"},eM="RSASSA-PKCS1-v1_5",eF={RS256:eM,RS384:eM,RS512:eM},eV=Object.keys(eH);function getCryptoAlgorithm(t){let r=eH[t],a=eF[t];if(!r||!a)throw Error(`Unsupported algorithm ${t}, expected one of ${eV.join(",")}.`);return{hash:{name:eH[t]},name:eF[t]}}var isArrayString=t=>Array.isArray(t)&&t.length>0&&t.every(t=>"string"==typeof t),assertAudienceClaim=(t,r)=>{let a=[r].flat().filter(t=>!!t),n=[t].flat().filter(t=>!!t),o=a.length>0&&n.length>0;if(o){if("string"==typeof t){if(!a.includes(t))throw new eD({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT audience claim (aud) ${JSON.stringify(t)}. Is not included in "${JSON.stringify(a)}".`})}else if(isArrayString(t)&&!t.some(t=>a.includes(t)))throw new eD({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT audience claim array (aud) ${JSON.stringify(t)}. Is not included in "${JSON.stringify(a)}".`})}},assertHeaderType=t=>{if(void 0!==t&&"JWT"!==t)throw new eD({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-invalid",message:`Invalid JWT type ${JSON.stringify(t)}. Expected "JWT".`})},assertHeaderAlgorithm=t=>{if(!eV.includes(t))throw new eD({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-invalid-algorithm",message:`Invalid JWT algorithm ${JSON.stringify(t)}. Supported: ${eV}.`})},assertSubClaim=t=>{if("string"!=typeof t)throw new eD({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Subject claim (sub) is required and must be a string. Received ${JSON.stringify(t)}.`})},assertAuthorizedPartiesClaim=(t,r)=>{if(t&&r&&0!==r.length&&!r.includes(t))throw new eD({reason:"token-invalid-authorized-parties",message:`Invalid JWT Authorized party claim (azp) ${JSON.stringify(t)}. Expected "${r}".`})},assertIssuerClaim=(t,r)=>{if("function"!=typeof r||r(t)){if("string"==typeof r&&t&&t!==r)throw new eD({reason:"token-invalid-issuer",message:`Invalid JWT issuer claim (iss) ${JSON.stringify(t)}. Expected "${r}".`})}else throw new eD({reason:"token-invalid-issuer",message:"Failed JWT issuer resolver. Make sure that the resolver returns a truthy value."})},assertExpirationClaim=(t,r)=>{if("number"!=typeof t)throw new eD({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT expiry date claim (exp) ${JSON.stringify(t)}. Expected number.`});let a=new Date(Date.now()),n=new Date(0);n.setUTCSeconds(t);let o=n.getTime()<=a.getTime()-r;if(o)throw new eD({reason:"token-expired",message:`JWT is expired. Expiry date: ${n.toUTCString()}, Current date: ${a.toUTCString()}.`})},assertActivationClaim=(t,r)=>{if(void 0===t)return;if("number"!=typeof t)throw new eD({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT not before date claim (nbf) ${JSON.stringify(t)}. Expected number.`});let a=new Date(Date.now()),n=new Date(0);n.setUTCSeconds(t);let o=n.getTime()>a.getTime()+r;if(o)throw new eD({reason:"token-not-active-yet",message:`JWT cannot be used prior to not before date claim (nbf). Not before date: ${n.toUTCString()}; Current date: ${a.toUTCString()};`})},assertIssuedAtClaim=(t,r)=>{if(void 0===t)return;if("number"!=typeof t)throw new eD({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Invalid JWT issued at date claim (iat) ${JSON.stringify(t)}. Expected number.`});let a=new Date(Date.now()),n=new Date(0);n.setUTCSeconds(t);let o=n.getTime()>a.getTime()+r;if(o)throw new eD({reason:"token-not-active-yet",message:`JWT issued at date claim (iat) is in the future. Issued at date: ${n.toUTCString()}; Current date: ${a.toUTCString()};`})};function pemToBuffer(t){let r=t.replace(/-----BEGIN.*?-----/g,"").replace(/-----END.*?-----/g,"").replace(/\s/g,""),a=isomorphicAtob(r),n=new ArrayBuffer(a.length),o=new Uint8Array(n);for(let t=0,r=a.length;t<r;t++)o[t]=a.charCodeAt(t);return o}function importKey(t,r,a){if("object"==typeof t)return Y.crypto.subtle.importKey("jwk",t,r,!1,[a]);let n=pemToBuffer(t),o="sign"===a?"pkcs8":"spki";return Y.crypto.subtle.importKey(o,n,r,!1,[a])}async function hasValidSignature(t,r){let{header:a,signature:n,raw:o}=t,i=new TextEncoder,s=i.encode([o.header,o.payload].join(".")),l=getCryptoAlgorithm(a.alg),u=await importKey(r,l,"verify");return Y.crypto.subtle.verify(l.name,u,n,s)}function decodeJwt(t){let r=(t||"").toString().split(".");if(3!==r.length)throw new eD({reason:"token-invalid",message:"Invalid JWT form. A JWT consists of three parts separated by dots."});let[a,n,o]=r,i=new TextDecoder,s=JSON.parse(i.decode(eW.parse(a,{loose:!0}))),l=JSON.parse(i.decode(eW.parse(n,{loose:!0}))),u=eW.parse(o,{loose:!0});return deprecatedObjectProperty(l,"orgs",'Add orgs to your session token using the "user.organizations" shortcode in JWT Templates instead.',"decodeJwt:orgs"),{header:s,payload:l,signature:u,raw:{header:a,payload:n,signature:o,text:t}}}async function verifyJwt(t,{audience:r,authorizedParties:a,clockSkewInSeconds:n,clockSkewInMs:o,issuer:i,key:s}){let l;n&&chunk_KJVJ4CFF_deprecated("clockSkewInSeconds","Use `clockSkewInMs` instead.");let u=o||n||5e3,c=decodeJwt(t),{header:d,payload:h}=c,{typ:p,alg:m}=d;assertHeaderType(p),assertHeaderAlgorithm(m);let{azp:y,sub:g,aud:b,iss:S,iat:v,exp:C,nbf:w}=h;assertSubClaim(g),assertAudienceClaim([b],[r]),assertAuthorizedPartiesClaim(y,a),assertIssuerClaim(S,i),assertExpirationClaim(C,u),assertActivationClaim(w,u),assertIssuedAtClaim(v,u);try{l=await hasValidSignature(c,s)}catch(t){throw new eD({action:"Make sure that this is a valid Clerk generate JWT.",reason:"token-verification-failed",message:`Error verifying JWT signature. ${t}`})}if(!l)throw new eD({reason:"token-invalid-signature",message:"JWT signature is invalid."});return h}var ez={},e$=0;function getCacheValues(){return Object.values(ez)}function setInCache(t,r=36e5){ez[t.kid]=t,e$=Date.now(),r>=0&&setTimeout(()=>{t?delete ez[t.kid]:ez={}},r)}var eJ="local";function loadClerkJWKFromLocal(t){if(!ez[eJ]){if(!t)throw new eD({action:"Set the CLERK_JWT_KEY environment variable.",message:"Missing local JWK.",reason:"jwk-local-missing"});let r=t.replace(/(\r\n|\n|\r)/gm,"").replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace("MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA","").replace("IDAQAB","").replace(/\+/g,"-").replace(/\//g,"_");setInCache({kid:"local",kty:"RSA",alg:"RS256",n:r,e:"AQAB"},-1)}return ez[eJ]}async function loadClerkJWKFromRemote({apiKey:t,secretKey:r,apiUrl:a=ec,apiVersion:n="v1",issuer:o,kid:i,jwksCacheTtlInMs:s=36e5,skipJwksCache:l}){let u=!ez[i]&&reachedMaxCacheUpdatedAt();if(l||u){let i;let l=r||t;if(l)i=()=>fetchJWKSFromBAPI(a,l,n);else if(o)i=()=>fetchJWKSFromFAPI(o);else throw new eD({action:"Contact support@clerk.com",message:"Failed to load JWKS from Clerk Backend or Frontend API.",reason:"jwk-remote-failed-to-load"});let{keys:u}=await callWithRetry(i);if(!u||!u.length)throw new eD({action:"Contact support@clerk.com",message:"The JWKS endpoint did not contain any signing keys. Contact support@clerk.com.",reason:"jwk-remote-failed-to-load"});u.forEach(t=>setInCache(t,s))}let c=ez[i];if(!c){let t=getCacheValues(),r=t.map(t=>t.kid).join(", ");throw new eD({action:"Contact support@clerk.com",message:`Unable to find a signing key in JWKS that matches the kid='${i}' of the provided session token. Please make sure that the __session cookie or the HTTP authorization header contain a Clerk-generated session JWT.${r?` The following kid are available: ${r}`:""}`,reason:"jwk-remote-missing"})}return c}async function fetchJWKSFromFAPI(t){let r=new URL(t);r.pathname=joinPaths(r.pathname,".well-known/jwks.json");let a=await Y.fetch(r.href);if(!a.ok)throw new eD({action:"Contact support@clerk.com",message:`Error loading Clerk JWKS from ${r.href} with code=${a.status}`,reason:"jwk-remote-failed-to-load"});return a.json()}async function fetchJWKSFromBAPI(t,r,a){if(!r)throw new eD({action:"Set the CLERK_SECRET_KEY or CLERK_API_KEY environment variable.",message:"Missing Clerk Secret Key or API Key. Go to https://dashboard.clerk.com and get your key for your instance.",reason:"jwk-remote-failed-to-load"});let n=new URL(t);n.pathname=joinPaths(n.pathname,a,"/jwks");let o=await Y.fetch(n.href,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!o.ok){let t=await o.json(),r=getErrorObjectByCode(t?.errors,"clerk_key_invalid");if(r)throw new eD({action:"Contact support@clerk.com",message:r.message,reason:"secret-key-invalid"});throw new eD({action:"Contact support@clerk.com",message:`Error loading Clerk JWKS from ${n.href} with code=${o.status}`,reason:"jwk-remote-failed-to-load"})}return o.json()}function reachedMaxCacheUpdatedAt(){return Date.now()-e$>=3e5}async function verifyToken(t,r){let a;let{apiKey:n,secretKey:o,apiUrl:i,apiVersion:s,audience:l,authorizedParties:u,clockSkewInSeconds:c,clockSkewInMs:d,issuer:h,jwksCacheTtlInMs:p,jwtKey:m,skipJwksCache:y}=r;r.apiKey&&chunk_KJVJ4CFF_deprecated("apiKey","Use `secretKey` instead.");let{header:g}=decodeJwt(t),{kid:b}=g;if(m)a=loadClerkJWKFromLocal(m);else if("string"==typeof h)a=await loadClerkJWKFromRemote({issuer:h,kid:b,jwksCacheTtlInMs:p,skipJwksCache:y});else if(n||o)a=await loadClerkJWKFromRemote({apiKey:n,secretKey:o,apiUrl:i,apiVersion:s,kid:b,jwksCacheTtlInMs:p,skipJwksCache:y});else throw new eD({action:"Set the CLERK_JWT_KEY environment variable.",message:"Failed to resolve JWK during verification.",reason:"jwk-failed-to-resolve"});return await verifyJwt(t,{audience:l,authorizedParties:u,clockSkewInSeconds:c,clockSkewInMs:d,key:a,issuer:h})}var shouldRedirectToSatelliteUrl=t=>!!t?.get("__clerk_satellite_url"),hasJustSynced=t=>t?.get("__clerk_synced")==="true",eG=/^Mozilla\/|(Amazon CloudFront)/,isBrowser=t=>eG.test(t||""),nonBrowserRequestInDevRule=t=>{let{apiKey:r,secretKey:a,userAgent:n}=t,o=a||r||"";if(isDevelopmentFromApiKey(o)&&!isBrowser(n))return signedOut(t,"header-missing-non-browser")},crossOriginRequestWithoutHeader=t=>{let{origin:r,host:a,forwardedHost:n,forwardedProto:o}=t,i=r&&checkCrossOrigin({originURL:new URL(r),host:a,forwardedHost:n,forwardedProto:o});if(i)return signedOut(t,"header-missing-cors")},isPrimaryInDevAndRedirectsToSatellite=t=>{let{apiKey:r,secretKey:a,isSatellite:n,searchParams:o}=t,i=isDevelopmentFromApiKey(a||r||"");if(i&&!n&&shouldRedirectToSatelliteUrl(o))return interstitial(t,"primary-responds-to-syncing")},potentialFirstLoadInDevWhenUATMissing=t=>{let{apiKey:r,secretKey:a,clientUat:n}=t,o=isDevelopmentFromApiKey(a||r||"");if(o&&!n)return interstitial(t,"uat-missing")},potentialRequestAfterSignInOrOutFromClerkHostedUiInDev=t=>{let{apiKey:r,secretKey:a,referrer:n,host:o,forwardedHost:i,forwardedProto:s}=t,l=n&&checkCrossOrigin({originURL:new URL(n),host:o,forwardedHost:i,forwardedProto:s}),u=a||r||"";if(isDevelopmentFromApiKey(u)&&l)return interstitial(t,"cross-origin-referrer")},potentialFirstRequestOnProductionEnvironment=t=>{let{apiKey:r,secretKey:a,clientUat:n,cookieToken:o}=t,i=a||r||"";if(isProductionFromApiKey(i)&&!n&&!o)return signedOut(t,"cookie-and-uat-missing")},isNormalSignedOutState=t=>{let{clientUat:r}=t;if("0"===r)return signedOut(t,"standard-signed-out")},hasPositiveClientUatButCookieIsMissing=t=>{let{clientUat:r,cookieToken:a}=t;if(r&&Number.parseInt(r)>0&&!a)return interstitial(t,"cookie-missing")},hasValidHeaderToken=async t=>{let{headerToken:r}=t,a=await verifyRequestState(t,r);return await signedIn(t,a)},hasValidCookieToken=async t=>{let{cookieToken:r,clientUat:a}=t,n=await verifyRequestState(t,r),o=await signedIn(t,n),i=o.toAuth().sessionClaims,s=i.iat<Number.parseInt(a);return!a||s?interstitial(t,"cookie-outdated"):o};async function runInterstitialRules(t,r){for(let a of r){let r=await a(t);if(r)return r}return signedOut(t,"unexpected-error")}async function verifyRequestState(t,r){let a;let{isSatellite:n,proxyUrl:o}=t;return a=n?null:o||(t=>t.startsWith("https://clerk.")||t.includes(".clerk.accounts")),verifyToken(r,{...t,issuer:a})}var isSatelliteAndNeedsSyncing=t=>{let{clientUat:r,isSatellite:a,searchParams:n,userAgent:o}=t,i=!r||"0"===r;return a&&i&&!isBrowser(o)?signedOut(t,"satellite-needs-syncing"):a&&i&&!hasJustSynced(n)?interstitial(t,"satellite-needs-syncing"):void 0};function assertSignInUrlExists(t,r){if(!t&&isDevelopmentFromApiKey(r))throw Error("Missing signInUrl. Pass a signInUrl for dev instances if an app is satellite")}function assertProxyUrlOrDomain(t){if(!t)throw Error("Missing domain and proxyUrl. A satellite application needs to specify a domain or a proxyUrl")}function assertSignInUrlFormatAndOrigin(t,r){let a;try{a=new URL(t)}catch{throw Error("The signInUrl needs to have a absolute url format.")}if(a.origin===r)throw Error("The signInUrl needs to be on a different origin than your satellite application.")}async function authenticateRequest(t){let{cookies:r,headers:a,searchParams:n}=buildRequest2(t?.request);async function authenticateRequestWithTokenInHeader(){try{let r=await runInterstitialRules(t,[hasValidHeaderToken]);return r}catch(t){return handleError(t,"header")}}async function authenticateRequestWithTokenInCookie(){try{let r=await runInterstitialRules(t,[crossOriginRequestWithoutHeader,nonBrowserRequestInDevRule,isSatelliteAndNeedsSyncing,isPrimaryInDevAndRedirectsToSatellite,potentialFirstRequestOnProductionEnvironment,potentialFirstLoadInDevWhenUATMissing,potentialRequestAfterSignInOrOutFromClerkHostedUiInDev,hasPositiveClientUatButCookieIsMissing,isNormalSignedOutState,hasValidCookieToken]);return r}catch(t){return handleError(t,"cookie")}}function handleError(r,a){if(r instanceof eD){r.tokenCarrier=a;let n=["token-expired","token-not-active-yet"].includes(r.reason);return n?"header"===a?unknownState(t,r.reason,r.getFullMessage()):interstitial(t,r.reason,r.getFullMessage()):signedOut(t,r.reason,r.getFullMessage())}return signedOut(t,"unexpected-error",r.message)}return(t.frontendApi&&chunk_KJVJ4CFF_deprecated("frontendApi","Use `publishableKey` instead."),t.apiKey&&chunk_KJVJ4CFF_deprecated("apiKey","Use `secretKey` instead."),assertValidSecretKey((t={...t,...loadOptionsFromHeaders(t,a),frontendApi:parsePublishableKey(t.publishableKey)?.frontendApi||t.frontendApi,apiUrl:t.apiUrl||ec,apiVersion:t.apiVersion||"v1",cookieToken:t.cookieToken||r?.(ep.Cookies.Session),clientUat:t.clientUat||r?.(ep.Cookies.ClientUat),searchParams:t.searchParams||n||void 0}).secretKey||t.apiKey),t.isSatellite&&(assertSignInUrlExists(t.signInUrl,t.secretKey||t.apiKey),t.signInUrl&&t.origin&&assertSignInUrlFormatAndOrigin(t.signInUrl,t.origin),assertProxyUrlOrDomain(t.proxyUrl||t.domain)),t.headerToken)?authenticateRequestWithTokenInHeader():authenticateRequestWithTokenInCookie()}var debugRequestState=t=>{let{frontendApi:r,isSignedIn:a,proxyUrl:n,isInterstitial:o,reason:i,message:s,publishableKey:l,isSatellite:u,domain:c}=t;return{frontendApi:r,isSignedIn:a,proxyUrl:n,isInterstitial:o,reason:i,message:s,publishableKey:l,isSatellite:u,domain:c}},loadOptionsFromHeaders=(t,r)=>r?{headerToken:stripAuthorizationHeader(t.headerToken||r(ep.Headers.Authorization)),origin:t.origin||r(ep.Headers.Origin),host:t.host||r(ep.Headers.Host),forwardedHost:t.forwardedHost||r(ep.Headers.ForwardedHost),forwardedPort:t.forwardedPort||r(ep.Headers.ForwardedPort),forwardedProto:t.forwardedProto||r(ep.Headers.CloudFrontForwardedProto)||r(ep.Headers.ForwardedProto),referrer:t.referrer||r(ep.Headers.Referrer),userAgent:t.userAgent||r(ep.Headers.UserAgent)}:{};function createAuthenticateRequest(t){let{apiClient:r}=t,{apiKey:a="",secretKey:n="",jwtKey:o="",apiUrl:i=ec,apiVersion:s="v1",frontendApi:l="",proxyUrl:u="",publishableKey:c="",isSatellite:d=!1,domain:h="",audience:p="",userAgent:m}=t.options,y=buildPublicInterstitialUrl;return{authenticateRequest:({apiKey:t,secretKey:r,audience:m,frontendApi:y,proxyUrl:g,publishableKey:b,jwtKey:S,isSatellite:v,domain:C,searchParams:w,...A})=>authenticateRequest({...A,apiKey:t||a,secretKey:r||n,audience:m||p,apiUrl:i,apiVersion:s,frontendApi:y||l,proxyUrl:g||u,publishableKey:b||c,isSatellite:v||d,domain:C||h,jwtKey:S||o,searchParams:w}),localInterstitial:({frontendApi:t,publishableKey:r,proxyUrl:a,isSatellite:n,domain:o,...i})=>loadInterstitialFromLocal({...i,frontendApi:t||l,proxyUrl:a||u,publishableKey:r||c,isSatellite:n||d,domain:o||h}),remotePublicInterstitial:({frontendApi:t,publishableKey:r,proxyUrl:a,isSatellite:n,domain:o,userAgent:s,...p})=>loadInterstitialFromBAPI({...p,apiUrl:i,frontendApi:t||l,publishableKey:r||c,proxyUrl:a||u,isSatellite:n||d,domain:o||h,userAgent:s||m}),remotePrivateInterstitial:()=>r.interstitial.getInterstitial(),remotePublicInterstitialUrl:y,debugRequestState}}var buildUrl=(t,r)=>{let a;if(t.startsWith("http"))a=new URL(t);else{if(!r||!r.startsWith("http"))throw Error("destination url or return back url should be an absolute path url!");let n=new URL(r);a=new URL(t,n.origin)}return r&&a.searchParams.set("redirect_url",r),a.toString()};function redirect({redirectAdapter:t,signUpUrl:r,signInUrl:a,frontendApi:n,publishableKey:o}){n?chunk_KJVJ4CFF_deprecated("frontendApi","Use `publishableKey` instead."):n=parsePublishableKey(o)?.frontendApi;let i=buildAccountsBaseUrl(n);return{redirectToSignUp:({returnBackUrl:a}={})=>{r||i||L.throwMissingPublishableKeyError();let n=`${i}/sign-up`;return t(buildUrl(r||n,a))},redirectToSignIn:({returnBackUrl:r}={})=>{a||i||L.throwMissingPublishableKeyError();let n=`${i}/sign-in`;return t(buildUrl(a||n,r))}}}function buildAccountsBaseUrl(t){if(!t)return"";let r=t.replace(/(clerk\.accountsstage\.)/,"accountsstage.").replace(/(clerk\.accounts\.|clerk\.)/,"accounts.");return`https://${r}`}function esm_Clerk(t){let r={...t},a=createBackendApiClient(r),n=createAuthenticateRequest({options:r,apiClient:a}),o={...a,...n,__unstable_options:r};return deprecatedObjectProperty(o,"__unstable_options","Use `createClerkClient({...})` to create a new clerk instance instead."),o}let maskSecretKey=t=>{if(!t||"string"!=typeof t)return t;try{return(t||"").replace(/^(sk_(live|test)_)(.+?)(.{3})$/,"$1*********$4")}catch(t){return""}},logFormatter=t=>(Array.isArray(t)?t:[t]).map(t=>{if("string"==typeof t)return maskSecretKey(t);let r=Object.fromEntries(Object.entries(t).map(([t,r])=>[t,maskSecretKey(r)]));return JSON.stringify(r,null,2)}).join(", "),createDebugLogger=(t,r)=>()=>{let a=[],n=!1;return{enable:()=>{n=!0},debug:(...t)=>{n&&a.push(t.map(t=>"function"==typeof t?t():t))},commit:()=>{if(n){for(let n of(console.log(debugLogHeader(t)),a)){let t=r(n);t=t.split("\n").map(t=>`  ${t}`).join("\n"),process.env.VERCEL&&(t=truncate(t,4096)),console.log(t)}console.log(debugLogFooter(t))}}}},withLogger=(t,r)=>(...a)=>{let n="string"==typeof t?createDebugLogger(t,logFormatter):t,o=n(),i=r(o);try{let t=i(...a);if("object"==typeof t&&"then"in t&&"function"==typeof t.then)return t.then(t=>(o.commit(),t)).catch(t=>{throw o.commit(),t});return o.commit(),t}catch(t){throw o.commit(),t}};function debugLogHeader(t){return`[clerk debug start: ${t}]`}function debugLogFooter(t){return`[clerk debug end: ${t}] (@clerk/nextjs=4.27.1,next=14.0.1)`}function truncate(t,r){let a=new TextEncoder,n=new TextDecoder("utf-8"),o=a.encode(t),i=o.slice(0,r);return n.decode(i).replace(/\uFFFD/g,"")}let eY=process.env.CLERK_JS_VERSION||"";eY&&chunk_KJVJ4CFF_deprecated("CLERK_JS_VERSION","Use `NEXT_PUBLIC_CLERK_JS_VERSION` environment variable instead."),process.env.NEXT_PUBLIC_CLERK_JS_VERSION,process.env.NEXT_PUBLIC_CLERK_JS;let eQ=process.env.CLERK_API_URL||"https://api.clerk.dev",eX=process.env.CLERK_API_VERSION||"v1",eZ=process.env.CLERK_API_KEY||"";eZ&&chunk_KJVJ4CFF_deprecated("CLERK_API_KEY","Use `CLERK_SECRET_KEY` environment variable instead.");let e0=process.env.CLERK_SECRET_KEY||"",e1=process.env.NEXT_PUBLIC_CLERK_FRONTEND_API||"";e1&&chunk_KJVJ4CFF_deprecated("NEXT_PUBLIC_CLERK_FRONTEND_API","Use `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` environment variable instead.");let e8=process.env.NEXT_PUBLIC_CLERK_DOMAIN||"",e2=process.env.NEXT_PUBLIC_CLERK_PROXY_URL||"",e3="true"===process.env.NEXT_PUBLIC_CLERK_IS_SATELLITE,e4=process.env.NEXT_PUBLIC_CLERK_SIGN_IN_URL||"",e6=process.env.NEXT_PUBLIC_CLERK_SIGN_UP_URL||"";var e5=a(63366);function getCustomAttributeFromRequest(t,r){return r in t?t[r]:void 0}function getAuthKeyFromRequest(t,r){return getCustomAttributeFromRequest(t,ep.Attributes[r])||utils_getHeader(t,ep.Headers[r])||("AuthStatus"===r?getQueryParam(t,ep.SearchParams.AuthStatus):void 0)}function getQueryParam(t,r){let a;if(isNextRequest(t))return t.nextUrl.searchParams.get(r);if("query"in t&&(a=t.query[r]),!a){let n=(t.url||"").split("?")[1];a=new URLSearchParams(n).get(r)}return a}function utils_getHeader(t,r){return isNextRequest(t)?t.headers.get(r):t.headers[r]||t.headers[r.toLowerCase()]||t.socket?._httpMessage?.getHeader(r)}function getCookie(t,r){if(isNextRequest(t)){let a=t.cookies.get(r);if(!a)return;return"string"==typeof a?a:a.value}return t.cookies[r]}function isNextRequest(t){try{let{headers:r,nextUrl:a,cookies:n}=t||{};return"function"==typeof r?.get&&"function"==typeof a?.searchParams.get&&"function"==typeof n?.get}catch(t){return!1}}let injectSSRStateIntoObject=(t,r)=>{let a={...r};return{...t,__clerk_ssr_state:a}};(({debugLoggerName:t,noAuthStatusMessage:r})=>withLogger(t,t=>(a,n)=>{let o="true"===utils_getHeader(a,ep.Headers.EnableDebug);o&&t.enable();let i=getAuthKeyFromRequest(a,"AuthStatus"),s=getAuthKeyFromRequest(a,"AuthMessage"),l=getAuthKeyFromRequest(a,"AuthReason");if(t.debug("Headers debug",{authStatus:i,authMessage:s,authReason:l}),!i)throw Error(r);let u={apiKey:n?.apiKey||eZ,secretKey:n?.secretKey||e0,apiUrl:eQ,apiVersion:eX,authStatus:i,authMessage:s,authReason:l};if(t.debug("Options debug",u),i!==ej.SignedIn)return signedOutAuthObject(u);let c=parseJwt(a);t.debug("JWT debug",c.raw.text);let d=signedInAuthObject(c.payload,{...u,token:c.raw.text});return d.user&&deprecatedObjectProperty(d,"user","Use `clerkClient.users.getUser` instead."),d.organization&&deprecatedObjectProperty(d,"organization","Use `clerkClient.organizations.getOrganization` instead."),d.session&&deprecatedObjectProperty(d,"session","Use `clerkClient.sessions.getSession` instead."),d}))({debugLoggerName:"getAuth()",noAuthStatusMessage:((t="auth")=>`Clerk: ${t}() was called but Clerk can't detect usage of authMiddleware(). Please ensure the following:
- authMiddleware() is used in your Next.js Middleware.
- Your Middleware matcher is configured to match this route or page.
- If you are using the src directory, make sure the Middleware file is inside of it.

For more details, see https://clerk.com/docs/quickstarts/get-started-with-nextjs.
`)("getAuth")});let buildClerkProps=(t,r={})=>{let a;let n=getAuthKeyFromRequest(t,"AuthStatus"),o=getAuthKeyFromRequest(t,"AuthMessage"),i=getAuthKeyFromRequest(t,"AuthReason"),s={apiKey:eZ,secretKey:e0,apiUrl:eQ,apiVersion:eX,authStatus:n,authMessage:o,authReason:i};if(n&&n===ej.SignedIn){let{payload:r,raw:n}=parseJwt(t);a=signedInAuthObject(r,{...s,token:n.text})}else a=signedOutAuthObject(s);let l=makeAuthObjectSerializable(sanitizeAuthObject({...a,...r}));return injectSSRStateIntoObject({},l)},parseJwt=t=>{let r=getCookie(t,ep.Cookies.Session),a=utils_getHeader(t,"authorization")?.replace("Bearer ","");return decodeJwt(r||a||"")};var e9=a(50571);let buildRequestLike=()=>{try{let{headers:t}=a(28942);return new e9.Z("https://placeholder.com",{headers:t()})}catch(t){if(t&&"message"in t&&"string"==typeof t.message&&t.message.toLowerCase().includes("dynamic server usage"))throw t;throw Error(`Clerk: auth() and currentUser() are only supported in App Router (/app directory).
If you're using /pages, try getAuth() instead.
Original error: ${t}`)}},initialState=()=>buildClerkProps(buildRequestLike());function ClerkProvider(t){let{children:r,...a}=t,n=initialState()?.__clerk_ssr_state;return s().createElement(h,{...mergeNextClerkPropsWithEnv(a),initialState:n},r)}a(52462);let e7=esm_Clerk({apiKey:eZ,secretKey:e0,apiUrl:eQ,apiVersion:eX,userAgent:"@clerk/nextjs",proxyUrl:e2,domain:e8,isSatellite:e3}),setHeader=(t,r,a)=>(t.headers.set(r,a),t);function lexer(t){for(var r=[],a=0;a<t.length;){var n=t[a];if("*"===n||"+"===n||"?"===n){r.push({type:"MODIFIER",index:a,value:t[a++]});continue}if("\\"===n){r.push({type:"ESCAPED_CHAR",index:a++,value:t[a++]});continue}if("{"===n){r.push({type:"OPEN",index:a,value:t[a++]});continue}if("}"===n){r.push({type:"CLOSE",index:a,value:t[a++]});continue}if(":"===n){for(var o="",i=a+1;i<t.length;){var s=t.charCodeAt(i);if(s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122||95===s){o+=t[i++];continue}break}if(!o)throw TypeError("Missing parameter name at ".concat(a));r.push({type:"NAME",index:a,value:o}),a=i;continue}if("("===n){var l=1,u="",i=a+1;if("?"===t[i])throw TypeError('Pattern cannot start with "?" at '.concat(i));for(;i<t.length;){if("\\"===t[i]){u+=t[i++]+t[i++];continue}if(")"===t[i]){if(0==--l){i++;break}}else if("("===t[i]&&(l++,"?"!==t[i+1]))throw TypeError("Capturing groups are not allowed at ".concat(i));u+=t[i++]}if(l)throw TypeError("Unbalanced pattern at ".concat(a));if(!u)throw TypeError("Missing pattern at ".concat(a));r.push({type:"PATTERN",index:a,value:u}),a=i;continue}r.push({type:"CHAR",index:a,value:t[a++]})}return r.push({type:"END",index:a,value:""}),r}function parse(t,r){void 0===r&&(r={});for(var a=lexer(t),n=r.prefixes,o=void 0===n?"./":n,i="[^".concat(escapeString(r.delimiter||"/#?"),"]+?"),s=[],l=0,u=0,c="",tryConsume=function(t){if(u<a.length&&a[u].type===t)return a[u++].value},mustConsume=function(t){var r=tryConsume(t);if(void 0!==r)return r;var n=a[u],o=n.type,i=n.index;throw TypeError("Unexpected ".concat(o," at ").concat(i,", expected ").concat(t))},consumeText=function(){for(var t,r="";t=tryConsume("CHAR")||tryConsume("ESCAPED_CHAR");)r+=t;return r};u<a.length;){var d=tryConsume("CHAR"),h=tryConsume("NAME"),p=tryConsume("PATTERN");if(h||p){var m=d||"";-1===o.indexOf(m)&&(c+=m,m=""),c&&(s.push(c),c=""),s.push({name:h||l++,prefix:m,suffix:"",pattern:p||i,modifier:tryConsume("MODIFIER")||""});continue}var y=d||tryConsume("ESCAPED_CHAR");if(y){c+=y;continue}if(c&&(s.push(c),c=""),tryConsume("OPEN")){var m=consumeText(),g=tryConsume("NAME")||"",b=tryConsume("PATTERN")||"",S=consumeText();mustConsume("CLOSE"),s.push({name:g||(b?l++:""),pattern:g&&!b?i:b,prefix:m,suffix:S,modifier:tryConsume("MODIFIER")||""});continue}mustConsume("END")}return s}function escapeString(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function flags(t){return t&&t.sensitive?"":"i"}function regexpToRegexp(t,r){if(!r)return t;for(var a=/\((?:\?<(.*?)>)?(?!\?)/g,n=0,o=a.exec(t.source);o;)r.push({name:o[1]||n++,prefix:"",suffix:"",modifier:"",pattern:""}),o=a.exec(t.source);return t}function arrayToRegexp(t,r,a){var n=t.map(function(t){return pathToRegexp(t,r,a).source});return new RegExp("(?:".concat(n.join("|"),")"),flags(a))}function stringToRegexp(t,r,a){return tokensToRegexp(parse(t,a),r,a)}function tokensToRegexp(t,r,a){void 0===a&&(a={});for(var n=a.strict,o=void 0!==n&&n,i=a.start,s=a.end,l=a.encode,u=void 0===l?function(t){return t}:l,c=a.delimiter,d=a.endsWith,h="[".concat(escapeString(void 0===d?"":d),"]|$"),p="[".concat(escapeString(void 0===c?"/#?":c),"]"),m=void 0===i||i?"^":"",y=0;y<t.length;y++){var g=t[y];if("string"==typeof g)m+=escapeString(u(g));else{var b=escapeString(u(g.prefix)),S=escapeString(u(g.suffix));if(g.pattern){if(r&&r.push(g),b||S){if("+"===g.modifier||"*"===g.modifier){var v="*"===g.modifier?"?":"";m+="(?:".concat(b,"((?:").concat(g.pattern,")(?:").concat(S).concat(b,"(?:").concat(g.pattern,"))*)").concat(S,")").concat(v)}else m+="(?:".concat(b,"(").concat(g.pattern,")").concat(S,")").concat(g.modifier)}else"+"===g.modifier||"*"===g.modifier?m+="((?:".concat(g.pattern,")").concat(g.modifier,")"):m+="(".concat(g.pattern,")").concat(g.modifier)}else m+="(?:".concat(b).concat(S,")").concat(g.modifier)}}if(void 0===s||s)o||(m+="".concat(p,"?")),m+=a.endsWith?"(?=".concat(h,")"):"$";else{var C=t[t.length-1],w="string"==typeof C?p.indexOf(C[C.length-1])>-1:void 0===C;o||(m+="(?:".concat(p,"(?=").concat(h,"))?")),w||(m+="(?=".concat(p,"|").concat(h,")"))}return new RegExp(m,flags(a))}function pathToRegexp(t,r,a){return t instanceof RegExp?regexpToRegexp(t,r):Array.isArray(t)?arrayToRegexp(t,r,a):stringToRegexp(t,r,a)}let{redirectToSignIn:te,redirectToSignUp:tt}=redirect({redirectAdapter:t=>{let r=e5.Z.redirect(t);return setHeader(r,ep.Headers.ClerkRedirectTo,"true")},signInUrl:e4,signUpUrl:e6,publishableKey:"pk_test_Z3Jvd24tbmV3dC0zMy5jbGVyay5hY2NvdW50cy5kZXYk",frontendApi:e1}),tr=ClerkProvider,ta=e7},57903:(t,r,a)=>{a.d(r,{w:()=>Crypto});var n,o,i,s={};a.r(s),a.d(s,{Any:()=>Any,BaseBlock:()=>BaseBlock,BaseStringBlock:()=>BaseStringBlock,BitString:()=>BitString,BmpString:()=>BmpString,Boolean:()=>Boolean,CharacterString:()=>CharacterString,Choice:()=>Choice,Constructed:()=>Constructed,DATE:()=>DATE,DateTime:()=>DateTime,Duration:()=>Duration,EndOfContent:()=>EndOfContent,Enumerated:()=>Enumerated,GeneralString:()=>GeneralString,GeneralizedTime:()=>GeneralizedTime,GraphicString:()=>GraphicString,HexBlock:()=>HexBlock,IA5String:()=>IA5String,Integer:()=>Integer,Null:()=>Null,NumericString:()=>NumericString,ObjectIdentifier:()=>ObjectIdentifier,OctetString:()=>index_es_OctetString,Primitive:()=>Primitive,PrintableString:()=>PrintableString,RawData:()=>RawData,RelativeObjectIdentifier:()=>RelativeObjectIdentifier,Repeated:()=>Repeated,Sequence:()=>Sequence,Set:()=>Set,TIME:()=>TIME,TeletexString:()=>TeletexString,TimeOfDay:()=>TimeOfDay,UTCTime:()=>UTCTime,UniversalString:()=>UniversalString,Utf8String:()=>Utf8String,ValueBlock:()=>ValueBlock,VideotexString:()=>VideotexString,ViewWriter:()=>ViewWriter,VisibleString:()=>VisibleString,compareSchema:()=>compareSchema,fromBER:()=>fromBER,verifySchema:()=>verifySchema});let index_es_BufferSourceConverter=class index_es_BufferSourceConverter{static isArrayBuffer(t){return"[object ArrayBuffer]"===Object.prototype.toString.call(t)}static toArrayBuffer(t){return this.isArrayBuffer(t)?t:t.byteLength===t.buffer.byteLength||0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:this.toUint8Array(t.buffer).slice(t.byteOffset,t.byteOffset+t.byteLength).buffer}static toUint8Array(t){return this.toView(t,Uint8Array)}static toView(t,r){if(t.constructor===r)return t;if(this.isArrayBuffer(t))return new r(t);if(this.isArrayBufferView(t))return new r(t.buffer,t.byteOffset,t.byteLength);throw TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(t){return this.isArrayBufferView(t)||this.isArrayBuffer(t)}static isArrayBufferView(t){return ArrayBuffer.isView(t)||t&&this.isArrayBuffer(t.buffer)}static isEqual(t,r){let a=index_es_BufferSourceConverter.toUint8Array(t),n=index_es_BufferSourceConverter.toUint8Array(r);if(a.length!==n.byteLength)return!1;for(let t=0;t<a.length;t++)if(a[t]!==n[t])return!1;return!0}static concat(...t){let r;r=!Array.isArray(t[0])||t[1]instanceof Function?Array.isArray(t[0])&&t[1]instanceof Function?t[0]:t[t.length-1]instanceof Function?t.slice(0,t.length-1):t:t[0];let a=0;for(let t of r)a+=t.byteLength;let n=new Uint8Array(a),o=0;for(let t of r){let r=this.toUint8Array(t);n.set(r,o),o+=r.length}return t[t.length-1]instanceof Function?this.toView(n,t[t.length-1]):n.buffer}};let l="string",u=/^[0-9a-f]+$/i,c=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,d=/^[a-zA-Z0-9-_]+$/;let Utf8Converter=class Utf8Converter{static fromString(t){let r=unescape(encodeURIComponent(t)),a=new Uint8Array(r.length);for(let t=0;t<r.length;t++)a[t]=r.charCodeAt(t);return a.buffer}static toString(t){let r=index_es_BufferSourceConverter.toUint8Array(t),a="";for(let t=0;t<r.length;t++)a+=String.fromCharCode(r[t]);let n=decodeURIComponent(escape(a));return n}};let Utf16Converter=class Utf16Converter{static toString(t,r=!1){let a=index_es_BufferSourceConverter.toArrayBuffer(t),n=new DataView(a),o="";for(let t=0;t<a.byteLength;t+=2){let a=n.getUint16(t,r);o+=String.fromCharCode(a)}return o}static fromString(t,r=!1){let a=new ArrayBuffer(2*t.length),n=new DataView(a);for(let a=0;a<t.length;a++)n.setUint16(2*a,t.charCodeAt(a),r);return a}};let index_es_Convert=class index_es_Convert{static isHex(t){return typeof t===l&&u.test(t)}static isBase64(t){return typeof t===l&&c.test(t)}static isBase64Url(t){return typeof t===l&&d.test(t)}static ToString(t,r="utf8"){let a=index_es_BufferSourceConverter.toUint8Array(t);switch(r.toLowerCase()){case"utf8":return this.ToUtf8String(a);case"binary":return this.ToBinary(a);case"hex":return this.ToHex(a);case"base64":return this.ToBase64(a);case"base64url":return this.ToBase64Url(a);case"utf16le":return Utf16Converter.toString(a,!0);case"utf16":case"utf16be":return Utf16Converter.toString(a);default:throw Error(`Unknown type of encoding '${r}'`)}}static FromString(t,r="utf8"){if(!t)return new ArrayBuffer(0);switch(r.toLowerCase()){case"utf8":return this.FromUtf8String(t);case"binary":return this.FromBinary(t);case"hex":return this.FromHex(t);case"base64":return this.FromBase64(t);case"base64url":return this.FromBase64Url(t);case"utf16le":return Utf16Converter.fromString(t,!0);case"utf16":case"utf16be":return Utf16Converter.fromString(t);default:throw Error(`Unknown type of encoding '${r}'`)}}static ToBase64(t){let r=index_es_BufferSourceConverter.toUint8Array(t);if("undefined"==typeof btoa)return Buffer.from(r).toString("base64");{let t=this.ToString(r,"binary");return btoa(t)}}static FromBase64(t){let r=this.formatString(t);if(!r)return new ArrayBuffer(0);if(!index_es_Convert.isBase64(r))throw TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(r)):new Uint8Array(Buffer.from(r,"base64")).buffer}static FromBase64Url(t){let r=this.formatString(t);if(!r)return new ArrayBuffer(0);if(!index_es_Convert.isBase64Url(r))throw TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(r.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(t){return this.ToBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(t,r=index_es_Convert.DEFAULT_UTF8_ENCODING){switch(r){case"ascii":return this.FromBinary(t);case"utf8":return Utf8Converter.fromString(t);case"utf16":case"utf16be":return Utf16Converter.fromString(t);case"utf16le":case"usc2":return Utf16Converter.fromString(t,!0);default:throw Error(`Unknown type of encoding '${r}'`)}}static ToUtf8String(t,r=index_es_Convert.DEFAULT_UTF8_ENCODING){switch(r){case"ascii":return this.ToBinary(t);case"utf8":return Utf8Converter.toString(t);case"utf16":case"utf16be":return Utf16Converter.toString(t);case"utf16le":case"usc2":return Utf16Converter.toString(t,!0);default:throw Error(`Unknown type of encoding '${r}'`)}}static FromBinary(t){let r=t.length,a=new Uint8Array(r);for(let n=0;n<r;n++)a[n]=t.charCodeAt(n);return a.buffer}static ToBinary(t){let r=index_es_BufferSourceConverter.toUint8Array(t),a="";for(let t=0;t<r.length;t++)a+=String.fromCharCode(r[t]);return a}static ToHex(t){let r=index_es_BufferSourceConverter.toUint8Array(t),a="",n=r.length;for(let t=0;t<n;t++){let n=r[t];n<16&&(a+="0"),a+=n.toString(16)}return a}static FromHex(t){let r=this.formatString(t);if(!r)return new ArrayBuffer(0);if(!index_es_Convert.isHex(r))throw TypeError("Argument 'hexString' is not HEX encoded");r.length%2&&(r=`0${r}`);let a=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2){let n=r.slice(t,t+2);a[t/2]=parseInt(n,16)}return a.buffer}static ToUtf16String(t,r=!1){return Utf16Converter.toString(t,r)}static FromUtf16String(t,r=!1){return Utf16Converter.fromString(t,r)}static Base64Padding(t){let r=4-t.length%4;if(r<4)for(let a=0;a<r;a++)t+="=";return t}static formatString(t){return(null==t?void 0:t.replace(/[\n\r\t ]/g,""))||""}};function combine(...t){let r=t.map(t=>t.byteLength).reduce((t,r)=>t+r),a=new Uint8Array(r),n=0;return t.map(t=>new Uint8Array(t)).forEach(t=>{for(let r of t)a[n++]=r}),a.buffer}function utilFromBase(t,r){let a=0;if(1===t.length)return t[0];for(let n=t.length-1;n>=0;n--)a+=t[t.length-1-n]*Math.pow(2,r*n);return a}function utilToBase(t,r,a=-1){let n=t,o=0,i=Math.pow(2,r);for(let s=1;s<8;s++){if(t<i){let t;if(a<0)t=new ArrayBuffer(s),o=s;else{if(a<s)return new ArrayBuffer(0);t=new ArrayBuffer(a),o=a}let i=new Uint8Array(t);for(let t=s-1;t>=0;t--){let a=Math.pow(2,t*r);i[o-t-1]=Math.floor(n/a),n-=i[o-t-1]*a}return t}i*=Math.pow(2,r)}return new ArrayBuffer(0)}function utilConcatView(...t){let r=0,a=0;for(let a of t)r+=a.length;let n=new ArrayBuffer(r),o=new Uint8Array(n);for(let r of t)o.set(r,a),a+=r.length;return o}function utilDecodeTC(){let t=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){let r=255===t[0]&&128&t[1],a=0===t[0]&&(128&t[1])==0;(r||a)&&this.warnings.push("Needlessly long format")}let r=new ArrayBuffer(this.valueHex.byteLength),a=new Uint8Array(r);for(let t=0;t<this.valueHex.byteLength;t++)a[t]=0;a[0]=128&t[0];let n=utilFromBase(a,8),o=new ArrayBuffer(this.valueHex.byteLength),i=new Uint8Array(o);for(let r=0;r<this.valueHex.byteLength;r++)i[r]=t[r];i[0]&=127;let s=utilFromBase(i,8);return s-n}function utilEncodeTC(t){let r=t<0?-1*t:t,a=128;for(let n=1;n<8;n++){if(r<=a){if(t<0){let t=a-r,o=utilToBase(t,8,n),i=new Uint8Array(o);return i[0]|=128,o}let o=utilToBase(r,8,n),i=new Uint8Array(o);if(128&i[0]){let t=o.slice(0),r=new Uint8Array(t);o=new ArrayBuffer(o.byteLength+1),i=new Uint8Array(o);for(let a=0;a<t.byteLength;a++)i[a+1]=r[a];i[0]=0}return o}a*=256}return new ArrayBuffer(0)}function isEqualBuffer(t,r){if(t.byteLength!==r.byteLength)return!1;let a=new Uint8Array(t),n=new Uint8Array(r);for(let t=0;t<a.length;t++)if(a[t]!==n[t])return!1;return!0}function padNumber(t,r){let a=t.toString(10);if(r<a.length)return"";let n=r-a.length,o=Array(n);for(let t=0;t<n;t++)o[t]="0";let i=o.join("");return i.concat(a)}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function assertBigInt(){if("undefined"==typeof BigInt)throw Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function concat(t){let r=0,a=0;for(let a=0;a<t.length;a++){let n=t[a];r+=n.byteLength}let n=new Uint8Array(r);for(let r=0;r<t.length;r++){let o=t[r];n.set(new Uint8Array(o),a),a+=o.byteLength}return n.buffer}function index_es_checkBufferParams(t,r,a,n){return r instanceof Uint8Array?r.byteLength?a<0?(t.error="Wrong parameter: inputOffset less than zero",!1):n<0?(t.error="Wrong parameter: inputLength less than zero",!1):!(r.byteLength-a-n<0)||(t.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(t.error="Wrong parameter: inputBuffer has zero length",!1):(t.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}index_es_Convert.DEFAULT_UTF8_ENCODING="utf8";let ViewWriter=class ViewWriter{constructor(){this.items=[]}write(t){this.items.push(t)}final(){return concat(this.items)}};let h=[new Uint8Array([1])],p="0123456789",m="name",y="valueHexView",g=new ArrayBuffer(0),b=new Uint8Array(0),S="EndOfContent",v="OCTET STRING",C="BIT STRING";function HexBlock(t){var r;return(r=class extends t{constructor(...t){var r;super(...t);let a=t[0]||{};this.isHexOnly=null!==(r=a.isHexOnly)&&void 0!==r&&r,this.valueHexView=a.valueHex?index_es_BufferSourceConverter.toUint8Array(a.valueHex):b}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(t){this.valueHexView=new Uint8Array(t)}fromBER(t,r,a){let n=t instanceof ArrayBuffer?new Uint8Array(t):t;if(!index_es_checkBufferParams(this,n,r,a))return -1;let o=r+a;return(this.valueHexView=n.subarray(r,o),this.valueHexView.length)?(this.blockLength=a,o):(this.warnings.push("Zero buffer length"),r)}toBER(t=!1){return this.isHexOnly?t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",g)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:index_es_Convert.ToHex(this.valueHexView)}}}).NAME="hexBlock",r}let LocalBaseBlock=class LocalBaseBlock{constructor({blockLength:t=0,error:r="",warnings:a=[],valueBeforeDecode:n=b}={}){this.blockLength=t,this.error=r,this.warnings=a,this.valueBeforeDecodeView=index_es_BufferSourceConverter.toUint8Array(n)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(t){this.valueBeforeDecodeView=new Uint8Array(t)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:index_es_Convert.ToHex(this.valueBeforeDecodeView)}}};LocalBaseBlock.NAME="baseBlock";let ValueBlock=class ValueBlock extends LocalBaseBlock{fromBER(t,r,a){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}};ValueBlock.NAME="valueBlock";let LocalIdentificationBlock=class LocalIdentificationBlock extends HexBlock(LocalBaseBlock){constructor({idBlock:t={}}={}){var r,a,n,o;super(),t?(this.isHexOnly=null!==(r=t.isHexOnly)&&void 0!==r&&r,this.valueHexView=t.valueHex?index_es_BufferSourceConverter.toUint8Array(t.valueHex):b,this.tagClass=null!==(a=t.tagClass)&&void 0!==a?a:-1,this.tagNumber=null!==(n=t.tagNumber)&&void 0!==n?n:-1,this.isConstructed=null!==(o=t.isConstructed)&&void 0!==o&&o):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(t=!1){let r=0;switch(this.tagClass){case 1:r|=0;break;case 2:r|=64;break;case 3:r|=128;break;case 4:r|=192;break;default:return this.error="Unknown tag class",g}if(this.isConstructed&&(r|=32),this.tagNumber<31&&!this.isHexOnly){let a=new Uint8Array(1);if(!t){let t=this.tagNumber;t&=31,r|=t,a[0]=r}return a.buffer}if(!this.isHexOnly){let a=utilToBase(this.tagNumber,7),n=new Uint8Array(a),o=a.byteLength,i=new Uint8Array(o+1);if(i[0]=31|r,!t){for(let t=0;t<o-1;t++)i[t+1]=128|n[t];i[o]=n[o-1]}return i.buffer}let a=new Uint8Array(this.valueHexView.byteLength+1);if(a[0]=31|r,!t){let t=this.valueHexView;for(let r=0;r<t.length-1;r++)a[r+1]=128|t[r];a[this.valueHexView.byteLength]=t[t.length-1]}return a.buffer}fromBER(t,r,a){let n=index_es_BufferSourceConverter.toUint8Array(t);if(!index_es_checkBufferParams(this,n,r,a))return -1;let o=n.subarray(r,r+a);if(0===o.length)return this.error="Zero buffer length",-1;let i=192&o[0];switch(i){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(32&o[0])==32,this.isHexOnly=!1;let s=31&o[0];if(31!==s)this.tagNumber=s,this.blockLength=1;else{let t=1,r=this.valueHexView=new Uint8Array(255),a=255;for(;128&o[t];){if(r[t-1]=127&o[t],++t>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(t===a){a+=255;let t=new Uint8Array(a);for(let a=0;a<r.length;a++)t[a]=r[a];r=this.valueHexView=new Uint8Array(a)}}this.blockLength=t+1,r[t-1]=127&o[t];let n=new Uint8Array(t);for(let a=0;a<t;a++)n[a]=r[a];(r=this.valueHexView=new Uint8Array(t)).set(n),this.blockLength<=9?this.tagNumber=utilFromBase(r,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return r+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}};LocalIdentificationBlock.NAME="identificationBlock";let LocalLengthBlock=class LocalLengthBlock extends LocalBaseBlock{constructor({lenBlock:t={}}={}){var r,a,n;super(),this.isIndefiniteForm=null!==(r=t.isIndefiniteForm)&&void 0!==r&&r,this.longFormUsed=null!==(a=t.longFormUsed)&&void 0!==a&&a,this.length=null!==(n=t.length)&&void 0!==n?n:0}fromBER(t,r,a){let n=index_es_BufferSourceConverter.toUint8Array(t);if(!index_es_checkBufferParams(this,n,r,a))return -1;let o=n.subarray(r,r+a);if(0===o.length)return this.error="Zero buffer length",-1;if(255===o[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===o[0],this.isIndefiniteForm)return this.blockLength=1,r+this.blockLength;if(this.longFormUsed=!!(128&o[0]),!1===this.longFormUsed)return this.length=o[0],this.blockLength=1,r+this.blockLength;let i=127&o[0];if(i>8)return this.error="Too big integer",-1;if(i+1>o.length)return this.error="End of input reached before message was fully decoded",-1;let s=r+1,l=n.subarray(s,s+i);return 0===l[i-1]&&this.warnings.push("Needlessly long encoded length"),this.length=utilFromBase(l,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=i+1,r+this.blockLength}toBER(t=!1){let r,a;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return r=new ArrayBuffer(1),!1===t&&((a=new Uint8Array(r))[0]=128),r;if(this.longFormUsed){let n=utilToBase(this.length,8);if(n.byteLength>127)return this.error="Too big length",g;if(r=new ArrayBuffer(n.byteLength+1),t)return r;let o=new Uint8Array(n);(a=new Uint8Array(r))[0]=128|n.byteLength;for(let t=0;t<n.byteLength;t++)a[t+1]=o[t];return r}return r=new ArrayBuffer(1),!1===t&&((a=new Uint8Array(r))[0]=this.length),r}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}};LocalLengthBlock.NAME="lengthBlock";let w={};let BaseBlock=class BaseBlock extends LocalBaseBlock{constructor({name:t="",optional:r=!1,primitiveSchema:a,...n}={},o){super(n),this.name=t,this.optional=r,a&&(this.primitiveSchema=a),this.idBlock=new LocalIdentificationBlock(n),this.lenBlock=new LocalLengthBlock(n),this.valueBlock=o?new o(n):new ValueBlock(n)}fromBER(t,r,a){let n=this.valueBlock.fromBER(t,r,this.lenBlock.isIndefiniteForm?a:this.lenBlock.length);return -1===n?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),n}toBER(t,r){let a=r||new ViewWriter;r||prepareIndefiniteForm(this);let n=this.idBlock.toBER(t);if(a.write(n),this.lenBlock.isIndefiniteForm)a.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(t,a),a.write(new ArrayBuffer(2));else{let r=this.valueBlock.toBER(t);this.lenBlock.length=r.byteLength;let n=this.lenBlock.toBER(t);a.write(n),a.write(r)}return r?g:a.final()}toJSON(){let t={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(t.primitiveSchema=this.primitiveSchema.toJSON()),t}toString(t="ascii"){return"ascii"===t?this.onAsciiEncoding():index_es_Convert.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${index_es_Convert.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(t){if(this===t)return!0;if(!(t instanceof this.constructor))return!1;let r=this.toBER(),a=t.toBER();return isEqualBuffer(r,a)}};function prepareIndefiniteForm(t){if(t instanceof w.Constructed)for(let r of t.valueBlock.value)prepareIndefiniteForm(r)&&(t.lenBlock.isIndefiniteForm=!0);return!!t.lenBlock.isIndefiniteForm}BaseBlock.NAME="BaseBlock";let BaseStringBlock=class BaseStringBlock extends BaseBlock{constructor({value:t="",...r}={},a){super(r,a),t&&this.fromString(t)}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}fromBER(t,r,a){let n=this.valueBlock.fromBER(t,r,this.lenBlock.isIndefiniteForm?a:this.lenBlock.length);return -1===n?this.error=this.valueBlock.error:(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),n}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}};BaseStringBlock.NAME="BaseStringBlock";let LocalPrimitiveValueBlock=class LocalPrimitiveValueBlock extends HexBlock(ValueBlock){constructor({isHexOnly:t=!0,...r}={}){super(r),this.isHexOnly=t}};LocalPrimitiveValueBlock.NAME="PrimitiveValueBlock";let Primitive=class Primitive extends BaseBlock{constructor(t={}){super(t,LocalPrimitiveValueBlock),this.idBlock.isConstructed=!1}};function localChangeType(t,r){if(t instanceof r)return t;let a=new r;return a.idBlock=t.idBlock,a.lenBlock=t.lenBlock,a.warnings=t.warnings,a.valueBeforeDecodeView=t.valueBeforeDecodeView,a}function localFromBER(t,r=0,a=t.length){let n=r,o=new BaseBlock({},ValueBlock),i=new LocalBaseBlock;if(!index_es_checkBufferParams(i,t,r,a))return o.error=i.error,{offset:-1,result:o};let s=t.subarray(r,r+a);if(!s.length)return o.error="Zero buffer length",{offset:-1,result:o};let l=o.idBlock.fromBER(t,r,a);if(o.idBlock.warnings.length&&o.warnings.concat(o.idBlock.warnings),-1===l)return o.error=o.idBlock.error,{offset:-1,result:o};if(r=l,a-=o.idBlock.blockLength,l=o.lenBlock.fromBER(t,r,a),o.lenBlock.warnings.length&&o.warnings.concat(o.lenBlock.warnings),-1===l)return o.error=o.lenBlock.error,{offset:-1,result:o};if(r=l,a-=o.lenBlock.blockLength,!o.idBlock.isConstructed&&o.lenBlock.isIndefiniteForm)return o.error="Indefinite length form used for primitive encoding form",{offset:-1,result:o};let u=BaseBlock;if(1===o.idBlock.tagClass){if(o.idBlock.tagNumber>=37&&!1===o.idBlock.isHexOnly)return o.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:o};switch(o.idBlock.tagNumber){case 0:if(o.idBlock.isConstructed&&o.lenBlock.length>0)return o.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:o};u=w.EndOfContent;break;case 1:u=w.Boolean;break;case 2:u=w.Integer;break;case 3:u=w.BitString;break;case 4:u=w.OctetString;break;case 5:u=w.Null;break;case 6:u=w.ObjectIdentifier;break;case 10:u=w.Enumerated;break;case 12:u=w.Utf8String;break;case 13:u=w.RelativeObjectIdentifier;break;case 14:u=w.TIME;break;case 15:return o.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:o};case 16:u=w.Sequence;break;case 17:u=w.Set;break;case 18:u=w.NumericString;break;case 19:u=w.PrintableString;break;case 20:u=w.TeletexString;break;case 21:u=w.VideotexString;break;case 22:u=w.IA5String;break;case 23:u=w.UTCTime;break;case 24:u=w.GeneralizedTime;break;case 25:u=w.GraphicString;break;case 26:u=w.VisibleString;break;case 27:u=w.GeneralString;break;case 28:u=w.UniversalString;break;case 29:u=w.CharacterString;break;case 30:u=w.BmpString;break;case 31:u=w.DATE;break;case 32:u=w.TimeOfDay;break;case 33:u=w.DateTime;break;case 34:u=w.Duration;break;default:{let t=o.idBlock.isConstructed?new w.Constructed:new w.Primitive;t.idBlock=o.idBlock,t.lenBlock=o.lenBlock,t.warnings=o.warnings,o=t}}}else u=o.idBlock.isConstructed?w.Constructed:w.Primitive;return l=(o=localChangeType(o,u)).fromBER(t,r,o.lenBlock.isIndefiniteForm?a:o.lenBlock.length),o.valueBeforeDecodeView=t.subarray(n,n+o.blockLength),{offset:l,result:o}}function fromBER(t){if(!t.byteLength){let t=new BaseBlock({},ValueBlock);return t.error="Input buffer has zero length",{offset:-1,result:t}}return localFromBER(index_es_BufferSourceConverter.toUint8Array(t).slice(),0,t.byteLength)}function checkLen(t,r){return t?1:r}w.Primitive=Primitive,Primitive.NAME="PRIMITIVE";let LocalConstructedValueBlock=class LocalConstructedValueBlock extends ValueBlock{constructor({value:t=[],isIndefiniteForm:r=!1,...a}={}){super(a),this.value=t,this.isIndefiniteForm=r}fromBER(t,r,a){let n=index_es_BufferSourceConverter.toUint8Array(t);if(!index_es_checkBufferParams(this,n,r,a))return -1;if(this.valueBeforeDecodeView=n.subarray(r,r+a),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),r;let o=r;for(;checkLen(this.isIndefiniteForm,a)>0;){let t=localFromBER(n,o,a);if(-1===t.offset)return this.error=t.result.error,this.warnings.concat(t.result.warnings),-1;if(o=t.offset,this.blockLength+=t.result.blockLength,a-=t.result.blockLength,this.value.push(t.result),this.isIndefiniteForm&&t.result.constructor.NAME===S)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===S?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(t,r){let a=r||new ViewWriter;for(let r=0;r<this.value.length;r++)this.value[r].toBER(t,a);return r?g:a.final()}toJSON(){let t={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(let r of this.value)t.value.push(r.toJSON());return t}};LocalConstructedValueBlock.NAME="ConstructedValueBlock";let Constructed=class Constructed extends BaseBlock{constructor(t={}){super(t,LocalConstructedValueBlock),this.idBlock.isConstructed=!0}fromBER(t,r,a){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;let n=this.valueBlock.fromBER(t,r,this.lenBlock.isIndefiniteForm?a:this.lenBlock.length);return -1===n?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),n}onAsciiEncoding(){let t=[];for(let r of this.valueBlock.value)t.push(r.toString("ascii").split("\n").map(t=>`  ${t}`).join("\n"));let r=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return t.length?`${r} :
${t.join("\n")}`:`${r} :`}};w.Constructed=Constructed,Constructed.NAME="CONSTRUCTED";let LocalEndOfContentValueBlock=class LocalEndOfContentValueBlock extends ValueBlock{fromBER(t,r,a){return r}toBER(t){return g}};LocalEndOfContentValueBlock.override="EndOfContentValueBlock";let EndOfContent=class EndOfContent extends BaseBlock{constructor(t={}){super(t,LocalEndOfContentValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}};w.EndOfContent=EndOfContent,EndOfContent.NAME=S;let Null=class Null extends BaseBlock{constructor(t={}){super(t,ValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(t,r,a){return(this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=a,r+a>t.byteLength)?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):r+a}toBER(t,r){let a=new ArrayBuffer(2);if(!t){let t=new Uint8Array(a);t[0]=5,t[1]=0}return r&&r.write(a),a}onAsciiEncoding(){return`${this.constructor.NAME}`}};w.Null=Null,Null.NAME="NULL";let LocalBooleanValueBlock=class LocalBooleanValueBlock extends HexBlock(ValueBlock){constructor({value:t,...r}={}){super(r),r.valueHex?this.valueHexView=index_es_BufferSourceConverter.toUint8Array(r.valueHex):this.valueHexView=new Uint8Array(1),t&&(this.value=t)}get value(){for(let t of this.valueHexView)if(t>0)return!0;return!1}set value(t){this.valueHexView[0]=t?255:0}fromBER(t,r,a){let n=index_es_BufferSourceConverter.toUint8Array(t);return index_es_checkBufferParams(this,n,r,a)?(this.valueHexView=n.subarray(r,r+a),a>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,utilDecodeTC.call(this),this.blockLength=a,r+a):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}};LocalBooleanValueBlock.NAME="BooleanValueBlock";let Boolean=class Boolean extends BaseBlock{constructor(t={}){super(t,LocalBooleanValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}};w.Boolean=Boolean,Boolean.NAME="BOOLEAN";let LocalOctetStringValueBlock=class LocalOctetStringValueBlock extends HexBlock(LocalConstructedValueBlock){constructor({isConstructed:t=!1,...r}={}){super(r),this.isConstructed=t}fromBER(t,r,a){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,-1===(n=LocalConstructedValueBlock.prototype.fromBER.call(this,t,r,a)))return n;for(let t=0;t<this.value.length;t++){let r=this.value[t].constructor.NAME;if(r===S){if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1;break}if(r!==v)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(t,r,a),this.blockLength=a;return n}toBER(t,r){return this.isConstructed?LocalConstructedValueBlock.prototype.toBER.call(this,t,r):t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}};LocalOctetStringValueBlock.NAME="OctetStringValueBlock";let index_es_OctetString=class index_es_OctetString extends BaseBlock{constructor({idBlock:t={},lenBlock:r={},...a}={}){var n,o;null!==(n=a.isConstructed)&&void 0!==n||(a.isConstructed=!!(null===(o=a.value)||void 0===o?void 0:o.length)),super({idBlock:{isConstructed:a.isConstructed,...t},lenBlock:{...r,isIndefiniteForm:!!a.isIndefiniteForm},...a},LocalOctetStringValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(t,r,a){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===a)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),r;if(!this.valueBlock.isConstructed){let n=t instanceof ArrayBuffer?new Uint8Array(t):t,o=n.subarray(r,r+a);try{if(o.byteLength){let t=localFromBER(o,0,o.byteLength);-1!==t.offset&&t.offset===a&&(this.valueBlock.value=[t.result])}}catch(t){}}return super.fromBER(t,r,a)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?Constructed.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${index_es_Convert.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;let t=[];for(let r of this.valueBlock.value)r instanceof index_es_OctetString&&t.push(r.valueBlock.valueHexView);return index_es_BufferSourceConverter.concat(t)}};w.OctetString=index_es_OctetString,index_es_OctetString.NAME=v;let LocalBitStringValueBlock=class LocalBitStringValueBlock extends HexBlock(LocalConstructedValueBlock){constructor({unusedBits:t=0,isConstructed:r=!1,...a}={}){super(a),this.unusedBits=t,this.isConstructed=r,this.blockLength=this.valueHexView.byteLength}fromBER(t,r,a){if(!a)return r;let n=-1;if(this.isConstructed){if(-1===(n=LocalConstructedValueBlock.prototype.fromBER.call(this,t,r,a)))return n;for(let t of this.value){let r=t.constructor.NAME;if(r===S){if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1;break}if(r!==C)return this.error="BIT STRING may consists of BIT STRINGs only",-1;let a=t.valueBlock;if(this.unusedBits>0&&a.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=a.unusedBits}return n}let o=index_es_BufferSourceConverter.toUint8Array(t);if(!index_es_checkBufferParams(this,o,r,a))return -1;let i=o.subarray(r,r+a);if(this.unusedBits=i[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){let t=i.subarray(1);try{if(t.byteLength){let r=localFromBER(t,0,t.byteLength);-1!==r.offset&&r.offset===a-1&&(this.value=[r.result])}}catch(t){}}return this.valueHexView=i.subarray(1),this.blockLength=i.length,r+a}toBER(t,r){if(this.isConstructed)return LocalConstructedValueBlock.prototype.toBER.call(this,t,r);if(t)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return g;let a=new Uint8Array(this.valueHexView.length+1);return a[0]=this.unusedBits,a.set(this.valueHexView,1),a.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}};LocalBitStringValueBlock.NAME="BitStringValueBlock";let BitString=class BitString extends BaseBlock{constructor({idBlock:t={},lenBlock:r={},...a}={}){var n,o;null!==(n=a.isConstructed)&&void 0!==n||(a.isConstructed=!!(null===(o=a.value)||void 0===o?void 0:o.length)),super({idBlock:{isConstructed:a.isConstructed,...t},lenBlock:{...r,isIndefiniteForm:!!a.isIndefiniteForm},...a},LocalBitStringValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(t,r,a){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(t,r,a)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Constructed.prototype.onAsciiEncoding.call(this);{let t=[],r=this.valueBlock.valueHexView;for(let a of r)t.push(a.toString(2).padStart(8,"0"));let a=t.join("");return`${this.constructor.NAME} : ${a.substring(0,a.length-this.valueBlock.unusedBits)}`}}};function viewAdd(t,r){let a=new Uint8Array([0]),n=new Uint8Array(t),o=new Uint8Array(r),i=n.slice(0),s=i.length-1,l=o.slice(0),u=l.length-1,c=0,d=u<s?s:u,h=0;for(let t=d;t>=0;t--,h++)c=!0==h<l.length?i[s-h]+l[u-h]+a[0]:i[s-h]+a[0],(a[0]=c/10,!0==h>=i.length)?i=utilConcatView(new Uint8Array([c%10]),i):i[s-h]=c%10;return a[0]>0&&(i=utilConcatView(a,i)),i}function power2(t){if(t>=h.length)for(let r=h.length;r<=t;r++){let t=new Uint8Array([0]),a=h[r-1].slice(0);for(let r=a.length-1;r>=0;r--){let n=new Uint8Array([(a[r]<<1)+t[0]]);t[0]=n[0]/10,a[r]=n[0]%10}t[0]>0&&(a=utilConcatView(t,a)),h.push(a)}return h[t]}function viewSub(t,r){let a,n=0,o=new Uint8Array(t),i=new Uint8Array(r),s=o.slice(0),l=s.length-1,u=i.slice(0),c=u.length-1,d=0;for(let t=c;t>=0;t--,d++)!0==(a=s[l-d]-u[c-d]-n)<0?(n=1,s[l-d]=a+10):(n=0,s[l-d]=a);if(n>0)for(let t=l-c+1;t>=0;t--,d++)if((a=s[l-d]-n)<0)n=1,s[l-d]=a+10;else{n=0,s[l-d]=a;break}return s.slice()}w.BitString=BitString,BitString.NAME=C;let LocalIntegerValueBlock=class LocalIntegerValueBlock extends HexBlock(ValueBlock){constructor({value:t,...r}={}){super(r),this._valueDec=0,r.valueHex&&this.setValueHex(),void 0!==t&&(this.valueDec=t)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=utilDecodeTC.call(this)))}set valueDec(t){this._valueDec=t,this.isHexOnly=!1,this.valueHexView=new Uint8Array(utilEncodeTC(t))}get valueDec(){return this._valueDec}fromDER(t,r,a,n=0){let o=this.fromBER(t,r,a);if(-1===o)return o;let i=this.valueHexView;return 0===i[0]&&(128&i[1])!=0?this.valueHexView=i.subarray(1):0!==n&&i.length<n&&(n-i.length>1&&(n=i.length+1),this.valueHexView=i.subarray(n-i.length)),o}toDER(t=!1){let r=this.valueHexView;switch(!0){case(128&r[0])!=0:{let t=new Uint8Array(this.valueHexView.length+1);t[0]=0,t.set(r,1),this.valueHexView=t}break;case 0===r[0]&&(128&r[1])==0:this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(t)}fromBER(t,r,a){let n=super.fromBER(t,r,a);return -1===n||this.setValueHex(),n}toBER(t){return t?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){let t;let r=8*this.valueHexView.length-1,a=new Uint8Array(8*this.valueHexView.length/3),n=0,o=this.valueHexView,i="",s=!1;for(let s=o.byteLength-1;s>=0;s--){t=o[s];for(let o=0;o<8;o++)(1&t)==1&&(n===r?(a=viewSub(power2(n),a),i="-"):a=viewAdd(a,power2(n))),n++,t>>=1}for(let t=0;t<a.length;t++)a[t]&&(s=!0),s&&(i+=p.charAt(a[t]));return!1===s&&(i+=p.charAt(0)),i}};LocalIntegerValueBlock.NAME="IntegerValueBlock",Object.defineProperty(LocalIntegerValueBlock.prototype,"valueHex",{set:function(t){this.valueHexView=new Uint8Array(t),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});let Integer=class Integer extends BaseBlock{constructor(t={}){super(t,LocalIntegerValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return assertBigInt(),BigInt(this.valueBlock.toString())}static fromBigInt(t){assertBigInt();let r=BigInt(t),a=new ViewWriter,n=r.toString(16).replace(/^-/,""),o=new Uint8Array(index_es_Convert.FromHex(n));if(r<0){let t=new Uint8Array(o.length+(128&o[0]?1:0));t[0]|=128;let n=BigInt(`0x${index_es_Convert.ToHex(t)}`),i=index_es_BufferSourceConverter.toUint8Array(index_es_Convert.FromHex((n+r).toString(16)));i[0]|=128,a.write(i)}else 128&o[0]&&a.write(new Uint8Array([0])),a.write(o);let i=new Integer({valueHex:a.final()});return i}convertToDER(){let t=new Integer({valueHex:this.valueBlock.valueHexView});return t.valueBlock.toDER(),t}convertFromDER(){return new Integer({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}};w.Integer=Integer,Integer.NAME="INTEGER";let Enumerated=class Enumerated extends Integer{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}};w.Enumerated=Enumerated,Enumerated.NAME="ENUMERATED";let LocalSidValueBlock=class LocalSidValueBlock extends HexBlock(ValueBlock){constructor({valueDec:t=-1,isFirstSid:r=!1,...a}={}){super(a),this.valueDec=t,this.isFirstSid=r}fromBER(t,r,a){if(!a)return r;let n=index_es_BufferSourceConverter.toUint8Array(t);if(!index_es_checkBufferParams(this,n,r,a))return -1;let o=n.subarray(r,r+a);this.valueHexView=new Uint8Array(a);for(let t=0;t<a&&(this.valueHexView[t]=127&o[t],this.blockLength++,(128&o[t])!=0);t++);let i=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength;t++)i[t]=this.valueHexView[t];return(this.valueHexView=i,(128&o[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=utilFromBase(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),r+this.blockLength)}set valueBigInt(t){assertBigInt();let r=BigInt(t).toString(2);for(;r.length%7;)r="0"+r;let a=new Uint8Array(r.length/7);for(let t=0;t<a.length;t++)a[t]=parseInt(r.slice(7*t,7*t+7),2)+(t+1<a.length?128:0);this.fromBER(a.buffer,0,a.length)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);let r=this.valueHexView,a=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength-1;t++)a[t]=128|r[t];return a[this.blockLength-1]=r[this.blockLength-1],a.buffer}let r=utilToBase(this.valueDec,7);if(0===r.byteLength)return this.error="Error during encoding SID value",g;let a=new Uint8Array(r.byteLength);if(!t){let t=new Uint8Array(r),n=r.byteLength-1;for(let r=0;r<n;r++)a[r]=128|t[r];a[n]=t[n]}return a}toString(){let t="";if(this.isHexOnly)t=index_es_Convert.ToHex(this.valueHexView);else if(this.isFirstSid){let r=this.valueDec;this.valueDec<=39?t="0.":this.valueDec<=79?(t="1.",r-=40):(t="2.",r-=80),t+=r.toString()}else t=this.valueDec.toString();return t}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}};LocalSidValueBlock.NAME="sidBlock";let LocalObjectIdentifierValueBlock=class LocalObjectIdentifierValueBlock extends ValueBlock{constructor({value:t="",...r}={}){super(r),this.value=[],t&&this.fromString(t)}fromBER(t,r,a){let n=r;for(;a>0;){let r=new LocalSidValueBlock;if(-1===(n=r.fromBER(t,n,a))){this.blockLength=0,this.error=r.error;break}0===this.value.length&&(r.isFirstSid=!0),this.blockLength+=r.blockLength,a-=r.blockLength,this.value.push(r)}return n}toBER(t){let r=[];for(let a=0;a<this.value.length;a++){let n=this.value[a].toBER(t);if(0===n.byteLength)return this.error=this.value[a].error,g;r.push(n)}return concat(r)}fromString(t){this.value=[];let r=0,a=0,n="",o=!1;do if(n=-1===(a=t.indexOf(".",r))?t.substring(r):t.substring(r,a),r=a+1,o){let t=this.value[0],r=0;switch(t.valueDec){case 0:break;case 1:r=40;break;case 2:r=80;break;default:this.value=[];return}let a=parseInt(n,10);if(isNaN(a))return;t.valueDec=a+r,o=!1}else{let t=new LocalSidValueBlock;if(n>Number.MAX_SAFE_INTEGER){assertBigInt();let r=BigInt(n);t.valueBigInt=r}else if(t.valueDec=parseInt(n,10),isNaN(t.valueDec))return;this.value.length||(t.isFirstSid=!0,o=!0),this.value.push(t)}while(-1!==a)}toString(){let t="",r=!1;for(let a=0;a<this.value.length;a++){r=this.value[a].isHexOnly;let n=this.value[a].toString();0!==a&&(t=`${t}.`),r?(n=`{${n}}`,this.value[a].isFirstSid?t=`2.{${n} - 80}`:t+=n):t+=n}return t}toJSON(){let t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let r=0;r<this.value.length;r++)t.sidArray.push(this.value[r].toJSON());return t}};LocalObjectIdentifierValueBlock.NAME="ObjectIdentifierValueBlock";let ObjectIdentifier=class ObjectIdentifier extends BaseBlock{constructor(t={}){super(t,LocalObjectIdentifierValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}};w.ObjectIdentifier=ObjectIdentifier,ObjectIdentifier.NAME="OBJECT IDENTIFIER";let LocalRelativeSidValueBlock=class LocalRelativeSidValueBlock extends HexBlock(LocalBaseBlock){constructor({valueDec:t=0,...r}={}){super(r),this.valueDec=t}fromBER(t,r,a){if(0===a)return r;let n=index_es_BufferSourceConverter.toUint8Array(t);if(!index_es_checkBufferParams(this,n,r,a))return -1;let o=n.subarray(r,r+a);this.valueHexView=new Uint8Array(a);for(let t=0;t<a&&(this.valueHexView[t]=127&o[t],this.blockLength++,(128&o[t])!=0);t++);let i=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength;t++)i[t]=this.valueHexView[t];return(this.valueHexView=i,(128&o[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=utilFromBase(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),r+this.blockLength)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);let r=this.valueHexView,a=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength-1;t++)a[t]=128|r[t];return a[this.blockLength-1]=r[this.blockLength-1],a.buffer}let r=utilToBase(this.valueDec,7);if(0===r.byteLength)return this.error="Error during encoding SID value",g;let a=new Uint8Array(r.byteLength);if(!t){let t=new Uint8Array(r),n=r.byteLength-1;for(let r=0;r<n;r++)a[r]=128|t[r];a[n]=t[n]}return a.buffer}toString(){return this.isHexOnly?index_es_Convert.ToHex(this.valueHexView):this.valueDec.toString()}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}};LocalRelativeSidValueBlock.NAME="relativeSidBlock";let LocalRelativeObjectIdentifierValueBlock=class LocalRelativeObjectIdentifierValueBlock extends ValueBlock{constructor({value:t="",...r}={}){super(r),this.value=[],t&&this.fromString(t)}fromBER(t,r,a){let n=r;for(;a>0;){let r=new LocalRelativeSidValueBlock;if(-1===(n=r.fromBER(t,n,a))){this.blockLength=0,this.error=r.error;break}this.blockLength+=r.blockLength,a-=r.blockLength,this.value.push(r)}return n}toBER(t,r){let a=[];for(let r=0;r<this.value.length;r++){let n=this.value[r].toBER(t);if(0===n.byteLength)return this.error=this.value[r].error,g;a.push(n)}return concat(a)}fromString(t){this.value=[];let r=0,a=0,n="";do{n=-1===(a=t.indexOf(".",r))?t.substring(r):t.substring(r,a),r=a+1;let o=new LocalRelativeSidValueBlock;if(o.valueDec=parseInt(n,10),isNaN(o.valueDec))break;this.value.push(o)}while(-1!==a);return!0}toString(){let t="",r=!1;for(let a=0;a<this.value.length;a++){r=this.value[a].isHexOnly;let n=this.value[a].toString();0!==a&&(t=`${t}.`),r?t+=n=`{${n}}`:t+=n}return t}toJSON(){let t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let r=0;r<this.value.length;r++)t.sidArray.push(this.value[r].toJSON());return t}};LocalRelativeObjectIdentifierValueBlock.NAME="RelativeObjectIdentifierValueBlock";let RelativeObjectIdentifier=class RelativeObjectIdentifier extends BaseBlock{constructor(t={}){super(t,LocalRelativeObjectIdentifierValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}};w.RelativeObjectIdentifier=RelativeObjectIdentifier,RelativeObjectIdentifier.NAME="RelativeObjectIdentifier";let Sequence=class Sequence extends Constructed{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}};w.Sequence=Sequence,Sequence.NAME="SEQUENCE";let Set=class Set extends Constructed{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};w.Set=Set,Set.NAME="SET";let LocalStringValueBlock=class LocalStringValueBlock extends HexBlock(ValueBlock){constructor({...t}={}){super(t),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}};LocalStringValueBlock.NAME="StringValueBlock";let LocalSimpleStringValueBlock=class LocalSimpleStringValueBlock extends LocalStringValueBlock{};LocalSimpleStringValueBlock.NAME="SimpleStringValueBlock";let LocalSimpleStringBlock=class LocalSimpleStringBlock extends BaseStringBlock{constructor({...t}={}){super(t,LocalSimpleStringValueBlock)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,index_es_BufferSourceConverter.toUint8Array(t))}fromString(t){let r=t.length,a=this.valueBlock.valueHexView=new Uint8Array(r);for(let n=0;n<r;n++)a[n]=t.charCodeAt(n);this.valueBlock.value=t}};LocalSimpleStringBlock.NAME="SIMPLE STRING";let LocalUtf8StringValueBlock=class LocalUtf8StringValueBlock extends LocalSimpleStringBlock{fromBuffer(t){this.valueBlock.valueHexView=index_es_BufferSourceConverter.toUint8Array(t);try{this.valueBlock.value=index_es_Convert.ToUtf8String(t)}catch(r){this.warnings.push(`Error during "decodeURIComponent": ${r}, using raw string`),this.valueBlock.value=index_es_Convert.ToBinary(t)}}fromString(t){this.valueBlock.valueHexView=new Uint8Array(index_es_Convert.FromUtf8String(t)),this.valueBlock.value=t}};LocalUtf8StringValueBlock.NAME="Utf8StringValueBlock";let Utf8String=class Utf8String extends LocalUtf8StringValueBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}};w.Utf8String=Utf8String,Utf8String.NAME="UTF8String";let LocalBmpStringValueBlock=class LocalBmpStringValueBlock extends LocalSimpleStringBlock{fromBuffer(t){this.valueBlock.value=index_es_Convert.ToUtf16String(t),this.valueBlock.valueHexView=index_es_BufferSourceConverter.toUint8Array(t)}fromString(t){this.valueBlock.value=t,this.valueBlock.valueHexView=new Uint8Array(index_es_Convert.FromUtf16String(t))}};LocalBmpStringValueBlock.NAME="BmpStringValueBlock";let BmpString=class BmpString extends LocalBmpStringValueBlock{constructor({...t}={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}};w.BmpString=BmpString,BmpString.NAME="BMPString";let LocalUniversalStringValueBlock=class LocalUniversalStringValueBlock extends LocalSimpleStringBlock{fromBuffer(t){let r=ArrayBuffer.isView(t)?t.slice().buffer:t.slice(0),a=new Uint8Array(r);for(let t=0;t<a.length;t+=4)a[t]=a[t+3],a[t+1]=a[t+2],a[t+2]=0,a[t+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(r))}fromString(t){let r=t.length,a=this.valueBlock.valueHexView=new Uint8Array(4*r);for(let n=0;n<r;n++){let r=utilToBase(t.charCodeAt(n),8),o=new Uint8Array(r);if(o.length>4)continue;let i=4-o.length;for(let t=o.length-1;t>=0;t--)a[4*n+t+i]=o[t]}this.valueBlock.value=t}};LocalUniversalStringValueBlock.NAME="UniversalStringValueBlock";let UniversalString=class UniversalString extends LocalUniversalStringValueBlock{constructor({...t}={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}};w.UniversalString=UniversalString,UniversalString.NAME="UniversalString";let NumericString=class NumericString extends LocalSimpleStringBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}};w.NumericString=NumericString,NumericString.NAME="NumericString";let PrintableString=class PrintableString extends LocalSimpleStringBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}};w.PrintableString=PrintableString,PrintableString.NAME="PrintableString";let TeletexString=class TeletexString extends LocalSimpleStringBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}};w.TeletexString=TeletexString,TeletexString.NAME="TeletexString";let VideotexString=class VideotexString extends LocalSimpleStringBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}};w.VideotexString=VideotexString,VideotexString.NAME="VideotexString";let IA5String=class IA5String extends LocalSimpleStringBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}};w.IA5String=IA5String,IA5String.NAME="IA5String";let GraphicString=class GraphicString extends LocalSimpleStringBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}};w.GraphicString=GraphicString,GraphicString.NAME="GraphicString";let VisibleString=class VisibleString extends LocalSimpleStringBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}};w.VisibleString=VisibleString,VisibleString.NAME="VisibleString";let GeneralString=class GeneralString extends LocalSimpleStringBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}};w.GeneralString=GeneralString,GeneralString.NAME="GeneralString";let CharacterString=class CharacterString extends LocalSimpleStringBlock{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}};w.CharacterString=CharacterString,CharacterString.NAME="CharacterString";let UTCTime=class UTCTime extends VisibleString{constructor({value:t,valueDate:r,...a}={}){if(super(a),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,t){this.fromString(t),this.valueBlock.valueHexView=new Uint8Array(t.length);for(let r=0;r<t.length;r++)this.valueBlock.valueHexView[r]=t.charCodeAt(r)}r&&(this.fromDate(r),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,index_es_BufferSourceConverter.toUint8Array(t)))}toBuffer(){let t=this.toString(),r=new ArrayBuffer(t.length),a=new Uint8Array(r);for(let r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return r}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(t){let r=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(t);if(null===r){this.error="Wrong input string for conversion";return}let a=parseInt(r[1],10);a>=50?this.year=1900+a:this.year=2e3+a,this.month=parseInt(r[2],10),this.day=parseInt(r[3],10),this.hour=parseInt(r[4],10),this.minute=parseInt(r[5],10),this.second=parseInt(r[6],10)}toString(t="iso"){if("iso"===t){let t=Array(7);return t[0]=padNumber(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=padNumber(this.month,2),t[2]=padNumber(this.day,2),t[3]=padNumber(this.hour,2),t[4]=padNumber(this.minute,2),t[5]=padNumber(this.second,2),t[6]="Z",t.join("")}return super.toString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}};w.UTCTime=UTCTime,UTCTime.NAME="UTCTime";let GeneralizedTime=class GeneralizedTime extends UTCTime{constructor(t={}){var r;super(t),null!==(r=this.millisecond)&&void 0!==r||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(t){super.fromDate(t),this.millisecond=t.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(t){let r,a=!1,n="",o="",i=0,s=0,l=0;if("Z"===t[t.length-1])n=t.substring(0,t.length-1),a=!0;else{let r=new Number(t[t.length-1]);if(isNaN(r.valueOf()))throw Error("Wrong input string for conversion");n=t}if(a){if(-1!==n.indexOf("+")||-1!==n.indexOf("-"))throw Error("Wrong input string for conversion")}else{let t=1,r=n.indexOf("+"),a="";if(-1===r&&(r=n.indexOf("-"),t=-1),-1!==r){if(a=n.substring(r+1),n=n.substring(0,r),2!==a.length&&4!==a.length)throw Error("Wrong input string for conversion");let o=parseInt(a.substring(0,2),10);if(isNaN(o.valueOf()))throw Error("Wrong input string for conversion");if(s=t*o,4===a.length){if(isNaN((o=parseInt(a.substring(2,4),10)).valueOf()))throw Error("Wrong input string for conversion");l=t*o}}}let u=n.indexOf(".");if(-1===u&&(u=n.indexOf(",")),-1!==u){let t=new Number(`0${n.substring(u)}`);if(isNaN(t.valueOf()))throw Error("Wrong input string for conversion");i=t.valueOf(),o=n.substring(0,u)}else o=n;switch(!0){case 8===o.length:if(r=/(\d{4})(\d{2})(\d{2})/ig,-1!==u)throw Error("Wrong input string for conversion");break;case 10===o.length:if(r=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,-1!==u){let t=60*i;this.minute=Math.floor(t),t=60*(t-this.minute),this.second=Math.floor(t),t=1e3*(t-this.second),this.millisecond=Math.floor(t)}break;case 12===o.length:if(r=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==u){let t=60*i;this.second=Math.floor(t),t=1e3*(t-this.second),this.millisecond=Math.floor(t)}break;case 14===o.length:if(r=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==u){let t=1e3*i;this.millisecond=Math.floor(t)}break;default:throw Error("Wrong input string for conversion")}let c=r.exec(o);if(null===c)throw Error("Wrong input string for conversion");for(let t=1;t<c.length;t++)switch(t){case 1:this.year=parseInt(c[t],10);break;case 2:this.month=parseInt(c[t],10);break;case 3:this.day=parseInt(c[t],10);break;case 4:this.hour=parseInt(c[t],10)+s;break;case 5:this.minute=parseInt(c[t],10)+l;break;case 6:this.second=parseInt(c[t],10);break;default:throw Error("Wrong input string for conversion")}if(!1===a){let t=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=t.getUTCFullYear(),this.month=t.getUTCMonth(),this.day=t.getUTCDay(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds(),this.millisecond=t.getUTCMilliseconds()}}toString(t="iso"){if("iso"===t){let t=[];return t.push(padNumber(this.year,4)),t.push(padNumber(this.month,2)),t.push(padNumber(this.day,2)),t.push(padNumber(this.hour,2)),t.push(padNumber(this.minute,2)),t.push(padNumber(this.second,2)),0!==this.millisecond&&(t.push("."),t.push(padNumber(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(t)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}};w.GeneralizedTime=GeneralizedTime,GeneralizedTime.NAME="GeneralizedTime";let DATE=class DATE extends Utf8String{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}};w.DATE=DATE,DATE.NAME="DATE";let TimeOfDay=class TimeOfDay extends Utf8String{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}};w.TimeOfDay=TimeOfDay,TimeOfDay.NAME="TimeOfDay";let DateTime=class DateTime extends Utf8String{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}};w.DateTime=DateTime,DateTime.NAME="DateTime";let Duration=class Duration extends Utf8String{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}};w.Duration=Duration,Duration.NAME="Duration";let TIME=class TIME extends Utf8String{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}};w.TIME=TIME,TIME.NAME="TIME";let Any=class Any{constructor({name:t="",optional:r=!1}={}){this.name=t,this.optional=r}};let Choice=class Choice extends Any{constructor({value:t=[],...r}={}){super(r),this.value=t}};let Repeated=class Repeated extends Any{constructor({value:t=new Any,local:r=!1,...a}={}){super(a),this.value=t,this.local=r}};let RawData=class RawData{constructor({data:t=b}={}){this.dataView=index_es_BufferSourceConverter.toUint8Array(t)}get data(){return this.dataView.slice().buffer}set data(t){this.dataView=index_es_BufferSourceConverter.toUint8Array(t)}fromBER(t,r,a){let n=r+a;return this.dataView=index_es_BufferSourceConverter.toUint8Array(t).subarray(r,n),n}toBER(t){return this.dataView.slice().buffer}};function compareSchema(t,r,a){if(a instanceof Choice){for(let n=0;n<a.value.length;n++){let o=compareSchema(t,r,a.value[n]);if(o.verified)return{verified:!0,result:t}}{let t={verified:!1,result:{error:"Wrong values for Choice type"}};return a.hasOwnProperty(m)&&(t.name=a.name),t}}if(a instanceof Any)return a.hasOwnProperty(m)&&(t[a.name]=r),{verified:!0,result:t};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(a instanceof Object==!1||"idBlock"in a==!1||"fromBER"in a.idBlock==!1||"toBER"in a.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let n=a.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};let o=a.idBlock.fromBER(n,0,n.byteLength);if(-1===o)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===a.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(a.idBlock.tagClass!==r.idBlock.tagClass)return{verified:!1,result:t};if(!1===a.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(a.idBlock.tagNumber!==r.idBlock.tagNumber)return{verified:!1,result:t};if(!1===a.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(a.idBlock.isConstructed!==r.idBlock.isConstructed)return{verified:!1,result:t};if(!("isHexOnly"in a.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(a.idBlock.isHexOnly!==r.idBlock.isHexOnly)return{verified:!1,result:t};if(a.idBlock.isHexOnly){if(y in a.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let n=a.idBlock.valueHexView,o=r.idBlock.valueHexView;if(n.length!==o.length)return{verified:!1,result:t};for(let r=0;r<n.length;r++)if(n[r]!==o[1])return{verified:!1,result:t}}if(a.name&&(a.name=a.name.replace(/^\s+|\s+$/g,""),a.name&&(t[a.name]=r)),a instanceof w.Constructed){let n=0,o={verified:!1,result:{error:"Unknown error"}},i=a.valueBlock.value.length;if(i>0&&a.valueBlock.value[0]instanceof Repeated&&(i=r.valueBlock.value.length),0===i)return{verified:!0,result:t};if(0===r.valueBlock.value.length&&0!==a.valueBlock.value.length){let r=!0;for(let t=0;t<a.valueBlock.value.length;t++)r=r&&(a.valueBlock.value[t].optional||!1);return r?{verified:!0,result:t}:(a.name&&(a.name=a.name.replace(/^\s+|\s+$/g,""),a.name&&delete t[a.name]),t.error="Inconsistent object length",{verified:!1,result:t})}for(let s=0;s<i;s++)if(s-n>=r.valueBlock.value.length){if(!1===a.valueBlock.value[s].optional){let r={verified:!1,result:t};return t.error="Inconsistent length between ASN.1 data and schema",a.name&&(a.name=a.name.replace(/^\s+|\s+$/g,""),a.name&&(delete t[a.name],r.name=a.name)),r}}else if(a.valueBlock.value[0]instanceof Repeated){if(!1===(o=compareSchema(t,r.valueBlock.value[s],a.valueBlock.value[0].value)).verified){if(!a.valueBlock.value[0].optional)return a.name&&(a.name=a.name.replace(/^\s+|\s+$/g,""),a.name&&delete t[a.name]),o;n++}if(m in a.valueBlock.value[0]&&a.valueBlock.value[0].name.length>0){let n={};void 0===(n="local"in a.valueBlock.value[0]&&a.valueBlock.value[0].local?r:t)[a.valueBlock.value[0].name]&&(n[a.valueBlock.value[0].name]=[]),n[a.valueBlock.value[0].name].push(r.valueBlock.value[s])}}else if(!1===(o=compareSchema(t,r.valueBlock.value[s-n],a.valueBlock.value[s])).verified){if(!a.valueBlock.value[s].optional)return a.name&&(a.name=a.name.replace(/^\s+|\s+$/g,""),a.name&&delete t[a.name]),o;n++}if(!1===o.verified){let r={verified:!1,result:t};return a.name&&(a.name=a.name.replace(/^\s+|\s+$/g,""),a.name&&(delete t[a.name],r.name=a.name)),r}return{verified:!0,result:t}}if(a.primitiveSchema&&y in r.valueBlock){let n=localFromBER(r.valueBlock.valueHexView);if(-1===n.offset){let r={verified:!1,result:n.result};return a.name&&(a.name=a.name.replace(/^\s+|\s+$/g,""),a.name&&(delete t[a.name],r.name=a.name)),r}return compareSchema(t,n.result,a.primitiveSchema)}return{verified:!0,result:t}}function verifySchema(t,r){if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};let a=localFromBER(index_es_BufferSourceConverter.toUint8Array(t));return -1===a.offset?{verified:!1,result:a.result}:compareSchema(a.result,a.result,r)}(function(t){t[t.Sequence=0]="Sequence",t[t.Set=1]="Set",t[t.Choice=2]="Choice"})(n||(n={})),function(t){t[t.Any=1]="Any",t[t.Boolean=2]="Boolean",t[t.OctetString=3]="OctetString",t[t.BitString=4]="BitString",t[t.Integer=5]="Integer",t[t.Enumerated=6]="Enumerated",t[t.ObjectIdentifier=7]="ObjectIdentifier",t[t.Utf8String=8]="Utf8String",t[t.BmpString=9]="BmpString",t[t.UniversalString=10]="UniversalString",t[t.NumericString=11]="NumericString",t[t.PrintableString=12]="PrintableString",t[t.TeletexString=13]="TeletexString",t[t.VideotexString=14]="VideotexString",t[t.IA5String=15]="IA5String",t[t.GraphicString=16]="GraphicString",t[t.VisibleString=17]="VisibleString",t[t.GeneralString=18]="GeneralString",t[t.CharacterString=19]="CharacterString",t[t.UTCTime=20]="UTCTime",t[t.GeneralizedTime=21]="GeneralizedTime",t[t.DATE=22]="DATE",t[t.TimeOfDay=23]="TimeOfDay",t[t.DateTime=24]="DateTime",t[t.Duration=25]="Duration",t[t.TIME=26]="TIME",t[t.Null=27]="Null"}(o||(o={}));let A={fromASN:t=>t instanceof Null?null:t.valueBeforeDecodeView,toASN:t=>{if(null===t)return new Null;let r=fromBER(t);if(r.result.error)throw Error(r.result.error);return r.result}},_={fromASN:t=>t.valueBlock.valueHexView.byteLength>=4?t.valueBlock.toString():t.valueBlock.valueDec,toASN:t=>new Integer({value:+t})},k={fromASN:t=>t.valueBlock.valueDec,toASN:t=>new Enumerated({value:t})},E={fromASN:t=>t.valueBlock.valueHexView,toASN:t=>new BitString({valueHex:t})},R={fromASN:t=>t.valueBlock.toString(),toASN:t=>new ObjectIdentifier({value:t})},B={fromASN:t=>t.valueBlock.value,toASN:t=>new Boolean({value:t})},P={fromASN:t=>t.valueBlock.valueHexView,toASN:t=>new index_es_OctetString({valueHex:t})};function createStringConverter(t){return{fromASN:t=>t.valueBlock.value,toASN:r=>new t({value:r})}}let I=createStringConverter(Utf8String),T=createStringConverter(BmpString),O=createStringConverter(UniversalString),K=createStringConverter(NumericString),U=createStringConverter(PrintableString),N=createStringConverter(TeletexString),L=createStringConverter(VideotexString),D=createStringConverter(IA5String),j=createStringConverter(GraphicString),W=createStringConverter(VisibleString),q=createStringConverter(GeneralString),H=createStringConverter(CharacterString),M={fromASN:t=>t.toDate(),toASN:t=>new UTCTime({valueDate:t})},F={fromASN:t=>t.toDate(),toASN:t=>new GeneralizedTime({valueDate:t})},V={fromASN:()=>null,toASN:()=>new Null};function converters_defaultConverter(t){switch(t){case o.Any:return A;case o.BitString:return E;case o.BmpString:return T;case o.Boolean:return B;case o.CharacterString:return H;case o.Enumerated:return k;case o.GeneralString:return q;case o.GeneralizedTime:return F;case o.GraphicString:return j;case o.IA5String:return D;case o.Integer:return _;case o.Null:return V;case o.NumericString:return K;case o.ObjectIdentifier:return R;case o.OctetString:return P;case o.PrintableString:return U;case o.TeletexString:return N;case o.UTCTime:return M;case o.UniversalString:return O;case o.Utf8String:return I;case o.VideotexString:return L;case o.VisibleString:return W;default:return null}}function isConvertible(t){return"function"==typeof t&&t.prototype?!!t.prototype.toASN&&!!t.prototype.fromASN||isConvertible(t.prototype):!!(t&&"object"==typeof t&&"toASN"in t&&"fromASN"in t)}function isTypeOfArray(t){var r;if(t){let a=Object.getPrototypeOf(t);return(null===(r=null==a?void 0:a.prototype)||void 0===r?void 0:r.constructor)===Array||isTypeOfArray(a)}return!1}function isArrayEqual(t,r){if(!(t&&r)||t.byteLength!==r.byteLength)return!1;let a=new Uint8Array(t),n=new Uint8Array(r);for(let r=0;r<t.byteLength;r++)if(a[r]!==n[r])return!1;return!0}let AsnSchemaStorage=class AsnSchemaStorage{constructor(){this.items=new WeakMap}has(t){return this.items.has(t)}get(t,r=!1){let a=this.items.get(t);if(!a)throw Error(`Cannot get schema for '${t.prototype.constructor.name}' target`);if(r&&!a.schema)throw Error(`Schema '${t.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return a}cache(t){let r=this.get(t);r.schema||(r.schema=this.create(t,!0))}createDefault(t){let r={type:n.Sequence,items:{}},a=this.findParentSchema(t);return a&&(Object.assign(r,a),r.items=Object.assign({},r.items,a.items)),r}create(t,r){let a=this.items.get(t)||this.createDefault(t),i=[];for(let t in a.items){let l;let u=a.items[t],c=r?t:"";if("number"==typeof u.type){let t=o[u.type],r=s[t];if(!r)throw Error(`Cannot get ASN1 class by name '${t}'`);l=new r({name:c})}else if(isConvertible(u.type)){let t=new u.type;l=t.toSchema(c)}else if(u.optional){let t=this.get(u.type);t.type===n.Choice?l=new Any({name:c}):(l=this.create(u.type,!1)).name=c}else l=new Any({name:c});let d=!!u.optional||void 0!==u.defaultValue;if(u.repeated){l.name="";let t="set"===u.repeated?Set:Sequence;l=new t({name:"",value:[new Repeated({name:c,value:l})]})}if(null!==u.context&&void 0!==u.context){if(u.implicit){if("number"==typeof u.type||isConvertible(u.type)){let t=u.repeated?Constructed:Primitive;i.push(new t({name:c,optional:d,idBlock:{tagClass:3,tagNumber:u.context}}))}else{this.cache(u.type);let t=!!u.repeated,r=t?l:this.get(u.type,!0).schema;r="valueBlock"in r?r.valueBlock.value:r.value,i.push(new Constructed({name:t?"":c,optional:d,idBlock:{tagClass:3,tagNumber:u.context},value:r}))}}else i.push(new Constructed({optional:d,idBlock:{tagClass:3,tagNumber:u.context},value:[l]}))}else l.optional=d,i.push(l)}switch(a.type){case n.Sequence:return new Sequence({value:i,name:""});case n.Set:return new Set({value:i,name:""});case n.Choice:return new Choice({value:i,name:""});default:throw Error("Unsupported ASN1 type in use")}}set(t,r){return this.items.set(t,r),this}findParentSchema(t){let r=Object.getPrototypeOf(t);if(r){let t=this.items.get(r);return t||this.findParentSchema(r)}return null}};let z=new AsnSchemaStorage,AsnType=t=>r=>{let a;z.has(r)?a=z.get(r):(a=z.createDefault(r),z.set(r,a)),Object.assign(a,t)},AsnProp=t=>(r,a)=>{let n;z.has(r.constructor)?n=z.get(r.constructor):(n=z.createDefault(r.constructor),z.set(r.constructor,n));let o=Object.assign({},t);if("number"==typeof o.type&&!o.converter){let n=converters_defaultConverter(t.type);if(!n)throw Error(`Cannot get default converter for property '${a}' of ${r.constructor.name}`);o.converter=n}n.items[a]=o};let AsnSchemaValidationError=class AsnSchemaValidationError extends Error{constructor(){super(...arguments),this.schemas=[]}};let AsnParser=class AsnParser{static parse(t,r){let a=fromBER(t);if(a.result.error)throw Error(a.result.error);let n=this.fromASN(a.result,r);return n}static fromASN(t,r){var a;try{if(isConvertible(r)){let a=new r;return a.fromASN(t)}let i=z.get(r);z.cache(r);let l=i.schema;if(t.constructor===Constructed&&i.type!==n.Choice)for(let r in l=new Constructed({idBlock:{tagClass:3,tagNumber:t.idBlock.tagNumber},value:i.schema.valueBlock.value}),i.items)delete t[r];let u=compareSchema({},t,l);if(!u.verified)throw new AsnSchemaValidationError(`Data does not match to ${r.name} ASN1 schema. ${u.result.error}`);let c=new r;if(isTypeOfArray(r)){if(!("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let a=i.itemType;if("number"!=typeof a)return r.from(t.valueBlock.value,t=>this.fromASN(t,a));{let n=converters_defaultConverter(a);if(!n)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);return r.from(t.valueBlock.value,t=>n.fromASN(t))}}for(let t in i.items){let r=u.result[t];if(!r)continue;let n=i.items[t],l=n.type;if("number"==typeof l||isConvertible(l)){let i=null!==(a=n.converter)&&void 0!==a?a:isConvertible(l)?new l:null;if(!i)throw Error("Converter is empty");if(n.repeated){if(n.implicit){let a="sequence"===n.repeated?Sequence:Set,o=new a;o.valueBlock=r.valueBlock;let s=fromBER(o.toBER(!1));if(-1===s.offset)throw Error(`Cannot parse the child item. ${s.result.error}`);if(!("value"in s.result.valueBlock&&Array.isArray(s.result.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let l=s.result.valueBlock.value;c[t]=Array.from(l,t=>i.fromASN(t))}else c[t]=Array.from(r,t=>i.fromASN(t))}else{let a=r;if(n.implicit){let t;if(isConvertible(l))t=new l().toSchema("");else{let r=o[l],a=s[r];if(!a)throw Error(`Cannot get '${r}' class from asn1js module`);t=new a}t.valueBlock=a.valueBlock,a=fromBER(t.toBER(!1)).result}c[t]=i.fromASN(a)}}else if(n.repeated){if(!Array.isArray(r))throw Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");c[t]=Array.from(r,t=>this.fromASN(t,l))}else c[t]=this.fromASN(r,l)}return c}catch(t){throw t instanceof AsnSchemaValidationError&&t.schemas.push(r.name),t}}};let AsnSerializer=class AsnSerializer{static serialize(t){return t instanceof BaseBlock?t.toBER(!1):this.toASN(t).toBER(!1)}static toASN(t){let r;if(t&&"object"==typeof t&&isConvertible(t))return t.toASN();if(!(t&&"object"==typeof t))throw TypeError("Parameter 1 should be type of Object.");let a=t.constructor,o=z.get(a);z.cache(a);let i=[];if(o.itemType){if(!Array.isArray(t))throw TypeError("Parameter 1 should be type of Array.");if("number"==typeof o.itemType){let r=converters_defaultConverter(o.itemType);if(!r)throw Error(`Cannot get default converter for array item of ${a.name} ASN1 schema`);i=t.map(t=>r.toASN(t))}else i=t.map(t=>this.toAsnItem({type:o.itemType},"[]",a,t))}else for(let r in o.items){let n=o.items[r],s=t[r];if(void 0===s||n.defaultValue===s||"object"==typeof n.defaultValue&&"object"==typeof s&&isArrayEqual(this.serialize(n.defaultValue),this.serialize(s)))continue;let l=AsnSerializer.toAsnItem(n,r,a,s);if("number"==typeof n.context){if(n.implicit){if(!n.repeated&&("number"==typeof n.type||isConvertible(n.type))){let t={};t.valueHex=l instanceof Null?l.valueBeforeDecodeView:l.valueBlock.toBER(),i.push(new Primitive({optional:n.optional,idBlock:{tagClass:3,tagNumber:n.context},...t}))}else i.push(new Constructed({optional:n.optional,idBlock:{tagClass:3,tagNumber:n.context},value:l.valueBlock.value}))}else i.push(new Constructed({optional:n.optional,idBlock:{tagClass:3,tagNumber:n.context},value:[l]}))}else n.repeated?i=i.concat(l):i.push(l)}switch(o.type){case n.Sequence:r=new Sequence({value:i});break;case n.Set:r=new Set({value:i});break;case n.Choice:if(!i[0])throw Error(`Schema '${a.name}' has wrong data. Choice cannot be empty.`);r=i[0]}return r}static toAsnItem(t,r,a,n){let i;if("number"==typeof t.type){let s=t.converter;if(!s)throw Error(`Property '${r}' doesn't have converter for type ${o[t.type]} in schema '${a.name}'`);if(t.repeated){if(!Array.isArray(n))throw TypeError("Parameter 'objProp' should be type of Array.");let r=Array.from(n,t=>s.toASN(t)),a="sequence"===t.repeated?Sequence:Set;i=new a({value:r})}else i=s.toASN(n)}else if(t.repeated){if(!Array.isArray(n))throw TypeError("Parameter 'objProp' should be type of Array.");let r=Array.from(n,t=>this.toASN(t)),a="sequence"===t.repeated?Sequence:Set;i=new a({value:r})}else i=this.toASN(n);return i}};let AsnConvert=class AsnConvert{static serialize(t){return AsnSerializer.serialize(t)}static parse(t,r){return AsnParser.parse(t,r)}static toString(t){let r=index_es_BufferSourceConverter.isBufferSource(t)?index_es_BufferSourceConverter.toArrayBuffer(t):AsnConvert.serialize(t),a=fromBER(r);if(-1===a.offset)throw Error(`Cannot decode ASN.1 data. ${a.result.error}`);return a.result.toString()}};var $=a(90919);let JsonError=class JsonError extends Error{constructor(t,r){super(r?`${t}. See the inner exception for more details.`:t),this.message=t,this.innerError=r}};let TransformError=class TransformError extends JsonError{constructor(t,r,a){super(r,a),this.schema=t}};let ParserError=class ParserError extends TransformError{constructor(t,r,a){super(t,`JSON doesn't match to '${t.target.name}' schema. ${r}`,a)}};let ValidationError=class ValidationError extends JsonError{};let SerializerError=class SerializerError extends JsonError{constructor(t,r,a){super(`Cannot serialize by '${t}' schema. ${r}`,a),this.schemaName=t}};let KeyError=class KeyError extends ParserError{constructor(t,r,a={}){super(t,"Some keys doesn't match to schema"),this.keys=r,this.errors=a}};function checkType(t,r){switch(r){case i.Boolean:return"boolean"==typeof t;case i.Number:return"number"==typeof t;case i.String:return"string"==typeof t}return!0}function throwIfTypeIsWrong(t,r){if(!checkType(t,r))throw TypeError(`Value must be ${i[r]}`)}function index_es_isConvertible(t){return t&&t.prototype?!!t.prototype.toJSON&&!!t.prototype.fromJSON||index_es_isConvertible(t.prototype):!!(t&&t.toJSON&&t.fromJSON)}!function(t){t[t.Any=0]="Any",t[t.Boolean=1]="Boolean",t[t.Number=2]="Number",t[t.String=3]="String"}(i||(i={}));let JsonSchemaStorage=class JsonSchemaStorage{constructor(){this.items=new Map}has(t){return this.items.has(t)||!!this.findParentSchema(t)}get(t){let r=this.items.get(t)||this.findParentSchema(t);if(!r)throw Error("Cannot get schema for current target");return r}create(t){let r={names:{}},a=this.findParentSchema(t);if(a)for(let t in Object.assign(r,a),r.names={},a.names)r.names[t]=Object.assign({},a.names[t]);return r.target=t,r}set(t,r){return this.items.set(t,r),this}findParentSchema(t){let r=t.__proto__;if(r){let t=this.items.get(r);return t||this.findParentSchema(r)}return null}};let J="default",G=new JsonSchemaStorage;let PatternValidation=class PatternValidation{constructor(t){this.pattern=new RegExp(t)}validate(t){let r=new RegExp(this.pattern.source,this.pattern.flags);if("string"!=typeof t)throw new ValidationError("Incoming value must be string");if(!r.exec(t))throw new ValidationError(`Value doesn't match to pattern '${r.toString()}'`)}};let InclusiveValidation=class InclusiveValidation{constructor(t=Number.MIN_VALUE,r=Number.MAX_VALUE){this.min=t,this.max=r}validate(t){if(throwIfTypeIsWrong(t,i.Number),!(this.min<=t&&t<=this.max)){let t=this.min===Number.MIN_VALUE?"MIN":this.min,r=this.max===Number.MAX_VALUE?"MAX":this.max;throw new ValidationError(`Value doesn't match to diapason [${t},${r}]`)}}};let ExclusiveValidation=class ExclusiveValidation{constructor(t=Number.MIN_VALUE,r=Number.MAX_VALUE){this.min=t,this.max=r}validate(t){if(throwIfTypeIsWrong(t,i.Number),!(this.min<t&&t<this.max)){let t=this.min===Number.MIN_VALUE?"MIN":this.min,r=this.max===Number.MAX_VALUE?"MAX":this.max;throw new ValidationError(`Value doesn't match to diapason (${t},${r})`)}}};let LengthValidation=class LengthValidation{constructor(t,r,a){this.length=t,this.minLength=r,this.maxLength=a}validate(t){if(void 0!==this.length){if(t.length!==this.length)throw new ValidationError(`Value length must be exactly ${this.length}.`);return}if(void 0!==this.minLength&&t.length<this.minLength)throw new ValidationError(`Value length must be more than ${this.minLength}.`);if(void 0!==this.maxLength&&t.length>this.maxLength)throw new ValidationError(`Value length must be less than ${this.maxLength}.`)}};let EnumerationValidation=class EnumerationValidation{constructor(t){this.enumeration=t}validate(t){if(throwIfTypeIsWrong(t,i.String),!this.enumeration.includes(t))throw new ValidationError(`Value must be one of ${this.enumeration.map(t=>`'${t}'`).join(", ")}`)}};let JsonTransform=class JsonTransform{static checkValues(t,r){let a=Array.isArray(t)?t:[t];for(let n of a)for(let a of r.validations)a instanceof LengthValidation&&r.repeated?a.validate(t):a.validate(n)}static checkTypes(t,r){if(r.repeated&&!Array.isArray(t))throw TypeError("Value must be Array");if("number"==typeof r.type){let a=Array.isArray(t)?t:[t];for(let t of a)throwIfTypeIsWrong(t,r.type)}}static getSchemaByName(t,r=J){return{...t.names[J],...t.names[r]}}};let JsonSerializer=class JsonSerializer extends JsonTransform{static serialize(t,r,a,n){let o=this.toJSON(t,r);return JSON.stringify(o,a,n)}static toJSON(t,r={}){let a;let n=r.targetSchema,o=r.schemaName||J;if(index_es_isConvertible(t))return t.toJSON();if(Array.isArray(t))for(let n of(a=[],t))a.push(this.toJSON(n,r));else if("object"==typeof t){if(n&&!G.has(n))throw new JsonError("Cannot get schema for `targetSchema` param");if(n=n||t.constructor,G.has(n)){let r=G.get(n);a={};let i=this.getSchemaByName(r,o);for(let s in i)try{let r;let l=i[s],u=t[s];if(l.optional&&void 0===u||void 0!==l.defaultValue&&u===l.defaultValue)continue;if(!l.optional&&void 0===u)throw new SerializerError(n.name,`Property '${s}' is required.`);r="number"==typeof l.type?l.converter?l.repeated?u.map(r=>l.converter.toJSON(r,t)):l.converter.toJSON(u,t):u:l.repeated?u.map(t=>this.toJSON(t,{schemaName:o})):this.toJSON(u,{schemaName:o}),this.checkTypes(r,l),this.checkValues(r,l),a[l.name||s]=r}catch(t){if(t instanceof SerializerError)throw t;throw new SerializerError(r.target.name,`Property '${s}' is wrong. ${t.message}`,t)}}else for(let r in a={},t)a[r]=this.toJSON(t[r],{schemaName:o})}else a=t;return a}};let JsonParser=class JsonParser extends JsonTransform{static parse(t,r){let a=JSON.parse(t);return this.fromJSON(a,r)}static fromJSON(t,r){let a=r.targetSchema,n=r.schemaName||J,o=new a;if(index_es_isConvertible(o))return o.fromJSON(t);let i=G.get(a),s=this.getSchemaByName(i,n),l={};for(let a in r.strictProperty&&!Array.isArray(t)&&JsonParser.checkStrictProperty(t,s,i),s)try{let l=s[a],u=l.name||a,c=t[u];if(void 0===c&&(l.optional||void 0!==l.defaultValue))continue;if(!l.optional&&void 0===c)throw new ParserError(i,`Property '${u}' is required.`);if(this.checkTypes(c,l),this.checkValues(c,l),"number"==typeof l.type)l.converter?l.repeated?o[a]=c.map(t=>l.converter.fromJSON(t,o)):o[a]=l.converter.fromJSON(c,o):o[a]=c;else{let t={...r,targetSchema:l.type,schemaName:n};l.repeated?o[a]=c.map(r=>this.fromJSON(r,t)):o[a]=this.fromJSON(c,t)}}catch(t){if(t instanceof ParserError||(t=new ParserError(i,`Property '${a}' is wrong. ${t.message}`,t)),r.strictAllKeys)l[a]=t;else throw t}let u=Object.keys(l);if(u.length)throw new KeyError(i,u,l);return o}static checkStrictProperty(t,r,a){let n=Object.keys(t),o=Object.keys(r),i=[];for(let t of n)-1===o.indexOf(t)&&i.push(t);if(i.length)throw new KeyError(a,i)}};function getValidations(t){let r=[];return t.pattern&&r.push(new PatternValidation(t.pattern)),(t.type===i.Number||t.type===i.Any)&&((void 0!==t.minInclusive||void 0!==t.maxInclusive)&&r.push(new InclusiveValidation(t.minInclusive,t.maxInclusive)),(void 0!==t.minExclusive||void 0!==t.maxExclusive)&&r.push(new ExclusiveValidation(t.minExclusive,t.maxExclusive)),void 0!==t.enumeration&&r.push(new EnumerationValidation(t.enumeration))),(t.type===i.String||t.repeated||t.type===i.Any)&&(void 0!==t.length||void 0!==t.minLength||void 0!==t.maxLength)&&r.push(new LengthValidation(t.length,t.minLength,t.maxLength)),r}let JsonProp=(t={})=>(r,a)=>{let n;let o=`Cannot set type for ${a} property of ${r.constructor.name} schema`;G.has(r.constructor)?(n=G.get(r.constructor)).target!==r.constructor&&(n=G.create(r.constructor),G.set(r.constructor,n)):(n=G.create(r.constructor),G.set(r.constructor,n));let s={type:i.Any,validations:[]},l=Object.assign(s,t);if(l.validations=getValidations(l),"number"!=typeof l.type&&!G.has(l.type)&&!index_es_isConvertible(l.type))throw Error(`${o}. Assigning type doesn't have schema.`);for(let r of Array.isArray(t.schema)?t.schema:[t.schema||J]){n.names[r]||(n.names[r]={});let t=n.names[r];t[a]=l}};/*!
 Copyright (c) Peculiar Ventures, LLC
*/let CryptoError=class CryptoError extends Error{};let AlgorithmError=class AlgorithmError extends CryptoError{};let UnsupportedOperationError=class UnsupportedOperationError extends CryptoError{constructor(t){super(`Unsupported operation: ${t?`${t}`:""}`)}};let OperationError=class OperationError extends CryptoError{};let RequiredPropertyError=class RequiredPropertyError extends CryptoError{constructor(t){super(`${t}: Missing required property`)}};function isJWK(t){return"object"==typeof t&&"kty"in t}let ProviderCrypto=class ProviderCrypto{async digest(...t){return this.checkDigest.apply(this,t),this.onDigest.apply(this,t)}checkDigest(t,r){this.checkAlgorithmName(t)}async onDigest(t,r){throw new UnsupportedOperationError("digest")}async generateKey(...t){return this.checkGenerateKey.apply(this,t),this.onGenerateKey.apply(this,t)}checkGenerateKey(t,r,a,...n){let o;if(this.checkAlgorithmName(t),this.checkGenerateKeyParams(t),!(a&&a.length))throw TypeError("Usages cannot be empty when creating a key.");o=Array.isArray(this.usages)?this.usages:this.usages.privateKey.concat(this.usages.publicKey),this.checkKeyUsages(a,o)}checkGenerateKeyParams(t){}async onGenerateKey(t,r,a,...n){throw new UnsupportedOperationError("generateKey")}async sign(...t){return this.checkSign.apply(this,t),this.onSign.apply(this,t)}checkSign(t,r,a,...n){this.checkAlgorithmName(t),this.checkAlgorithmParams(t),this.checkCryptoKey(r,"sign")}async onSign(t,r,a,...n){throw new UnsupportedOperationError("sign")}async verify(...t){return this.checkVerify.apply(this,t),this.onVerify.apply(this,t)}checkVerify(t,r,a,n,...o){this.checkAlgorithmName(t),this.checkAlgorithmParams(t),this.checkCryptoKey(r,"verify")}async onVerify(t,r,a,n,...o){throw new UnsupportedOperationError("verify")}async encrypt(...t){return this.checkEncrypt.apply(this,t),this.onEncrypt.apply(this,t)}checkEncrypt(t,r,a,n={},...o){this.checkAlgorithmName(t),this.checkAlgorithmParams(t),this.checkCryptoKey(r,n.keyUsage?"encrypt":void 0)}async onEncrypt(t,r,a,...n){throw new UnsupportedOperationError("encrypt")}async decrypt(...t){return this.checkDecrypt.apply(this,t),this.onDecrypt.apply(this,t)}checkDecrypt(t,r,a,n={},...o){this.checkAlgorithmName(t),this.checkAlgorithmParams(t),this.checkCryptoKey(r,n.keyUsage?"decrypt":void 0)}async onDecrypt(t,r,a,...n){throw new UnsupportedOperationError("decrypt")}async deriveBits(...t){return this.checkDeriveBits.apply(this,t),this.onDeriveBits.apply(this,t)}checkDeriveBits(t,r,a,n={},...o){if(this.checkAlgorithmName(t),this.checkAlgorithmParams(t),this.checkCryptoKey(r,n.keyUsage?"deriveBits":void 0),a%8!=0)throw new OperationError("length: Is not multiple of 8")}async onDeriveBits(t,r,a,...n){throw new UnsupportedOperationError("deriveBits")}async exportKey(...t){return this.checkExportKey.apply(this,t),this.onExportKey.apply(this,t)}checkExportKey(t,r,...a){if(this.checkKeyFormat(t),this.checkCryptoKey(r),!r.extractable)throw new CryptoError("key: Is not extractable")}async onExportKey(t,r,...a){throw new UnsupportedOperationError("exportKey")}async importKey(...t){return this.checkImportKey.apply(this,t),this.onImportKey.apply(this,t)}checkImportKey(t,r,a,n,o,...i){this.checkKeyFormat(t),this.checkKeyData(t,r),this.checkAlgorithmName(a),this.checkImportParams(a),Array.isArray(this.usages)&&this.checkKeyUsages(o,this.usages)}async onImportKey(t,r,a,n,o,...i){throw new UnsupportedOperationError("importKey")}checkAlgorithmName(t){if(t.name.toLowerCase()!==this.name.toLowerCase())throw new AlgorithmError("Unrecognized name")}checkAlgorithmParams(t){}checkDerivedKeyParams(t){}checkKeyUsages(t,r){for(let a of t)if(-1===r.indexOf(a))throw TypeError("Cannot create a key using the specified key usages")}checkCryptoKey(t,r){if(this.checkAlgorithmName(t.algorithm),r&&-1===t.usages.indexOf(r))throw new CryptoError("key does not match that of operation")}checkRequiredProperty(t,r){if(!(r in t))throw new RequiredPropertyError(r)}checkHashAlgorithm(t,r){for(let a of r)if(a.toLowerCase()===t.name.toLowerCase())return;throw new OperationError(`hash: Must be one of ${r.join(", ")}`)}checkImportParams(t){}checkKeyFormat(t){switch(t){case"raw":case"pkcs8":case"spki":case"jwk":break;default:throw TypeError("format: Is invalid value. Must be 'jwk', 'raw', 'spki', or 'pkcs8'")}}checkKeyData(t,r){if(!r)throw TypeError("keyData: Cannot be empty on empty on key importing");if("jwk"===t){if(!isJWK(r))throw TypeError("keyData: Is not JsonWebToken")}else if(!index_es_BufferSourceConverter.isBufferSource(r))throw TypeError("keyData: Is not ArrayBufferView or ArrayBuffer")}prepareData(t){return index_es_BufferSourceConverter.toArrayBuffer(t)}};let AesProvider=class AesProvider extends ProviderCrypto{checkGenerateKeyParams(t){if(this.checkRequiredProperty(t,"length"),"number"!=typeof t.length)throw TypeError("length: Is not of type Number");switch(t.length){case 128:case 192:case 256:break;default:throw TypeError("length: Must be 128, 192, or 256")}}checkDerivedKeyParams(t){this.checkGenerateKeyParams(t)}};let webcrypto_core_es_AesCbcProvider=class webcrypto_core_es_AesCbcProvider extends AesProvider{constructor(){super(...arguments),this.name="AES-CBC",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(t){if(this.checkRequiredProperty(t,"iv"),!(t.iv instanceof ArrayBuffer||ArrayBuffer.isView(t.iv)))throw TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==t.iv.byteLength)throw TypeError("iv: Must have length 16 bytes")}};let webcrypto_core_es_AesCmacProvider=class webcrypto_core_es_AesCmacProvider extends AesProvider{constructor(){super(...arguments),this.name="AES-CMAC",this.usages=["sign","verify"]}checkAlgorithmParams(t){if(this.checkRequiredProperty(t,"length"),"number"!=typeof t.length)throw TypeError("length: Is not a Number");if(t.length<1)throw new OperationError("length: Must be more than 0")}};let webcrypto_core_es_AesCtrProvider=class webcrypto_core_es_AesCtrProvider extends AesProvider{constructor(){super(...arguments),this.name="AES-CTR",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(t){if(this.checkRequiredProperty(t,"counter"),!(t.counter instanceof ArrayBuffer||ArrayBuffer.isView(t.counter)))throw TypeError("counter: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==t.counter.byteLength)throw TypeError("iv: Must have length 16 bytes");if(this.checkRequiredProperty(t,"length"),"number"!=typeof t.length)throw TypeError("length: Is not a Number");if(t.length<1)throw new OperationError("length: Must be more than 0")}};let webcrypto_core_es_AesEcbProvider=class webcrypto_core_es_AesEcbProvider extends AesProvider{constructor(){super(...arguments),this.name="AES-ECB",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}};let webcrypto_core_es_AesGcmProvider=class webcrypto_core_es_AesGcmProvider extends AesProvider{constructor(){super(...arguments),this.name="AES-GCM",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(t){if(this.checkRequiredProperty(t,"iv"),!(t.iv instanceof ArrayBuffer||ArrayBuffer.isView(t.iv)))throw TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(t.iv.byteLength<1)throw new OperationError("iv: Must have length more than 0 and less than 2^64 - 1");switch("tagLength"in t||(t.tagLength=128),t.tagLength){case 32:case 64:case 96:case 104:case 112:case 120:case 128:break;default:throw new OperationError("tagLength: Must be one of 32, 64, 96, 104, 112, 120 or 128")}}};let webcrypto_core_es_AesKwProvider=class webcrypto_core_es_AesKwProvider extends AesProvider{constructor(){super(...arguments),this.name="AES-KW",this.usages=["wrapKey","unwrapKey"]}};let DesProvider=class DesProvider extends ProviderCrypto{constructor(){super(...arguments),this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(t){if(this.ivSize){if(this.checkRequiredProperty(t,"iv"),!(t.iv instanceof ArrayBuffer||ArrayBuffer.isView(t.iv)))throw TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(t.iv.byteLength!==this.ivSize)throw TypeError(`iv: Must have length ${this.ivSize} bytes`)}}checkGenerateKeyParams(t){if(this.checkRequiredProperty(t,"length"),"number"!=typeof t.length)throw TypeError("length: Is not of type Number");if(t.length!==this.keySizeBits)throw new OperationError(`algorithm.length: Must be ${this.keySizeBits}`)}checkDerivedKeyParams(t){this.checkGenerateKeyParams(t)}};let RsaProvider=class RsaProvider extends ProviderCrypto{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"]}checkGenerateKeyParams(t){if(this.checkRequiredProperty(t,"hash"),this.checkHashAlgorithm(t.hash,this.hashAlgorithms),this.checkRequiredProperty(t,"publicExponent"),!(t.publicExponent&&t.publicExponent instanceof Uint8Array))throw TypeError("publicExponent: Missing or not a Uint8Array");let r=index_es_Convert.ToBase64(t.publicExponent);if(!("Aw=="===r||"AQAB"===r))throw TypeError("publicExponent: Must be [3] or [1,0,1]");if(this.checkRequiredProperty(t,"modulusLength"),t.modulusLength%8||t.modulusLength<256||t.modulusLength>16384)throw TypeError("The modulus length must be a multiple of 8 bits and >= 256 and <= 16384")}checkImportParams(t){this.checkRequiredProperty(t,"hash"),this.checkHashAlgorithm(t.hash,this.hashAlgorithms)}};let webcrypto_core_es_RsaSsaProvider=class webcrypto_core_es_RsaSsaProvider extends RsaProvider{constructor(){super(...arguments),this.name="RSASSA-PKCS1-v1_5",this.usages={privateKey:["sign"],publicKey:["verify"]}}};let webcrypto_core_es_RsaPssProvider=class webcrypto_core_es_RsaPssProvider extends RsaProvider{constructor(){super(...arguments),this.name="RSA-PSS",this.usages={privateKey:["sign"],publicKey:["verify"]}}checkAlgorithmParams(t){if(this.checkRequiredProperty(t,"saltLength"),"number"!=typeof t.saltLength)throw TypeError("saltLength: Is not a Number");if(t.saltLength<0)throw RangeError("saltLength: Must be positive number")}};let webcrypto_core_es_RsaOaepProvider=class webcrypto_core_es_RsaOaepProvider extends RsaProvider{constructor(){super(...arguments),this.name="RSA-OAEP",this.usages={privateKey:["decrypt","unwrapKey"],publicKey:["encrypt","wrapKey"]}}checkAlgorithmParams(t){if(t.label&&!(t.label instanceof ArrayBuffer||ArrayBuffer.isView(t.label)))throw TypeError("label: Is not of type '(ArrayBuffer or ArrayBufferView)'")}};let EllipticProvider=class EllipticProvider extends ProviderCrypto{checkGenerateKeyParams(t){this.checkRequiredProperty(t,"namedCurve"),this.checkNamedCurve(t.namedCurve)}checkNamedCurve(t){for(let r of this.namedCurves)if(r.toLowerCase()===t.toLowerCase())return;throw new OperationError(`namedCurve: Must be one of ${this.namedCurves.join(", ")}`)}};let webcrypto_core_es_EcdsaProvider=class webcrypto_core_es_EcdsaProvider extends EllipticProvider{constructor(){super(...arguments),this.name="ECDSA",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages={privateKey:["sign"],publicKey:["verify"]},this.namedCurves=["P-256","P-384","P-521","K-256"]}checkAlgorithmParams(t){this.checkRequiredProperty(t,"hash"),this.checkHashAlgorithm(t.hash,this.hashAlgorithms)}};let Y=["secret","private","public"];let webcrypto_core_es_CryptoKey=class webcrypto_core_es_CryptoKey{static create(t,r,a,n){let o=new this;return o.algorithm=t,o.type=r,o.extractable=a,o.usages=n,o}static isKeyType(t){return -1!==Y.indexOf(t)}get[Symbol.toStringTag](){return"CryptoKey"}};let webcrypto_core_es_EcdhProvider=class webcrypto_core_es_EcdhProvider extends EllipticProvider{constructor(){super(...arguments),this.name="ECDH",this.usages={privateKey:["deriveBits","deriveKey"],publicKey:[]},this.namedCurves=["P-256","P-384","P-521","K-256"]}checkAlgorithmParams(t){if(this.checkRequiredProperty(t,"public"),!(t.public instanceof webcrypto_core_es_CryptoKey))throw TypeError("public: Is not a CryptoKey");if("public"!==t.public.type)throw new OperationError("public: Is not a public key");if(t.public.algorithm.name!==this.name)throw new OperationError(`public: Is not ${this.name} key`)}};let webcrypto_core_es_EcdhEsProvider=class webcrypto_core_es_EcdhEsProvider extends webcrypto_core_es_EcdhProvider{constructor(){super(...arguments),this.name="ECDH-ES",this.namedCurves=["X25519","X448"]}};let webcrypto_core_es_EdDsaProvider=class webcrypto_core_es_EdDsaProvider extends EllipticProvider{constructor(){super(...arguments),this.name="EdDSA",this.usages={privateKey:["sign"],publicKey:["verify"]},this.namedCurves=["Ed25519","Ed448"]}};let Q=class{constructor(t){t&&(this.value=t)}};(0,$.gn)([AsnProp({type:o.ObjectIdentifier})],Q.prototype,"value",void 0),Q=(0,$.gn)([AsnType({type:n.Choice})],Q);let AlgorithmIdentifier=class AlgorithmIdentifier{constructor(t){Object.assign(this,t)}};(0,$.gn)([AsnProp({type:o.ObjectIdentifier})],AlgorithmIdentifier.prototype,"algorithm",void 0),(0,$.gn)([AsnProp({type:o.Any,optional:!0})],AlgorithmIdentifier.prototype,"parameters",void 0);let PrivateKeyInfo=class PrivateKeyInfo{constructor(){this.version=0,this.privateKeyAlgorithm=new AlgorithmIdentifier,this.privateKey=new ArrayBuffer(0)}};(0,$.gn)([AsnProp({type:o.Integer})],PrivateKeyInfo.prototype,"version",void 0),(0,$.gn)([AsnProp({type:AlgorithmIdentifier})],PrivateKeyInfo.prototype,"privateKeyAlgorithm",void 0),(0,$.gn)([AsnProp({type:o.OctetString})],PrivateKeyInfo.prototype,"privateKey",void 0),(0,$.gn)([AsnProp({type:o.Any,optional:!0})],PrivateKeyInfo.prototype,"attributes",void 0);let PublicKeyInfo=class PublicKeyInfo{constructor(){this.publicKeyAlgorithm=new AlgorithmIdentifier,this.publicKey=new ArrayBuffer(0)}};(0,$.gn)([AsnProp({type:AlgorithmIdentifier})],PublicKeyInfo.prototype,"publicKeyAlgorithm",void 0),(0,$.gn)([AsnProp({type:o.BitString})],PublicKeyInfo.prototype,"publicKey",void 0);let X={fromJSON:t=>index_es_Convert.FromBase64Url(t),toJSON:t=>index_es_Convert.ToBase64Url(new Uint8Array(t))},Z={fromASN:t=>{let r=t.valueBlock.valueHex;return new Uint8Array(r)[0]?t.valueBlock.valueHex:t.valueBlock.valueHex.slice(1)},toASN:t=>{let r=new Uint8Array(t)[0]>127?combine(new Uint8Array([0]).buffer,t):t;return new Integer({valueHex:r})}};let RsaPrivateKey=class RsaPrivateKey{constructor(){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0)}};(0,$.gn)([AsnProp({type:o.Integer,converter:_})],RsaPrivateKey.prototype,"version",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"n",converter:X})],RsaPrivateKey.prototype,"modulus",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"e",converter:X})],RsaPrivateKey.prototype,"publicExponent",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"d",converter:X})],RsaPrivateKey.prototype,"privateExponent",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"p",converter:X})],RsaPrivateKey.prototype,"prime1",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"q",converter:X})],RsaPrivateKey.prototype,"prime2",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"dp",converter:X})],RsaPrivateKey.prototype,"exponent1",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"dq",converter:X})],RsaPrivateKey.prototype,"exponent2",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"qi",converter:X})],RsaPrivateKey.prototype,"coefficient",void 0),(0,$.gn)([AsnProp({type:o.Any,optional:!0})],RsaPrivateKey.prototype,"otherPrimeInfos",void 0);let RsaPublicKey=class RsaPublicKey{constructor(){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0)}};(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"n",converter:X})],RsaPublicKey.prototype,"modulus",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:Z}),JsonProp({name:"e",converter:X})],RsaPublicKey.prototype,"publicExponent",void 0);let ee=class{constructor(t){this.value=new ArrayBuffer(0),t&&(this.value=t)}toJSON(){let t=new Uint8Array(this.value);if(4!==t[0])throw new CryptoError("Wrong ECPoint. Current version supports only Uncompressed (0x04) point");t=new Uint8Array(this.value.slice(1));let r=t.length/2,a={x:index_es_Convert.ToBase64Url(t.buffer.slice(0,0+r)),y:index_es_Convert.ToBase64Url(t.buffer.slice(0+r,0+r+r))};return a}fromJSON(t){if(!("x"in t))throw Error("x: Missing required property");if(!("y"in t))throw Error("y: Missing required property");let r=index_es_Convert.FromBase64Url(t.x),a=index_es_Convert.FromBase64Url(t.y),n=combine(new Uint8Array([4]).buffer,r,a);return this.value=new Uint8Array(n).buffer,this}};(0,$.gn)([AsnProp({type:o.OctetString})],ee.prototype,"value",void 0),ee=(0,$.gn)([AsnType({type:n.Choice})],ee);let EcPrivateKey=class EcPrivateKey{constructor(){this.version=1,this.privateKey=new ArrayBuffer(0)}fromJSON(t){if(!("d"in t))throw Error("d: Missing required property");if(this.privateKey=index_es_Convert.FromBase64Url(t.d),"x"in t){let r=new ee;r.fromJSON(t);let a=AsnSerializer.toASN(r);"valueHex"in a.valueBlock&&(this.publicKey=a.valueBlock.valueHex)}return this}toJSON(){let t={};return t.d=index_es_Convert.ToBase64Url(this.privateKey),this.publicKey&&Object.assign(t,new ee(this.publicKey).toJSON()),t}};(0,$.gn)([AsnProp({type:o.Integer,converter:_})],EcPrivateKey.prototype,"version",void 0),(0,$.gn)([AsnProp({type:o.OctetString})],EcPrivateKey.prototype,"privateKey",void 0),(0,$.gn)([AsnProp({context:0,type:o.Any,optional:!0})],EcPrivateKey.prototype,"parameters",void 0),(0,$.gn)([AsnProp({context:1,type:o.BitString,optional:!0})],EcPrivateKey.prototype,"publicKey",void 0);let et={fromASN:t=>{let r=new Uint8Array(t.valueBlock.valueHex);return 0===r[0]?r.buffer.slice(1):r.buffer},toASN:t=>{let r=new Uint8Array(t);if(r[0]>127){let t=new Uint8Array(r.length+1);return t.set(r,1),new Integer({valueHex:t.buffer})}return new Integer({valueHex:t})}};var er=Object.freeze({__proto__:null,AsnIntegerWithoutPaddingConverter:et});let EcUtils=class EcUtils{static decodePoint(t,r){let a=index_es_BufferSourceConverter.toUint8Array(t);if(0===a.length||4!==a[0])throw Error("Only uncompressed point format supported");let n=(a.length-1)/2;if(n!==Math.ceil(r/8))throw Error("Point does not match field size");let o=a.slice(1,n+1),i=a.slice(n+1,n+1+n);return{x:o,y:i}}static encodePoint(t,r){let a=Math.ceil(r/8);if(t.x.byteLength!==a||t.y.byteLength!==a)throw Error("X,Y coordinates don't match point size criteria");let n=index_es_BufferSourceConverter.toUint8Array(t.x),o=index_es_BufferSourceConverter.toUint8Array(t.y),i=new Uint8Array(2*a+1);return i[0]=4,i.set(n,1),i.set(o,a+1),i}static getSize(t){return Math.ceil(t/8)}static encodeSignature(t,r){let a=this.getSize(r),n=index_es_BufferSourceConverter.toUint8Array(t.r),o=index_es_BufferSourceConverter.toUint8Array(t.s),i=new Uint8Array(2*a);return i.set(this.padStart(n,a)),i.set(this.padStart(o,a),a),i}static decodeSignature(t,r){let a=this.getSize(r),n=index_es_BufferSourceConverter.toUint8Array(t);if(n.length!==2*a)throw Error("Incorrect size of the signature");let o=n.slice(0,a),i=n.slice(a);return{r:this.trimStart(o),s:this.trimStart(i)}}static trimStart(t){let r=0;for(;r<t.length-1&&0===t[r];)r++;return 0===r?t:t.slice(r,t.length)}static padStart(t,r){if(r===t.length)return t;let a=new Uint8Array(r);return a.set(t,r-t.length),a}};let EcDsaSignature=class EcDsaSignature{constructor(){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0)}static fromWebCryptoSignature(t){let r=t.byteLength/2,a=EcUtils.decodeSignature(t,8*r),n=new EcDsaSignature;return n.r=index_es_BufferSourceConverter.toArrayBuffer(a.r),n.s=index_es_BufferSourceConverter.toArrayBuffer(a.s),n}toWebCryptoSignature(t){null!=t||(t=8*Math.max(this.r.byteLength,this.s.byteLength));let r=EcUtils.encodeSignature(this,t);return r.buffer}};(0,$.gn)([AsnProp({type:o.Integer,converter:et})],EcDsaSignature.prototype,"r",void 0),(0,$.gn)([AsnProp({type:o.Integer,converter:et})],EcDsaSignature.prototype,"s",void 0);let OneAsymmetricKey=class OneAsymmetricKey extends PrivateKeyInfo{};(0,$.gn)([AsnProp({context:1,implicit:!0,type:o.BitString,optional:!0})],OneAsymmetricKey.prototype,"publicKey",void 0);let ea=class{constructor(){this.value=new ArrayBuffer(0)}fromJSON(t){if(!t.d)throw Error("d: Missing required property");return this.value=index_es_Convert.FromBase64Url(t.d),this}toJSON(){let t={d:index_es_Convert.ToBase64Url(this.value)};return t}};(0,$.gn)([AsnProp({type:o.OctetString})],ea.prototype,"value",void 0),ea=(0,$.gn)([AsnType({type:n.Choice})],ea);let en=class{constructor(t){this.value=new ArrayBuffer(0),t&&(this.value=t)}toJSON(){let t={x:index_es_Convert.ToBase64Url(this.value)};return t}fromJSON(t){if(!("x"in t))throw Error("x: Missing required property");return this.value=index_es_Convert.FromBase64Url(t.x),this}};(0,$.gn)([AsnProp({type:o.BitString})],en.prototype,"value",void 0),en=(0,$.gn)([AsnType({type:n.Choice})],en);let eo=class{};(0,$.gn)([AsnProp({type:o.OctetString}),JsonProp({type:i.String,converter:X})],eo.prototype,"d",void 0),eo=(0,$.gn)([AsnType({type:n.Choice})],eo);let ei="1.2.840.10045.3.1.7",es="1.3.132.0",el=`${es}.34`,eu=`${es}.35`,ec=`${es}.10`,ed="1.3.36.3.3.2.8.1.1",eh=`${ed}.1`,ef=`${ed}.2`,ep=`${ed}.3`,em=`${ed}.4`,ey=`${ed}.5`,eg=`${ed}.6`,eb=`${ed}.7`,eS=`${ed}.8`,ev=`${ed}.9`,eC=`${ed}.10`,ew=`${ed}.11`,eA=`${ed}.12`,e_=`${ed}.13`,ek=`${ed}.14`;var eE=Object.freeze({__proto__:null,AlgorithmIdentifier:AlgorithmIdentifier,get CurvePrivateKey(){return eo},EcDsaSignature:EcDsaSignature,EcPrivateKey:EcPrivateKey,get EcPublicKey(){return ee},get EdPrivateKey(){return ea},get EdPublicKey(){return en},get ObjectIdentifier(){return Q},OneAsymmetricKey:OneAsymmetricKey,PrivateKeyInfo:PrivateKeyInfo,PublicKeyInfo:PublicKeyInfo,RsaPrivateKey:RsaPrivateKey,RsaPublicKey:RsaPublicKey,converters:er,idBrainpoolP160r1:eh,idBrainpoolP160t1:ef,idBrainpoolP192r1:ep,idBrainpoolP192t1:em,idBrainpoolP224r1:ey,idBrainpoolP224t1:eg,idBrainpoolP256r1:eb,idBrainpoolP256t1:eS,idBrainpoolP320r1:ev,idBrainpoolP320t1:eC,idBrainpoolP384r1:ew,idBrainpoolP384t1:eA,idBrainpoolP512r1:e_,idBrainpoolP512t1:ek,idEd25519:"1.3.101.112",idEd448:"1.3.101.113",idEllipticCurve:es,idSecp256k1:ec,idSecp256r1:ei,idSecp384r1:el,idSecp521r1:eu,idVersionOne:ed,idX25519:"1.3.101.110",idX448:"1.3.101.111"});let EcCurves=class EcCurves{constructor(){}static register(t){let r=new Q;r.value=t.id;let a=AsnConvert.serialize(r);this.items.push({...t,raw:a}),this.names.push(t.name)}static find(t){for(let r of(t=t.toUpperCase(),this.items))if(r.name.toUpperCase()===t||r.id.toUpperCase()===t)return r;return null}static get(t){let r=this.find(t);if(!r)throw Error(`Unsupported EC named curve '${t}'`);return r}};EcCurves.items=[],EcCurves.names=[],EcCurves.register({name:"P-256",id:ei,size:256}),EcCurves.register({name:"P-384",id:el,size:384}),EcCurves.register({name:"P-521",id:eu,size:521}),EcCurves.register({name:"K-256",id:ec,size:256}),EcCurves.register({name:"brainpoolP160r1",id:eh,size:160}),EcCurves.register({name:"brainpoolP160t1",id:ef,size:160}),EcCurves.register({name:"brainpoolP192r1",id:ep,size:192}),EcCurves.register({name:"brainpoolP192t1",id:em,size:192}),EcCurves.register({name:"brainpoolP224r1",id:ey,size:224}),EcCurves.register({name:"brainpoolP224t1",id:eg,size:224}),EcCurves.register({name:"brainpoolP256r1",id:eb,size:256}),EcCurves.register({name:"brainpoolP256t1",id:eS,size:256}),EcCurves.register({name:"brainpoolP320r1",id:ev,size:320}),EcCurves.register({name:"brainpoolP320t1",id:eC,size:320}),EcCurves.register({name:"brainpoolP384r1",id:ew,size:384}),EcCurves.register({name:"brainpoolP384t1",id:eA,size:384}),EcCurves.register({name:"brainpoolP512r1",id:e_,size:512}),EcCurves.register({name:"brainpoolP512t1",id:ek,size:512});let webcrypto_core_es_HmacProvider=class webcrypto_core_es_HmacProvider extends ProviderCrypto{constructor(){super(...arguments),this.name="HMAC",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["sign","verify"]}getDefaultLength(t){switch(t.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":return 512;default:throw Error(`Unknown algorithm name '${t}'`)}}checkGenerateKeyParams(t){if(this.checkRequiredProperty(t,"hash"),this.checkHashAlgorithm(t.hash,this.hashAlgorithms),"length"in t){if("number"!=typeof t.length)throw TypeError("length: Is not a Number");if(t.length<1)throw RangeError("length: Number is out of range")}}checkImportParams(t){this.checkRequiredProperty(t,"hash"),this.checkHashAlgorithm(t.hash,this.hashAlgorithms)}};let webcrypto_core_es_Pbkdf2Provider=class webcrypto_core_es_Pbkdf2Provider extends ProviderCrypto{constructor(){super(...arguments),this.name="PBKDF2",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["deriveBits","deriveKey"]}checkAlgorithmParams(t){if(this.checkRequiredProperty(t,"hash"),this.checkHashAlgorithm(t.hash,this.hashAlgorithms),this.checkRequiredProperty(t,"salt"),!(t.salt instanceof ArrayBuffer||ArrayBuffer.isView(t.salt)))throw TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(this.checkRequiredProperty(t,"iterations"),"number"!=typeof t.iterations)throw TypeError("iterations: Is not a Number");if(t.iterations<1)throw TypeError("iterations: Is less than 1")}checkImportKey(t,r,a,n,o,...i){if(super.checkImportKey(t,r,a,n,o),n)throw SyntaxError("extractable: Must be 'false'")}};let webcrypto_core_es_HkdfProvider=class webcrypto_core_es_HkdfProvider extends ProviderCrypto{constructor(){super(...arguments),this.name="HKDF",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["deriveKey","deriveBits"]}checkAlgorithmParams(t){if(this.checkRequiredProperty(t,"hash"),this.checkHashAlgorithm(t.hash,this.hashAlgorithms),this.checkRequiredProperty(t,"salt"),!index_es_BufferSourceConverter.isBufferSource(t.salt)||(this.checkRequiredProperty(t,"info"),!index_es_BufferSourceConverter.isBufferSource(t.info)))throw TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'")}checkImportKey(t,r,a,n,o,...i){if(super.checkImportKey(t,r,a,n,o),n)throw SyntaxError("extractable: Must be 'false'")}};let ShakeProvider=class ShakeProvider extends ProviderCrypto{constructor(){super(...arguments),this.usages=[],this.defaultLength=0}digest(...t){return t[0]={length:this.defaultLength,...t[0]},super.digest.apply(this,t)}checkDigest(t,r){super.checkDigest(t,r);let a=t.length||0;if("number"!=typeof a)throw TypeError("length: Is not a Number");if(a<0)throw TypeError("length: Is negative")}};let webcrypto_core_es_Shake128Provider=class webcrypto_core_es_Shake128Provider extends ShakeProvider{constructor(){super(...arguments),this.name="shake128",this.defaultLength=16}};let webcrypto_core_es_Shake256Provider=class webcrypto_core_es_Shake256Provider extends ShakeProvider{constructor(){super(...arguments),this.name="shake256",this.defaultLength=32}};let webcrypto_core_es_Crypto=class webcrypto_core_es_Crypto{get[Symbol.toStringTag](){return"Crypto"}randomUUID(){let t=this.getRandomValues(new Uint8Array(16));t[6]=15&t[6]|64,t[8]=63&t[8]|128;let r=index_es_Convert.ToHex(t).toLowerCase();return`${r.substring(0,8)}-${r.substring(8,12)}-${r.substring(12,16)}-${r.substring(16,20)}-${r.substring(20)}`}};let ProviderStorage=class ProviderStorage{constructor(){this.items={}}get(t){return this.items[t.toLowerCase()]||null}set(t){this.items[t.name.toLowerCase()]=t}removeAt(t){let r=this.get(t.toLowerCase());return r&&delete this.items[t],r}has(t){return!!this.get(t)}get length(){return Object.keys(this.items).length}get algorithms(){let t=[];for(let r in this.items){let a=this.items[r];t.push(a.name)}return t.sort()}};let webcrypto_core_es_SubtleCrypto=class webcrypto_core_es_SubtleCrypto{constructor(){this.providers=new ProviderStorage}static isHashedAlgorithm(t){return!!t&&"object"==typeof t&&"name"in t&&"hash"in t}get[Symbol.toStringTag](){return"SubtleCrypto"}async digest(...t){this.checkRequiredArguments(t,2,"digest");let[r,a,...n]=t,o=this.prepareAlgorithm(r),i=index_es_BufferSourceConverter.toArrayBuffer(a),s=this.getProvider(o.name),l=await s.digest(o,i,...n);return l}async generateKey(...t){this.checkRequiredArguments(t,3,"generateKey");let[r,a,n,...o]=t,i=this.prepareAlgorithm(r),s=this.getProvider(i.name),l=await s.generateKey({...i,name:s.name},a,n,...o);return l}async sign(...t){this.checkRequiredArguments(t,3,"sign");let[r,a,n,...o]=t;this.checkCryptoKey(a);let i=this.prepareAlgorithm(r),s=index_es_BufferSourceConverter.toArrayBuffer(n),l=this.getProvider(i.name),u=await l.sign({...i,name:l.name},a,s,...o);return u}async verify(...t){this.checkRequiredArguments(t,4,"verify");let[r,a,n,o,...i]=t;this.checkCryptoKey(a);let s=this.prepareAlgorithm(r),l=index_es_BufferSourceConverter.toArrayBuffer(o),u=index_es_BufferSourceConverter.toArrayBuffer(n),c=this.getProvider(s.name),d=await c.verify({...s,name:c.name},a,u,l,...i);return d}async encrypt(...t){this.checkRequiredArguments(t,3,"encrypt");let[r,a,n,...o]=t;this.checkCryptoKey(a);let i=this.prepareAlgorithm(r),s=index_es_BufferSourceConverter.toArrayBuffer(n),l=this.getProvider(i.name),u=await l.encrypt({...i,name:l.name},a,s,{keyUsage:!0},...o);return u}async decrypt(...t){this.checkRequiredArguments(t,3,"decrypt");let[r,a,n,...o]=t;this.checkCryptoKey(a);let i=this.prepareAlgorithm(r),s=index_es_BufferSourceConverter.toArrayBuffer(n),l=this.getProvider(i.name),u=await l.decrypt({...i,name:l.name},a,s,{keyUsage:!0},...o);return u}async deriveBits(...t){this.checkRequiredArguments(t,3,"deriveBits");let[r,a,n,...o]=t;this.checkCryptoKey(a);let i=this.prepareAlgorithm(r),s=this.getProvider(i.name),l=await s.deriveBits({...i,name:s.name},a,n,{keyUsage:!0},...o);return l}async deriveKey(...t){this.checkRequiredArguments(t,5,"deriveKey");let[r,a,n,o,i,...s]=t,l=this.prepareAlgorithm(n),u=this.getProvider(l.name);u.checkDerivedKeyParams(l);let c=this.prepareAlgorithm(r),d=this.getProvider(c.name);d.checkCryptoKey(a,"deriveKey");let h=await d.deriveBits({...c,name:d.name},a,n.length||512,{keyUsage:!1},...s);return this.importKey("raw",h,n,o,i,...s)}async exportKey(...t){this.checkRequiredArguments(t,2,"exportKey");let[r,a,...n]=t;this.checkCryptoKey(a);let o=this.getProvider(a.algorithm.name),i=await o.exportKey(r,a,...n);return i}async importKey(...t){this.checkRequiredArguments(t,5,"importKey");let[r,a,n,o,i,...s]=t,l=this.prepareAlgorithm(n),u=this.getProvider(l.name);if(-1!==["pkcs8","spki","raw"].indexOf(r)){let t=index_es_BufferSourceConverter.toArrayBuffer(a);return u.importKey(r,t,{...l,name:u.name},o,i,...s)}if(!a.kty)throw TypeError("keyData: Is not JSON");return u.importKey(r,a,{...l,name:u.name},o,i,...s)}async wrapKey(t,r,a,n,...o){let i=await this.exportKey(t,r,...o);if("jwk"===t){let t=JSON.stringify(i);i=index_es_Convert.FromUtf8String(t)}let s=this.prepareAlgorithm(n),l=index_es_BufferSourceConverter.toArrayBuffer(i),u=this.getProvider(s.name);return u.encrypt({...s,name:u.name},a,l,{keyUsage:!1},...o)}async unwrapKey(t,r,a,n,o,i,s,...l){let u=this.prepareAlgorithm(n),c=index_es_BufferSourceConverter.toArrayBuffer(r),d=this.getProvider(u.name),h=await d.decrypt({...u,name:d.name},a,c,{keyUsage:!1},...l);if("jwk"===t)try{h=JSON.parse(index_es_Convert.ToUtf8String(h))}catch(r){let t=TypeError("wrappedKey: Is not a JSON");throw t.internal=r,t}return this.importKey(t,h,o,i,s,...l)}checkRequiredArguments(t,r,a){if(t.length<r)throw TypeError(`Failed to execute '${a}' on 'SubtleCrypto': ${r} arguments required, but only ${t.length} present`)}prepareAlgorithm(t){if("string"==typeof t)return{name:t};if(webcrypto_core_es_SubtleCrypto.isHashedAlgorithm(t)){let r={...t};return r.hash=this.prepareAlgorithm(t.hash),r}return{...t}}getProvider(t){let r=this.providers.get(t);if(!r)throw new AlgorithmError("Unrecognized name");return r}checkCryptoKey(t){if(!(t instanceof webcrypto_core_es_CryptoKey))throw TypeError("Key is not of type 'CryptoKey'")}};var eR=a(6113),eB=a.n(eR),eP=a(77282);/*!
 Copyright (c) Peculiar Ventures, LLC
*/let ex={fromJSON:t=>Buffer.from(index_es_Convert.FromBase64Url(t)),toJSON:t=>index_es_Convert.ToBase64Url(t)};let CryptoKey=class CryptoKey extends webcrypto_core_es_CryptoKey{constructor(){super(...arguments),this.data=Buffer.alloc(0),this.algorithm={name:""},this.extractable=!1,this.type="secret",this.usages=[],this.kty="oct",this.alg=""}};(0,$.gn)([JsonProp({name:"ext",type:i.Boolean,optional:!0})],CryptoKey.prototype,"extractable",void 0),(0,$.gn)([JsonProp({name:"key_ops",type:i.String,repeated:!0,optional:!0})],CryptoKey.prototype,"usages",void 0),(0,$.gn)([JsonProp({type:i.String})],CryptoKey.prototype,"kty",void 0),(0,$.gn)([JsonProp({type:i.String,optional:!0})],CryptoKey.prototype,"alg",void 0);let SymmetricKey=class SymmetricKey extends CryptoKey{constructor(){super(...arguments),this.kty="oct",this.type="secret"}};let AsymmetricKey=class AsymmetricKey extends CryptoKey{};let AesCryptoKey=class AesCryptoKey extends SymmetricKey{get alg(){switch(this.algorithm.name.toUpperCase()){case"AES-CBC":return`A${this.algorithm.length}CBC`;case"AES-CTR":return`A${this.algorithm.length}CTR`;case"AES-GCM":return`A${this.algorithm.length}GCM`;case"AES-KW":return`A${this.algorithm.length}KW`;case"AES-CMAC":return`A${this.algorithm.length}CMAC`;case"AES-ECB":return`A${this.algorithm.length}ECB`;default:throw new AlgorithmError("Unsupported algorithm name")}}set alg(t){}};(0,$.gn)([JsonProp({name:"k",converter:ex})],AesCryptoKey.prototype,"data",void 0);let eI=new WeakMap;function getCryptoKey(t){let r=eI.get(t);if(!r)throw new OperationError("Cannot get CryptoKey from secure storage");return r}function setCryptoKey(t){let r=webcrypto_core_es_CryptoKey.create(t.algorithm,t.type,t.extractable,t.usages);return Object.freeze(r),eI.set(r,t),r}let AesCrypto=class AesCrypto{static async generateKey(t,r,a){let n=new AesCryptoKey;return n.algorithm=t,n.extractable=r,n.usages=a,n.data=eB().randomBytes(t.length>>3),n}static async exportKey(t,r){if(!(r instanceof AesCryptoKey))throw Error("key: Is not AesCryptoKey");switch(t.toLowerCase()){case"jwk":return JsonSerializer.toJSON(r);case"raw":return new Uint8Array(r.data).buffer;default:throw new OperationError("format: Must be 'jwk' or 'raw'")}}static async importKey(t,r,a,n,o){let i;switch(t.toLowerCase()){case"jwk":i=JsonParser.fromJSON(r,{targetSchema:AesCryptoKey});break;case"raw":(i=new AesCryptoKey).data=Buffer.from(r);break;default:throw new OperationError("format: Must be 'jwk' or 'raw'")}switch(i.algorithm=a,i.algorithm.length=i.data.length<<3,i.extractable=n,i.usages=o,i.algorithm.length){case 128:case 192:case 256:break;default:throw new OperationError("keyData: Is wrong key length")}return i}static async encrypt(t,r,a){switch(t.name.toUpperCase()){case"AES-CBC":return this.encryptAesCBC(t,r,Buffer.from(a));case"AES-CTR":return this.encryptAesCTR(t,r,Buffer.from(a));case"AES-GCM":return this.encryptAesGCM(t,r,Buffer.from(a));case"AES-KW":return this.encryptAesKW(t,r,Buffer.from(a));case"AES-ECB":return this.encryptAesECB(t,r,Buffer.from(a));default:throw new OperationError("algorithm: Is not recognized")}}static async decrypt(t,r,a){if(!(r instanceof AesCryptoKey))throw Error("key: Is not AesCryptoKey");switch(t.name.toUpperCase()){case"AES-CBC":return this.decryptAesCBC(t,r,Buffer.from(a));case"AES-CTR":return this.decryptAesCTR(t,r,Buffer.from(a));case"AES-GCM":return this.decryptAesGCM(t,r,Buffer.from(a));case"AES-KW":return this.decryptAesKW(t,r,Buffer.from(a));case"AES-ECB":return this.decryptAesECB(t,r,Buffer.from(a));default:throw new OperationError("algorithm: Is not recognized")}}static async encryptAesCBC(t,r,a){let n=eB().createCipheriv(`aes-${r.algorithm.length}-cbc`,r.data,new Uint8Array(t.iv)),o=n.update(a);o=Buffer.concat([o,n.final()]);let i=new Uint8Array(o).buffer;return i}static async decryptAesCBC(t,r,a){let n=eB().createDecipheriv(`aes-${r.algorithm.length}-cbc`,r.data,new Uint8Array(t.iv)),o=n.update(a);return o=Buffer.concat([o,n.final()]),new Uint8Array(o).buffer}static async encryptAesCTR(t,r,a){let n=eB().createCipheriv(`aes-${r.algorithm.length}-ctr`,r.data,Buffer.from(t.counter)),o=n.update(a);o=Buffer.concat([o,n.final()]);let i=new Uint8Array(o).buffer;return i}static async decryptAesCTR(t,r,a){let n=eB().createDecipheriv(`aes-${r.algorithm.length}-ctr`,r.data,new Uint8Array(t.counter)),o=n.update(a);return o=Buffer.concat([o,n.final()]),new Uint8Array(o).buffer}static async encryptAesGCM(t,r,a){let n=eB().createCipheriv(`aes-${r.algorithm.length}-gcm`,r.data,Buffer.from(t.iv),{authTagLength:(t.tagLength||128)>>3});t.additionalData&&n.setAAD(Buffer.from(t.additionalData));let o=n.update(a);o=Buffer.concat([o,n.final(),n.getAuthTag()]);let i=new Uint8Array(o).buffer;return i}static async decryptAesGCM(t,r,a){let n=eB().createDecipheriv(`aes-${r.algorithm.length}-gcm`,r.data,new Uint8Array(t.iv)),o=(t.tagLength||128)>>3,i=a.slice(0,a.length-o),s=a.slice(a.length-o);t.additionalData&&n.setAAD(Buffer.from(t.additionalData)),n.setAuthTag(s);let l=n.update(i);return l=Buffer.concat([l,n.final()]),new Uint8Array(l).buffer}static async encryptAesKW(t,r,a){let n=eB().createCipheriv(`id-aes${r.algorithm.length}-wrap`,r.data,this.AES_KW_IV),o=n.update(a);return o=Buffer.concat([o,n.final()]),new Uint8Array(o).buffer}static async decryptAesKW(t,r,a){let n=eB().createDecipheriv(`id-aes${r.algorithm.length}-wrap`,r.data,this.AES_KW_IV),o=n.update(a);return o=Buffer.concat([o,n.final()]),new Uint8Array(o).buffer}static async encryptAesECB(t,r,a){let n=eB().createCipheriv(`aes-${r.algorithm.length}-ecb`,r.data,new Uint8Array(0)),o=n.update(a);o=Buffer.concat([o,n.final()]);let i=new Uint8Array(o).buffer;return i}static async decryptAesECB(t,r,a){let n=eB().createDecipheriv(`aes-${r.algorithm.length}-ecb`,r.data,new Uint8Array(0)),o=n.update(a);return o=Buffer.concat([o,n.final()]),new Uint8Array(o).buffer}};AesCrypto.AES_KW_IV=Buffer.from("A6A6A6A6A6A6A6A6","hex");let AesCbcProvider=class AesCbcProvider extends webcrypto_core_es_AesCbcProvider{async onGenerateKey(t,r,a){let n=await AesCrypto.generateKey({name:this.name,length:t.length},r,a);return setCryptoKey(n)}async onEncrypt(t,r,a){return AesCrypto.encrypt(t,getCryptoKey(r),new Uint8Array(a))}async onDecrypt(t,r,a){return AesCrypto.decrypt(t,getCryptoKey(r),new Uint8Array(a))}async onExportKey(t,r){return AesCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await AesCrypto.importKey(t,r,{name:a.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof AesCryptoKey))throw TypeError("key: Is not a AesCryptoKey")}};let eT=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),eO=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,135]);function bitShiftLeft(t){let r=Buffer.alloc(t.length),a=t.length-1;for(let n=0;n<a;n++)r[n]=t[n]<<1,128&t[n+1]&&(r[n]+=1);return r[a]=t[a]<<1,r}function xor(t,r){let a=Math.min(t.length,r.length),n=Buffer.alloc(a);for(let o=0;o<a;o++)n[o]=t[o]^r[o];return n}function aes(t,r){let a=eR.createCipheriv(`aes${t.length<<3}`,t,eT),n=a.update(r);return a.final(),n}function getMessageBlock(t,r){let a=Buffer.alloc(16),n=16*r,o=n+16;return t.copy(a,0,n,o),a}function getPaddedMessageBlock(t,r){let a=Buffer.alloc(16),n=16*r,o=t.length;return a.fill(0),t.copy(a,0,n,o),a[o-n]=128,a}function generateSubkeys(t){let r=aes(t,eT),a=bitShiftLeft(r);128&r[0]&&(a=xor(a,eO));let n=bitShiftLeft(a);return 128&a[0]&&(n=xor(n,eO)),{subkey1:a,subkey2:n}}function aesCmac(t,r){let a,n;let o=generateSubkeys(t),i=Math.ceil(r.length/16);0===i?(i=1,a=!1):a=r.length%16==0;let s=i-1;n=a?xor(getMessageBlock(r,s),o.subkey1):xor(getPaddedMessageBlock(r,s),o.subkey2);let l=eT;for(let a=0;a<s;a++)l=aes(t,xor(l,getMessageBlock(r,a)));return aes(t,xor(n,l))}let AesCmacProvider=class AesCmacProvider extends webcrypto_core_es_AesCmacProvider{async onGenerateKey(t,r,a){let n=await AesCrypto.generateKey({name:this.name,length:t.length},r,a);return setCryptoKey(n)}async onSign(t,r,a){let n=aesCmac(getCryptoKey(r).data,Buffer.from(a));return new Uint8Array(n).buffer}async onVerify(t,r,a,n){let o=await this.sign(t,r,n);return 0===Buffer.from(a).compare(Buffer.from(o))}async onExportKey(t,r){return AesCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await AesCrypto.importKey(t,r,{name:a.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof AesCryptoKey))throw TypeError("key: Is not a AesCryptoKey")}};let AesCtrProvider=class AesCtrProvider extends webcrypto_core_es_AesCtrProvider{async onGenerateKey(t,r,a){let n=await AesCrypto.generateKey({name:this.name,length:t.length},r,a);return setCryptoKey(n)}async onEncrypt(t,r,a){return AesCrypto.encrypt(t,getCryptoKey(r),new Uint8Array(a))}async onDecrypt(t,r,a){return AesCrypto.decrypt(t,getCryptoKey(r),new Uint8Array(a))}async onExportKey(t,r){return AesCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await AesCrypto.importKey(t,r,{name:a.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof AesCryptoKey))throw TypeError("key: Is not a AesCryptoKey")}};let AesGcmProvider=class AesGcmProvider extends webcrypto_core_es_AesGcmProvider{async onGenerateKey(t,r,a){let n=await AesCrypto.generateKey({name:this.name,length:t.length},r,a);return setCryptoKey(n)}async onEncrypt(t,r,a){return AesCrypto.encrypt(t,getCryptoKey(r),new Uint8Array(a))}async onDecrypt(t,r,a){return AesCrypto.decrypt(t,getCryptoKey(r),new Uint8Array(a))}async onExportKey(t,r){return AesCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await AesCrypto.importKey(t,r,{name:a.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof AesCryptoKey))throw TypeError("key: Is not a AesCryptoKey")}};let AesKwProvider=class AesKwProvider extends webcrypto_core_es_AesKwProvider{async onGenerateKey(t,r,a){let n=await AesCrypto.generateKey({name:this.name,length:t.length},r,a);return setCryptoKey(n)}async onExportKey(t,r){return AesCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await AesCrypto.importKey(t,r,{name:a.name},n,o);return setCryptoKey(i)}async onEncrypt(t,r,a){return AesCrypto.encrypt(t,getCryptoKey(r),new Uint8Array(a))}async onDecrypt(t,r,a){return AesCrypto.decrypt(t,getCryptoKey(r),new Uint8Array(a))}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof AesCryptoKey))throw TypeError("key: Is not a AesCryptoKey")}};let AesEcbProvider=class AesEcbProvider extends webcrypto_core_es_AesEcbProvider{async onGenerateKey(t,r,a){let n=await AesCrypto.generateKey({name:this.name,length:t.length},r,a);return setCryptoKey(n)}async onEncrypt(t,r,a){return AesCrypto.encrypt(t,getCryptoKey(r),new Uint8Array(a))}async onDecrypt(t,r,a){return AesCrypto.decrypt(t,getCryptoKey(r),new Uint8Array(a))}async onExportKey(t,r){return AesCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await AesCrypto.importKey(t,r,{name:a.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof AesCryptoKey))throw TypeError("key: Is not a AesCryptoKey")}};let DesCryptoKey=class DesCryptoKey extends SymmetricKey{get alg(){switch(this.algorithm.name.toUpperCase()){case"DES-CBC":return"DES-CBC";case"DES-EDE3-CBC":return"3DES-CBC";default:throw new AlgorithmError("Unsupported algorithm name")}}set alg(t){}};(0,$.gn)([JsonProp({name:"k",converter:ex})],DesCryptoKey.prototype,"data",void 0);let DesCrypto=class DesCrypto{static async generateKey(t,r,a){let n=new DesCryptoKey;return n.algorithm=t,n.extractable=r,n.usages=a,n.data=eB().randomBytes(t.length>>3),n}static async exportKey(t,r){switch(t.toLowerCase()){case"jwk":return JsonSerializer.toJSON(r);case"raw":return new Uint8Array(r.data).buffer;default:throw new OperationError("format: Must be 'jwk' or 'raw'")}}static async importKey(t,r,a,n,o){let i;switch(t.toLowerCase()){case"jwk":i=JsonParser.fromJSON(r,{targetSchema:DesCryptoKey});break;case"raw":(i=new DesCryptoKey).data=Buffer.from(r);break;default:throw new OperationError("format: Must be 'jwk' or 'raw'")}return i.algorithm=a,i.extractable=n,i.usages=o,i}static async encrypt(t,r,a){switch(t.name.toUpperCase()){case"DES-CBC":return this.encryptDesCBC(t,r,Buffer.from(a));case"DES-EDE3-CBC":return this.encryptDesEDE3CBC(t,r,Buffer.from(a));default:throw new OperationError("algorithm: Is not recognized")}}static async decrypt(t,r,a){if(!(r instanceof DesCryptoKey))throw Error("key: Is not DesCryptoKey");switch(t.name.toUpperCase()){case"DES-CBC":return this.decryptDesCBC(t,r,Buffer.from(a));case"DES-EDE3-CBC":return this.decryptDesEDE3CBC(t,r,Buffer.from(a));default:throw new OperationError("algorithm: Is not recognized")}}static async encryptDesCBC(t,r,a){let n=eB().createCipheriv("des-cbc",r.data,new Uint8Array(t.iv)),o=n.update(a);o=Buffer.concat([o,n.final()]);let i=new Uint8Array(o).buffer;return i}static async decryptDesCBC(t,r,a){let n=eB().createDecipheriv("des-cbc",r.data,new Uint8Array(t.iv)),o=n.update(a);return o=Buffer.concat([o,n.final()]),new Uint8Array(o).buffer}static async encryptDesEDE3CBC(t,r,a){let n=eB().createCipheriv("des-ede3-cbc",r.data,Buffer.from(t.iv)),o=n.update(a);o=Buffer.concat([o,n.final()]);let i=new Uint8Array(o).buffer;return i}static async decryptDesEDE3CBC(t,r,a){let n=eB().createDecipheriv("des-ede3-cbc",r.data,new Uint8Array(t.iv)),o=n.update(a);return o=Buffer.concat([o,n.final()]),new Uint8Array(o).buffer}};let DesCbcProvider=class DesCbcProvider extends DesProvider{constructor(){super(...arguments),this.keySizeBits=64,this.ivSize=8,this.name="DES-CBC"}async onGenerateKey(t,r,a){let n=await DesCrypto.generateKey({name:this.name,length:this.keySizeBits},r,a);return setCryptoKey(n)}async onEncrypt(t,r,a){return DesCrypto.encrypt(t,getCryptoKey(r),new Uint8Array(a))}async onDecrypt(t,r,a){return DesCrypto.decrypt(t,getCryptoKey(r),new Uint8Array(a))}async onExportKey(t,r){return DesCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await DesCrypto.importKey(t,r,{name:this.name,length:this.keySizeBits},n,o);if(i.data.length!==this.keySizeBits>>3)throw new OperationError("keyData: Wrong key size");return setCryptoKey(i)}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof DesCryptoKey))throw TypeError("key: Is not a DesCryptoKey")}};let DesEde3CbcProvider=class DesEde3CbcProvider extends DesProvider{constructor(){super(...arguments),this.keySizeBits=192,this.ivSize=8,this.name="DES-EDE3-CBC"}async onGenerateKey(t,r,a){let n=await DesCrypto.generateKey({name:this.name,length:this.keySizeBits},r,a);return setCryptoKey(n)}async onEncrypt(t,r,a){return DesCrypto.encrypt(t,getCryptoKey(r),new Uint8Array(a))}async onDecrypt(t,r,a){return DesCrypto.decrypt(t,getCryptoKey(r),new Uint8Array(a))}async onExportKey(t,r){return DesCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await DesCrypto.importKey(t,r,{name:this.name,length:this.keySizeBits},n,o);if(i.data.length!==this.keySizeBits>>3)throw new OperationError("keyData: Wrong key size");return setCryptoKey(i)}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof DesCryptoKey))throw TypeError("key: Is not a DesCryptoKey")}};function getJwkAlgorithm(t){switch(t.name.toUpperCase()){case"RSA-OAEP":{let r=/(\d+)$/.exec(t.hash.name)[1];return`RSA-OAEP${"1"!==r?`-${r}`:""}`}case"RSASSA-PKCS1-V1_5":return`RS${/(\d+)$/.exec(t.hash.name)[1]}`;case"RSA-PSS":return`PS${/(\d+)$/.exec(t.hash.name)[1]}`;case"RSA-PKCS1":return"RS1";default:throw new OperationError("algorithm: Is not recognized")}}let webcrypto_es_RsaPrivateKey=class webcrypto_es_RsaPrivateKey extends AsymmetricKey{constructor(){super(...arguments),this.type="private"}getKey(){let t=AsnParser.parse(this.data,eE.PrivateKeyInfo);return AsnParser.parse(t.privateKey,eE.RsaPrivateKey)}toJSON(){let t=this.getKey(),r={kty:"RSA",alg:getJwkAlgorithm(this.algorithm),key_ops:this.usages,ext:this.extractable};return Object.assign(r,JsonSerializer.toJSON(t))}fromJSON(t){let r=JsonParser.fromJSON(t,{targetSchema:eE.RsaPrivateKey}),a=new eE.PrivateKeyInfo;a.privateKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",a.privateKeyAlgorithm.parameters=null,a.privateKey=AsnSerializer.serialize(r),this.data=Buffer.from(AsnSerializer.serialize(a))}};let webcrypto_es_RsaPublicKey=class webcrypto_es_RsaPublicKey extends AsymmetricKey{constructor(){super(...arguments),this.type="public"}getKey(){let t=AsnParser.parse(this.data,eE.PublicKeyInfo);return AsnParser.parse(t.publicKey,eE.RsaPublicKey)}toJSON(){let t=this.getKey(),r={kty:"RSA",alg:getJwkAlgorithm(this.algorithm),key_ops:this.usages,ext:this.extractable};return Object.assign(r,JsonSerializer.toJSON(t))}fromJSON(t){let r=JsonParser.fromJSON(t,{targetSchema:eE.RsaPublicKey}),a=new eE.PublicKeyInfo;a.publicKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",a.publicKeyAlgorithm.parameters=null,a.publicKey=AsnSerializer.serialize(r),this.data=Buffer.from(AsnSerializer.serialize(a))}};let RsaCrypto=class RsaCrypto{static async generateKey(t,r,a){let n=new webcrypto_es_RsaPrivateKey;n.algorithm=t,n.extractable=r,n.usages=a.filter(t=>-1!==this.privateKeyUsages.indexOf(t));let o=new webcrypto_es_RsaPublicKey;o.algorithm=t,o.extractable=!0,o.usages=a.filter(t=>-1!==this.publicKeyUsages.indexOf(t));let i=Buffer.concat([Buffer.alloc(4-t.publicExponent.byteLength,0),Buffer.from(t.publicExponent)]).readInt32BE(0),s=eB().generateKeyPairSync("rsa",{modulusLength:t.modulusLength,publicExponent:i,publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});return n.data=s.privateKey,o.data=s.publicKey,{privateKey:n,publicKey:o}}static async exportKey(t,r){switch(t.toLowerCase()){case"jwk":return JsonSerializer.toJSON(r);case"pkcs8":case"spki":return new Uint8Array(r.data).buffer;default:throw new OperationError("format: Must be 'jwk', 'pkcs8' or 'spki'")}}static async importKey(t,r,a,n,o){switch(t.toLowerCase()){case"jwk":if(r.d){let t=JsonParser.fromJSON(r,{targetSchema:eE.RsaPrivateKey});return this.importPrivateKey(t,a,n,o)}{let t=JsonParser.fromJSON(r,{targetSchema:eE.RsaPublicKey});return this.importPublicKey(t,a,n,o)}case"spki":{let t=AsnParser.parse(new Uint8Array(r),eE.PublicKeyInfo),i=AsnParser.parse(t.publicKey,eE.RsaPublicKey);return this.importPublicKey(i,a,n,o)}case"pkcs8":{let t=AsnParser.parse(new Uint8Array(r),eE.PrivateKeyInfo),i=AsnParser.parse(t.privateKey,eE.RsaPrivateKey);return this.importPrivateKey(i,a,n,o)}default:throw new OperationError("format: Must be 'jwk', 'pkcs8' or 'spki'")}}static async sign(t,r,a){switch(t.name.toUpperCase()){case"RSA-PSS":case"RSASSA-PKCS1-V1_5":return this.signRsa(t,r,a);default:throw new OperationError("algorithm: Is not recognized")}}static async verify(t,r,a,n){switch(t.name.toUpperCase()){case"RSA-PSS":case"RSASSA-PKCS1-V1_5":return this.verifySSA(t,r,n,a);default:throw new OperationError("algorithm: Is not recognized")}}static async encrypt(t,r,a){if("RSA-OAEP"===t.name.toUpperCase())return this.encryptOAEP(t,r,a);throw new OperationError("algorithm: Is not recognized")}static async decrypt(t,r,a){if("RSA-OAEP"===t.name.toUpperCase())return this.decryptOAEP(t,r,a);throw new OperationError("algorithm: Is not recognized")}static importPrivateKey(t,r,a,n){let o=new eE.PrivateKeyInfo;o.privateKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",o.privateKeyAlgorithm.parameters=null,o.privateKey=AsnSerializer.serialize(t);let i=new webcrypto_es_RsaPrivateKey;return i.data=Buffer.from(AsnSerializer.serialize(o)),i.algorithm=Object.assign({},r),i.algorithm.publicExponent=new Uint8Array(t.publicExponent),i.algorithm.modulusLength=t.modulus.byteLength<<3,i.extractable=a,i.usages=n,i}static importPublicKey(t,r,a,n){let o=new eE.PublicKeyInfo;o.publicKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",o.publicKeyAlgorithm.parameters=null,o.publicKey=AsnSerializer.serialize(t);let i=new webcrypto_es_RsaPublicKey;return i.data=Buffer.from(AsnSerializer.serialize(o)),i.algorithm=Object.assign({},r),i.algorithm.publicExponent=new Uint8Array(t.publicExponent),i.algorithm.modulusLength=t.modulus.byteLength<<3,i.extractable=a,i.usages=n,i}static getCryptoAlgorithm(t){switch(t.hash.name.toUpperCase()){case"SHA-1":return"RSA-SHA1";case"SHA-256":return"RSA-SHA256";case"SHA-384":return"RSA-SHA384";case"SHA-512":return"RSA-SHA512";case"SHA3-256":return"RSA-SHA3-256";case"SHA3-384":return"RSA-SHA3-384";case"SHA3-512":return"RSA-SHA3-512";default:throw new OperationError("algorithm.hash: Is not recognized")}}static signRsa(t,r,a){let n=this.getCryptoAlgorithm(r.algorithm),o=eB().createSign(n);o.update(Buffer.from(a)),r.pem||(r.pem=`-----BEGIN PRIVATE KEY-----
${r.data.toString("base64")}
-----END PRIVATE KEY-----`);let i={key:r.pem};"RSA-PSS"===t.name.toUpperCase()&&(i.padding=eB().constants.RSA_PKCS1_PSS_PADDING,i.saltLength=t.saltLength);let s=o.sign(i);return new Uint8Array(s).buffer}static verifySSA(t,r,a,n){let o=this.getCryptoAlgorithm(r.algorithm),i=eB().createVerify(o);i.update(Buffer.from(a)),r.pem||(r.pem=`-----BEGIN PUBLIC KEY-----
${r.data.toString("base64")}
-----END PUBLIC KEY-----`);let s={key:r.pem};"RSA-PSS"===t.name.toUpperCase()&&(s.padding=eB().constants.RSA_PKCS1_PSS_PADDING,s.saltLength=t.saltLength);let l=i.verify(s,n);return l}static encryptOAEP(t,r,a){let n={key:`-----BEGIN PUBLIC KEY-----
${r.data.toString("base64")}
-----END PUBLIC KEY-----`,padding:eB().constants.RSA_PKCS1_OAEP_PADDING};return t.label,new Uint8Array(eB().publicEncrypt(n,a)).buffer}static decryptOAEP(t,r,a){let n={key:`-----BEGIN PRIVATE KEY-----
${r.data.toString("base64")}
-----END PRIVATE KEY-----`,padding:eB().constants.RSA_PKCS1_OAEP_PADDING};return t.label,new Uint8Array(eB().privateDecrypt(n,a)).buffer}};RsaCrypto.publicKeyUsages=["verify","encrypt","wrapKey"],RsaCrypto.privateKeyUsages=["sign","decrypt","unwrapKey"];let RsaSsaProvider=class RsaSsaProvider extends webcrypto_core_es_RsaSsaProvider{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(t,r,a){let n=await RsaCrypto.generateKey({...t,name:this.name},r,a);return{privateKey:setCryptoKey(n.privateKey),publicKey:setCryptoKey(n.publicKey)}}async onSign(t,r,a){return RsaCrypto.sign(t,getCryptoKey(r),new Uint8Array(a))}async onVerify(t,r,a,n){return RsaCrypto.verify(t,getCryptoKey(r),new Uint8Array(a),new Uint8Array(n))}async onExportKey(t,r){return RsaCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await RsaCrypto.importKey(t,r,{...a,name:this.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){super.checkCryptoKey(t,r);let a=getCryptoKey(t);if(!(a instanceof webcrypto_es_RsaPrivateKey||a instanceof webcrypto_es_RsaPublicKey))throw TypeError("key: Is not RSA CryptoKey")}};let RsaPssProvider=class RsaPssProvider extends webcrypto_core_es_RsaPssProvider{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(t,r,a){let n=await RsaCrypto.generateKey({...t,name:this.name},r,a);return{privateKey:setCryptoKey(n.privateKey),publicKey:setCryptoKey(n.publicKey)}}async onSign(t,r,a){return RsaCrypto.sign(t,getCryptoKey(r),new Uint8Array(a))}async onVerify(t,r,a,n){return RsaCrypto.verify(t,getCryptoKey(r),new Uint8Array(a),new Uint8Array(n))}async onExportKey(t,r){return RsaCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await RsaCrypto.importKey(t,r,{...a,name:this.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){super.checkCryptoKey(t,r);let a=getCryptoKey(t);if(!(a instanceof webcrypto_es_RsaPrivateKey||a instanceof webcrypto_es_RsaPublicKey))throw TypeError("key: Is not RSA CryptoKey")}};let ShaCrypto=class ShaCrypto{static size(t){switch(t.name.toUpperCase()){case"SHA-1":return 160;case"SHA-256":case"SHA3-256":return 256;case"SHA-384":case"SHA3-384":return 384;case"SHA-512":case"SHA3-512":return 512;default:throw Error("Unrecognized name")}}static getAlgorithmName(t){switch(t.name.toUpperCase()){case"SHA-1":return"sha1";case"SHA-256":return"sha256";case"SHA-384":return"sha384";case"SHA-512":return"sha512";case"SHA3-256":return"sha3-256";case"SHA3-384":return"sha3-384";case"SHA3-512":return"sha3-512";default:throw Error("Unrecognized name")}}static digest(t,r){let a=this.getAlgorithmName(t),n=eB().createHash(a).update(Buffer.from(r)).digest();return new Uint8Array(n).buffer}};let RsaOaepProvider=class RsaOaepProvider extends webcrypto_core_es_RsaOaepProvider{async onGenerateKey(t,r,a){let n=await RsaCrypto.generateKey({...t,name:this.name},r,a);return{privateKey:setCryptoKey(n.privateKey),publicKey:setCryptoKey(n.publicKey)}}async onEncrypt(t,r,a){let n=getCryptoKey(r),o=new Uint8Array(a),i=Math.ceil(n.algorithm.modulusLength>>3),s=ShaCrypto.size(n.algorithm.hash)>>3,l=o.byteLength,u=i-l-2*s-2;if(l>i-2*s-2)throw Error("Data too large");let c=new Uint8Array(i),d=c.subarray(1,s+1),h=c.subarray(s+1);h.set(o,s+u+1);let p=eB().createHash(n.algorithm.hash.name.replace("-","")).update(index_es_BufferSourceConverter.toUint8Array(t.label||new Uint8Array(0))).digest();h.set(p,0),h[s+u]=1,eB().randomFillSync(d);let m=this.mgf1(n.algorithm.hash,d,h.length);for(let t=0;t<h.length;t++)h[t]^=m[t];let y=this.mgf1(n.algorithm.hash,h,d.length);for(let t=0;t<d.length;t++)d[t]^=y[t];n.pem||(n.pem=`-----BEGIN PUBLIC KEY-----
${n.data.toString("base64")}
-----END PUBLIC KEY-----`);let g=eB().publicEncrypt({key:n.pem,padding:eB().constants.RSA_NO_PADDING},Buffer.from(c));return new Uint8Array(g).buffer}async onDecrypt(t,r,a){let n=getCryptoKey(r),o=Math.ceil(n.algorithm.modulusLength>>3),i=ShaCrypto.size(n.algorithm.hash)>>3,s=a.byteLength;if(s!==o)throw Error("Bad data");n.pem||(n.pem=`-----BEGIN PRIVATE KEY-----
${n.data.toString("base64")}
-----END PRIVATE KEY-----`);let l=eB().privateDecrypt({key:n.pem,padding:eB().constants.RSA_NO_PADDING},Buffer.from(a)),u=l[0],c=l.subarray(1,i+1),d=l.subarray(i+1);if(0!==u)throw Error("Decryption failed");let h=this.mgf1(n.algorithm.hash,d,c.length);for(let t=0;t<c.length;t++)c[t]^=h[t];let p=this.mgf1(n.algorithm.hash,c,d.length);for(let t=0;t<d.length;t++)d[t]^=p[t];let m=eB().createHash(n.algorithm.hash.name.replace("-","")).update(index_es_BufferSourceConverter.toUint8Array(t.label||new Uint8Array(0))).digest();for(let t=0;t<i;t++)if(m[t]!==d[t])throw Error("Decryption failed");let y=i;for(;y<d.length;y++){let t=d[y];if(1===t)break;if(0!==t)throw Error("Decryption failed")}if(y===d.length)throw Error("Decryption failed");return l=d.subarray(y+1),new Uint8Array(l).buffer}async onExportKey(t,r){return RsaCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await RsaCrypto.importKey(t,r,{...a,name:this.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){super.checkCryptoKey(t,r);let a=getCryptoKey(t);if(!(a instanceof webcrypto_es_RsaPrivateKey||a instanceof webcrypto_es_RsaPublicKey))throw TypeError("key: Is not RSA CryptoKey")}mgf1(t,r,a=0){let n=ShaCrypto.size(t)>>3,o=new Uint8Array(a),i=new Uint8Array(4),s=Math.ceil(a/n);for(let a=0;a<s;a++){i[0]=a>>>24,i[1]=a>>>16&255,i[2]=a>>>8&255,i[3]=255&a;let s=o.subarray(a*n),l=eB().createHash(t.name.replace("-","")).update(r).update(i).digest();l.length>s.length&&(l=l.subarray(0,s.length)),s.set(l)}return o}};let RsaEsProvider=class RsaEsProvider extends ProviderCrypto{constructor(){super(...arguments),this.name="RSAES-PKCS1-v1_5",this.usages={publicKey:["encrypt","wrapKey"],privateKey:["decrypt","unwrapKey"]}}async onGenerateKey(t,r,a){let n=await RsaCrypto.generateKey({...t,name:this.name},r,a);return{privateKey:setCryptoKey(n.privateKey),publicKey:setCryptoKey(n.publicKey)}}checkGenerateKeyParams(t){if(this.checkRequiredProperty(t,"publicExponent"),!(t.publicExponent&&t.publicExponent instanceof Uint8Array))throw TypeError("publicExponent: Missing or not a Uint8Array");let r=index_es_Convert.ToBase64(t.publicExponent);if(!("Aw=="===r||"AQAB"===r))throw TypeError("publicExponent: Must be [3] or [1,0,1]");switch(this.checkRequiredProperty(t,"modulusLength"),t.modulusLength){case 1024:case 2048:case 4096:break;default:throw TypeError("modulusLength: Must be 1024, 2048, or 4096")}}async onEncrypt(t,r,a){let n=this.toCryptoOptions(r),o=eR.publicEncrypt(n,new Uint8Array(a));return new Uint8Array(o).buffer}async onDecrypt(t,r,a){let n=this.toCryptoOptions(r),o=eR.privateDecrypt(n,new Uint8Array(a));return new Uint8Array(o).buffer}async onExportKey(t,r){return RsaCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await RsaCrypto.importKey(t,r,{...a,name:this.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){super.checkCryptoKey(t,r);let a=getCryptoKey(t);if(!(a instanceof webcrypto_es_RsaPrivateKey||a instanceof webcrypto_es_RsaPublicKey))throw TypeError("key: Is not RSA CryptoKey")}toCryptoOptions(t){let r=t.type.toUpperCase();return{key:`-----BEGIN ${r} KEY-----
${getCryptoKey(t).data.toString("base64")}
-----END ${r} KEY-----`,padding:eR.constants.RSA_PKCS1_PADDING}}};let eK={"1.2.840.10045.3.1.7":"P-256","P-256":"1.2.840.10045.3.1.7","1.3.132.0.34":"P-384","P-384":"1.3.132.0.34","1.3.132.0.35":"P-521","P-521":"1.3.132.0.35","1.3.132.0.10":"K-256","K-256":"1.3.132.0.10",brainpoolP160r1:"1.3.36.3.3.2.8.1.1.1","1.3.36.3.3.2.8.1.1.1":"brainpoolP160r1",brainpoolP160t1:"1.3.36.3.3.2.8.1.1.2","1.3.36.3.3.2.8.1.1.2":"brainpoolP160t1",brainpoolP192r1:"1.3.36.3.3.2.8.1.1.3","1.3.36.3.3.2.8.1.1.3":"brainpoolP192r1",brainpoolP192t1:"1.3.36.3.3.2.8.1.1.4","1.3.36.3.3.2.8.1.1.4":"brainpoolP192t1",brainpoolP224r1:"1.3.36.3.3.2.8.1.1.5","1.3.36.3.3.2.8.1.1.5":"brainpoolP224r1",brainpoolP224t1:"1.3.36.3.3.2.8.1.1.6","1.3.36.3.3.2.8.1.1.6":"brainpoolP224t1",brainpoolP256r1:"1.3.36.3.3.2.8.1.1.7","1.3.36.3.3.2.8.1.1.7":"brainpoolP256r1",brainpoolP256t1:"1.3.36.3.3.2.8.1.1.8","1.3.36.3.3.2.8.1.1.8":"brainpoolP256t1",brainpoolP320r1:"1.3.36.3.3.2.8.1.1.9","1.3.36.3.3.2.8.1.1.9":"brainpoolP320r1",brainpoolP320t1:"1.3.36.3.3.2.8.1.1.10","1.3.36.3.3.2.8.1.1.10":"brainpoolP320t1",brainpoolP384r1:"1.3.36.3.3.2.8.1.1.11","1.3.36.3.3.2.8.1.1.11":"brainpoolP384r1",brainpoolP384t1:"1.3.36.3.3.2.8.1.1.12","1.3.36.3.3.2.8.1.1.12":"brainpoolP384t1",brainpoolP512r1:"1.3.36.3.3.2.8.1.1.13","1.3.36.3.3.2.8.1.1.13":"brainpoolP512r1",brainpoolP512t1:"1.3.36.3.3.2.8.1.1.14","1.3.36.3.3.2.8.1.1.14":"brainpoolP512t1"};function getOidByNamedCurve$1(t){let r=eK[t];if(!r)throw new OperationError(`Cannot convert WebCrypto named curve '${t}' to OID`);return r}let webcrypto_es_EcPrivateKey=class webcrypto_es_EcPrivateKey extends AsymmetricKey{constructor(){super(...arguments),this.type="private"}getKey(){let t=AsnParser.parse(this.data,eE.PrivateKeyInfo);return AsnParser.parse(t.privateKey,eE.EcPrivateKey)}toJSON(){let t=this.getKey(),r={kty:"EC",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(r,JsonSerializer.toJSON(t))}fromJSON(t){if(!t.crv)throw new OperationError("Cannot get named curve from JWK. Property 'crv' is required");let r=new eE.PrivateKeyInfo;r.privateKeyAlgorithm.algorithm="1.2.840.10045.2.1",r.privateKeyAlgorithm.parameters=AsnSerializer.serialize(new eE.ObjectIdentifier(getOidByNamedCurve$1(t.crv)));let a=JsonParser.fromJSON(t,{targetSchema:eE.EcPrivateKey});return r.privateKey=AsnSerializer.serialize(a),this.data=Buffer.from(AsnSerializer.serialize(r)),this}};let webcrypto_es_EcPublicKey=class webcrypto_es_EcPublicKey extends AsymmetricKey{constructor(){super(...arguments),this.type="public"}getKey(){let t=AsnParser.parse(this.data,eE.PublicKeyInfo);return new eE.EcPublicKey(t.publicKey)}toJSON(){let t=this.getKey(),r={kty:"EC",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(r,JsonSerializer.toJSON(t))}fromJSON(t){if(!t.crv)throw new OperationError("Cannot get named curve from JWK. Property 'crv' is required");let r=JsonParser.fromJSON(t,{targetSchema:eE.EcPublicKey}),a=new eE.PublicKeyInfo;return a.publicKeyAlgorithm.algorithm="1.2.840.10045.2.1",a.publicKeyAlgorithm.parameters=AsnSerializer.serialize(new eE.ObjectIdentifier(getOidByNamedCurve$1(t.crv))),a.publicKey=AsnSerializer.toASN(r).valueHex,this.data=Buffer.from(AsnSerializer.serialize(a)),this}};let Sha1Provider=class Sha1Provider extends ProviderCrypto{constructor(){super(...arguments),this.name="SHA-1",this.usages=[]}async onDigest(t,r){return ShaCrypto.digest(t,r)}};let Sha256Provider=class Sha256Provider extends ProviderCrypto{constructor(){super(...arguments),this.name="SHA-256",this.usages=[]}async onDigest(t,r){return ShaCrypto.digest(t,r)}};let Sha384Provider=class Sha384Provider extends ProviderCrypto{constructor(){super(...arguments),this.name="SHA-384",this.usages=[]}async onDigest(t,r){return ShaCrypto.digest(t,r)}};let Sha512Provider=class Sha512Provider extends ProviderCrypto{constructor(){super(...arguments),this.name="SHA-512",this.usages=[]}async onDigest(t,r){return ShaCrypto.digest(t,r)}};let Sha3256Provider=class Sha3256Provider extends ProviderCrypto{constructor(){super(...arguments),this.name="SHA3-256",this.usages=[]}async onDigest(t,r){return ShaCrypto.digest(t,r)}};let Sha3384Provider=class Sha3384Provider extends ProviderCrypto{constructor(){super(...arguments),this.name="SHA3-384",this.usages=[]}async onDigest(t,r){return ShaCrypto.digest(t,r)}};let Sha3512Provider=class Sha3512Provider extends ProviderCrypto{constructor(){super(...arguments),this.name="SHA3-512",this.usages=[]}async onDigest(t,r){return ShaCrypto.digest(t,r)}};let EcCrypto=class EcCrypto{static async generateKey(t,r,a){let n=new webcrypto_es_EcPrivateKey;n.algorithm=t,n.extractable=r,n.usages=a.filter(t=>-1!==this.privateKeyUsages.indexOf(t));let o=new webcrypto_es_EcPublicKey;o.algorithm=t,o.extractable=!0,o.usages=a.filter(t=>-1!==this.publicKeyUsages.indexOf(t));let i=eB().generateKeyPairSync("ec",{namedCurve:this.getOpenSSLNamedCurve(t.namedCurve),publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});return n.data=i.privateKey,o.data=i.publicKey,{privateKey:n,publicKey:o}}static async sign(t,r,a){let n=ShaCrypto.getAlgorithmName(t.hash),o=eB().createSign(n);o.update(Buffer.from(a)),r.pem||(r.pem=`-----BEGIN PRIVATE KEY-----
${r.data.toString("base64")}
-----END PRIVATE KEY-----`);let i={key:r.pem},s=o.sign(i),l=AsnParser.parse(s,eE.EcDsaSignature),u=EcUtils.encodeSignature(l,EcCurves.get(r.algorithm.namedCurve).size);return u.buffer}static async verify(t,r,a,n){let o=ShaCrypto.getAlgorithmName(t.hash),i=eB().createVerify(o);i.update(Buffer.from(n)),r.pem||(r.pem=`-----BEGIN PUBLIC KEY-----
${r.data.toString("base64")}
-----END PUBLIC KEY-----`);let s={key:r.pem},l=new eE.EcDsaSignature,u=EcCurves.get(r.algorithm.namedCurve),c=EcUtils.decodeSignature(a,u.size);l.r=index_es_BufferSourceConverter.toArrayBuffer(c.r),l.s=index_es_BufferSourceConverter.toArrayBuffer(c.s);let d=Buffer.from(AsnSerializer.serialize(l)),h=i.verify(s,d);return h}static async deriveBits(t,r,a){let n=this.getOpenSSLNamedCurve(r.algorithm.namedCurve),o=eB().createECDH(n),i=AsnParser.parse(r.data,eE.PrivateKeyInfo),s=AsnParser.parse(i.privateKey,eE.EcPrivateKey);o.setPrivateKey(Buffer.from(s.privateKey));let l=AsnParser.parse(t.public.data,eE.PublicKeyInfo),u=o.computeSecret(Buffer.from(l.publicKey));return null===a?u:new Uint8Array(u).buffer.slice(0,a>>3)}static async exportKey(t,r){switch(t.toLowerCase()){case"jwk":return JsonSerializer.toJSON(r);case"pkcs8":case"spki":return new Uint8Array(r.data).buffer;case"raw":{let t=AsnParser.parse(r.data,eE.PublicKeyInfo);return t.publicKey}default:throw new OperationError("format: Must be 'jwk', 'raw', pkcs8' or 'spki'")}}static async importKey(t,r,a,n,o){switch(t.toLowerCase()){case"jwk":if(r.d){let t=JsonParser.fromJSON(r,{targetSchema:eE.EcPrivateKey});return this.importPrivateKey(t,a,n,o)}{let t=JsonParser.fromJSON(r,{targetSchema:eE.EcPublicKey});return this.importPublicKey(t,a,n,o)}case"raw":{let t=new eE.EcPublicKey(r);return this.importPublicKey(t,a,n,o)}case"spki":{let t=AsnParser.parse(new Uint8Array(r),eE.PublicKeyInfo),i=new eE.EcPublicKey(t.publicKey);return this.assertKeyParameters(t.publicKeyAlgorithm.parameters,a.namedCurve),this.importPublicKey(i,a,n,o)}case"pkcs8":{let t=AsnParser.parse(new Uint8Array(r),eE.PrivateKeyInfo),i=AsnParser.parse(t.privateKey,eE.EcPrivateKey);return this.assertKeyParameters(t.privateKeyAlgorithm.parameters,a.namedCurve),this.importPrivateKey(i,a,n,o)}default:throw new OperationError("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'")}}static assertKeyParameters(t,r){if(!t)throw new CryptoError("Key info doesn't have required parameters");let a="";try{a=AsnParser.parse(t,eE.ObjectIdentifier).value}catch(t){throw new CryptoError("Cannot read key info parameters")}if(getOidByNamedCurve$1(r)!==a)throw new CryptoError("Key info parameter doesn't match to named curve")}static async importPrivateKey(t,r,a,n){let o=new eE.PrivateKeyInfo;o.privateKeyAlgorithm.algorithm="1.2.840.10045.2.1",o.privateKeyAlgorithm.parameters=AsnSerializer.serialize(new eE.ObjectIdentifier(getOidByNamedCurve$1(r.namedCurve))),o.privateKey=AsnSerializer.serialize(t);let i=new webcrypto_es_EcPrivateKey;return i.data=Buffer.from(AsnSerializer.serialize(o)),i.algorithm=Object.assign({},r),i.extractable=a,i.usages=n,i}static async importPublicKey(t,r,a,n){let o=new eE.PublicKeyInfo;o.publicKeyAlgorithm.algorithm="1.2.840.10045.2.1";let i=getOidByNamedCurve$1(r.namedCurve);o.publicKeyAlgorithm.parameters=AsnSerializer.serialize(new eE.ObjectIdentifier(i)),o.publicKey=t.value;let s=new webcrypto_es_EcPublicKey;return s.data=Buffer.from(AsnSerializer.serialize(o)),s.algorithm=Object.assign({},r),s.extractable=a,s.usages=n,s}static getOpenSSLNamedCurve(t){switch(t.toUpperCase()){case"P-256":return"prime256v1";case"K-256":return"secp256k1";case"P-384":return"secp384r1";case"P-521":return"secp521r1";default:return t}}};EcCrypto.publicKeyUsages=["verify"],EcCrypto.privateKeyUsages=["sign","deriveKey","deriveBits"];let EcdsaProvider=class EcdsaProvider extends webcrypto_core_es_EcdsaProvider{constructor(){super(...arguments),this.namedCurves=EcCurves.names,this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(t,r,a){let n=await EcCrypto.generateKey({...t,name:this.name},r,a);return{privateKey:setCryptoKey(n.privateKey),publicKey:setCryptoKey(n.publicKey)}}async onSign(t,r,a){return EcCrypto.sign(t,getCryptoKey(r),new Uint8Array(a))}async onVerify(t,r,a,n){return EcCrypto.verify(t,getCryptoKey(r),new Uint8Array(a),new Uint8Array(n))}async onExportKey(t,r){return EcCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await EcCrypto.importKey(t,r,{...a,name:this.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){super.checkCryptoKey(t,r);let a=getCryptoKey(t);if(!(a instanceof webcrypto_es_EcPrivateKey||a instanceof webcrypto_es_EcPublicKey))throw TypeError("key: Is not EC CryptoKey")}};let EcdhProvider=class EcdhProvider extends webcrypto_core_es_EcdhProvider{constructor(){super(...arguments),this.namedCurves=EcCurves.names}async onGenerateKey(t,r,a){let n=await EcCrypto.generateKey({...t,name:this.name},r,a);return{privateKey:setCryptoKey(n.privateKey),publicKey:setCryptoKey(n.publicKey)}}async onExportKey(t,r){return EcCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await EcCrypto.importKey(t,r,{...a,name:this.name},n,o);return setCryptoKey(i)}checkCryptoKey(t,r){super.checkCryptoKey(t,r);let a=getCryptoKey(t);if(!(a instanceof webcrypto_es_EcPrivateKey||a instanceof webcrypto_es_EcPublicKey))throw TypeError("key: Is not EC CryptoKey")}async onDeriveBits(t,r,a){let n=await EcCrypto.deriveBits({...t,public:getCryptoKey(t.public)},getCryptoKey(r),a);return n}};let eU={[eE.idEd448]:"Ed448",ed448:eE.idEd448,[eE.idX448]:"X448",x448:eE.idX448,[eE.idEd25519]:"Ed25519",ed25519:eE.idEd25519,[eE.idX25519]:"X25519",x25519:eE.idX25519};function getOidByNamedCurve(t){let r=eU[t.toLowerCase()];if(!r)throw new OperationError(`Cannot convert WebCrypto named curve '${t}' to OID`);return r}let webcrypto_es_EdPrivateKey=class webcrypto_es_EdPrivateKey extends AsymmetricKey{constructor(){super(...arguments),this.type="private"}getKey(){let t=AsnParser.parse(this.data,eE.PrivateKeyInfo);return AsnParser.parse(t.privateKey,eE.CurvePrivateKey)}toJSON(){let t=this.getKey(),r={kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(r,JsonSerializer.toJSON(t))}fromJSON(t){if(!t.crv)throw new OperationError("Cannot get named curve from JWK. Property 'crv' is required");let r=new eE.PrivateKeyInfo;r.privateKeyAlgorithm.algorithm=getOidByNamedCurve(t.crv);let a=JsonParser.fromJSON(t,{targetSchema:eE.CurvePrivateKey});return r.privateKey=AsnSerializer.serialize(a),this.data=Buffer.from(AsnSerializer.serialize(r)),this}};let webcrypto_es_EdPublicKey=class webcrypto_es_EdPublicKey extends AsymmetricKey{constructor(){super(...arguments),this.type="public"}getKey(){let t=AsnParser.parse(this.data,eE.PublicKeyInfo);return t.publicKey}toJSON(){let t=this.getKey(),r={kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(r,{x:index_es_Convert.ToBase64Url(t)})}fromJSON(t){if(!t.crv)throw new OperationError("Cannot get named curve from JWK. Property 'crv' is required");if(!t.x)throw new OperationError("Cannot get property from JWK. Property 'x' is required");let r=new eE.PublicKeyInfo;return r.publicKeyAlgorithm.algorithm=getOidByNamedCurve(t.crv),r.publicKey=index_es_Convert.FromBase64Url(t.x),this.data=Buffer.from(AsnSerializer.serialize(r)),this}};let EdCrypto=class EdCrypto{static async generateKey(t,r,a){let n=new webcrypto_es_EdPrivateKey;n.algorithm=t,n.extractable=r,n.usages=a.filter(t=>-1!==this.privateKeyUsages.indexOf(t));let o=new webcrypto_es_EdPublicKey;o.algorithm=t,o.extractable=!0,o.usages=a.filter(t=>-1!==this.publicKeyUsages.indexOf(t));let i=t.namedCurve.toLowerCase(),s=eB().generateKeyPairSync(i,{publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});return n.data=s.privateKey,o.data=s.publicKey,{privateKey:n,publicKey:o}}static async sign(t,r,a){r.pem||(r.pem=`-----BEGIN PRIVATE KEY-----
${r.data.toString("base64")}
-----END PRIVATE KEY-----`);let n={key:r.pem},o=eB().sign(null,Buffer.from(a),n);return index_es_BufferSourceConverter.toArrayBuffer(o)}static async verify(t,r,a,n){r.pem||(r.pem=`-----BEGIN PUBLIC KEY-----
${r.data.toString("base64")}
-----END PUBLIC KEY-----`);let o={key:r.pem},i=eB().verify(null,Buffer.from(n),o,Buffer.from(a));return i}static async deriveBits(t,r,a){let n=eB().createPublicKey({key:t.public.data,format:"der",type:"spki"}),o=eB().createPrivateKey({key:r.data,format:"der",type:"pkcs8"}),i=eB().diffieHellman({publicKey:n,privateKey:o});return new Uint8Array(i).buffer.slice(0,a>>3)}static async exportKey(t,r){switch(t.toLowerCase()){case"jwk":return JsonSerializer.toJSON(r);case"pkcs8":case"spki":return new Uint8Array(r.data).buffer;case"raw":{let t=AsnParser.parse(r.data,eE.PublicKeyInfo);return t.publicKey}default:throw new OperationError("format: Must be 'jwk', 'raw', pkcs8' or 'spki'")}}static async importKey(t,r,a,n,o){switch(t.toLowerCase()){case"jwk":if(r.d){let t=JsonParser.fromJSON(r,{targetSchema:eE.CurvePrivateKey});return this.importPrivateKey(t,a,n,o)}if(!r.x)throw TypeError("keyData: Cannot get required 'x' filed");return this.importPublicKey(index_es_Convert.FromBase64Url(r.x),a,n,o);case"raw":return this.importPublicKey(r,a,n,o);case"spki":{let t=AsnParser.parse(new Uint8Array(r),eE.PublicKeyInfo);return this.importPublicKey(t.publicKey,a,n,o)}case"pkcs8":{let t=AsnParser.parse(new Uint8Array(r),eE.PrivateKeyInfo),i=AsnParser.parse(t.privateKey,eE.CurvePrivateKey);return this.importPrivateKey(i,a,n,o)}default:throw new OperationError("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'")}}static importPrivateKey(t,r,a,n){let o=new webcrypto_es_EdPrivateKey;return o.fromJSON({crv:r.namedCurve,d:index_es_Convert.ToBase64Url(t.d)}),o.algorithm=Object.assign({},r),o.extractable=a,o.usages=n,o}static async importPublicKey(t,r,a,n){let o=new webcrypto_es_EdPublicKey;return o.fromJSON({crv:r.namedCurve,x:index_es_Convert.ToBase64Url(t)}),o.algorithm=Object.assign({},r),o.extractable=a,o.usages=n,o}};EdCrypto.publicKeyUsages=["verify"],EdCrypto.privateKeyUsages=["sign","deriveKey","deriveBits"];let EdDsaProvider=class EdDsaProvider extends webcrypto_core_es_EdDsaProvider{async onGenerateKey(t,r,a){let n=await EdCrypto.generateKey({name:this.name,namedCurve:t.namedCurve.replace(/^ed/i,"Ed")},r,a);return{privateKey:setCryptoKey(n.privateKey),publicKey:setCryptoKey(n.publicKey)}}async onSign(t,r,a){return EdCrypto.sign(t,getCryptoKey(r),new Uint8Array(a))}async onVerify(t,r,a,n){return EdCrypto.verify(t,getCryptoKey(r),new Uint8Array(a),new Uint8Array(n))}async onExportKey(t,r){return EdCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await EdCrypto.importKey(t,r,{...a,name:this.name},n,o);return setCryptoKey(i)}};let EcdhEsProvider=class EcdhEsProvider extends webcrypto_core_es_EcdhEsProvider{async onGenerateKey(t,r,a){let n=await EdCrypto.generateKey({name:this.name,namedCurve:t.namedCurve.toUpperCase()},r,a);return{privateKey:setCryptoKey(n.privateKey),publicKey:setCryptoKey(n.publicKey)}}async onDeriveBits(t,r,a){let n=await EdCrypto.deriveBits({...t,public:getCryptoKey(t.public)},getCryptoKey(r),a);return n}async onExportKey(t,r){return EdCrypto.exportKey(t,getCryptoKey(r))}async onImportKey(t,r,a,n,o){let i=await EdCrypto.importKey(t,r,{...a,name:this.name},n,o);return setCryptoKey(i)}};let PbkdfCryptoKey=class PbkdfCryptoKey extends CryptoKey{};let Pbkdf2Provider=class Pbkdf2Provider extends webcrypto_core_es_Pbkdf2Provider{async onDeriveBits(t,r,a){return new Promise((n,o)=>{let i=index_es_BufferSourceConverter.toArrayBuffer(t.salt),s=t.hash.name.replace("-","");eB().pbkdf2(getCryptoKey(r).data,Buffer.from(i),t.iterations,a>>3,s,(t,r)=>{t?o(t):n(new Uint8Array(r).buffer)})})}async onImportKey(t,r,a,n,o){if("raw"===t){let t=new PbkdfCryptoKey;return t.data=Buffer.from(r),t.algorithm={name:this.name},t.extractable=!1,t.usages=o,setCryptoKey(t)}throw new OperationError("format: Must be 'raw'")}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof PbkdfCryptoKey))throw TypeError("key: Is not PBKDF CryptoKey")}};let HmacCryptoKey=class HmacCryptoKey extends CryptoKey{get alg(){let t=this.algorithm.hash.name.toUpperCase();return`HS${t.replace("SHA-","")}`}set alg(t){}};(0,$.gn)([JsonProp({name:"k",converter:ex})],HmacCryptoKey.prototype,"data",void 0);let HmacProvider=class HmacProvider extends webcrypto_core_es_HmacProvider{async onGenerateKey(t,r,a){let n=(t.length||this.getDefaultLength(t.hash.name))>>3<<3,o=new HmacCryptoKey;return o.algorithm={...t,length:n,name:this.name},o.extractable=r,o.usages=a,o.data=eB().randomBytes(n>>3),setCryptoKey(o)}async onSign(t,r,a){let n=ShaCrypto.getAlgorithmName(r.algorithm.hash),o=eB().createHmac(n,getCryptoKey(r).data).update(Buffer.from(a)).digest();return new Uint8Array(o).buffer}async onVerify(t,r,a,n){let o=ShaCrypto.getAlgorithmName(r.algorithm.hash),i=eB().createHmac(o,getCryptoKey(r).data).update(Buffer.from(n)).digest();return 0===i.compare(Buffer.from(a))}async onImportKey(t,r,a,n,o){let i;switch(t.toLowerCase()){case"jwk":i=JsonParser.fromJSON(r,{targetSchema:HmacCryptoKey});break;case"raw":(i=new HmacCryptoKey).data=Buffer.from(r);break;default:throw new OperationError("format: Must be 'jwk' or 'raw'")}return i.algorithm={hash:{name:a.hash.name},name:this.name,length:i.data.length<<3},i.extractable=n,i.usages=o,setCryptoKey(i)}async onExportKey(t,r){switch(t.toLowerCase()){case"jwk":return JsonSerializer.toJSON(getCryptoKey(r));case"raw":return new Uint8Array(getCryptoKey(r).data).buffer;default:throw new OperationError("format: Must be 'jwk' or 'raw'")}}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof HmacCryptoKey))throw TypeError("key: Is not HMAC CryptoKey")}};let HkdfCryptoKey=class HkdfCryptoKey extends CryptoKey{};let HkdfProvider=class HkdfProvider extends webcrypto_core_es_HkdfProvider{async onImportKey(t,r,a,n,o){if("raw"!==t.toLowerCase())throw new OperationError("Operation not supported");let i=new HkdfCryptoKey;return i.data=Buffer.from(r),i.algorithm={name:this.name},i.extractable=n,i.usages=o,setCryptoKey(i)}async onDeriveBits(t,r,a){let n=t.hash.name.replace("-",""),o=eB().createHash(n).digest().length,i=a/8,s=index_es_BufferSourceConverter.toUint8Array(t.info),l=eB().createHmac(n,index_es_BufferSourceConverter.toUint8Array(t.salt)).update(index_es_BufferSourceConverter.toUint8Array(getCryptoKey(r).data)).digest(),u=[Buffer.alloc(0)],c=Math.ceil(i/o)+1;for(let t=1;t<c;++t)u.push(eB().createHmac(n,l).update(Buffer.concat([u[t-1],s,Buffer.from([t])])).digest());return Buffer.concat(u).slice(0,i)}checkCryptoKey(t,r){if(super.checkCryptoKey(t,r),!(getCryptoKey(t) instanceof HkdfCryptoKey))throw TypeError("key: Is not HKDF CryptoKey")}};let ShakeCrypto=class ShakeCrypto{static digest(t,r){let a=eB().createHash(t.name.toLowerCase(),{outputLength:t.length}).update(Buffer.from(r)).digest();return new Uint8Array(a).buffer}};let Shake128Provider=class Shake128Provider extends webcrypto_core_es_Shake128Provider{async onDigest(t,r){return ShakeCrypto.digest(t,r)}};let Shake256Provider=class Shake256Provider extends webcrypto_core_es_Shake256Provider{async onDigest(t,r){return ShakeCrypto.digest(t,r)}};let SubtleCrypto=class SubtleCrypto extends webcrypto_core_es_SubtleCrypto{constructor(){var t;super(),this.providers.set(new AesCbcProvider),this.providers.set(new AesCtrProvider),this.providers.set(new AesGcmProvider),this.providers.set(new AesCmacProvider),this.providers.set(new AesKwProvider),this.providers.set(new AesEcbProvider),this.providers.set(new DesCbcProvider),this.providers.set(new DesEde3CbcProvider),this.providers.set(new RsaSsaProvider),this.providers.set(new RsaPssProvider),this.providers.set(new RsaOaepProvider),this.providers.set(new RsaEsProvider),this.providers.set(new EcdsaProvider),this.providers.set(new EcdhProvider),this.providers.set(new Sha1Provider),this.providers.set(new Sha256Provider),this.providers.set(new Sha384Provider),this.providers.set(new Sha512Provider),this.providers.set(new Pbkdf2Provider),this.providers.set(new HmacProvider),this.providers.set(new HkdfProvider);let r=null===(t=/^v(\d+)/.exec(eP.version))||void 0===t?void 0:t[1];r&&parseInt(r,10)>=12&&(this.providers.set(new Shake128Provider),this.providers.set(new Shake256Provider));let a=eR.getHashes();a.includes("sha3-256")&&this.providers.set(new Sha3256Provider),a.includes("sha3-384")&&this.providers.set(new Sha3384Provider),a.includes("sha3-512")&&this.providers.set(new Sha3512Provider),r&&parseInt(r,10)>=14&&(this.providers.set(new EdDsaProvider),this.providers.set(new EcdhEsProvider))}};let Crypto=class Crypto extends webcrypto_core_es_Crypto{constructor(){super(...arguments),this.subtle=new SubtleCrypto}getRandomValues(t){if(!ArrayBuffer.isView(t))throw TypeError("Failed to execute 'getRandomValues' on 'Crypto': parameter 1 is not of type 'ArrayBufferView'");let r=Buffer.from(t.buffer,t.byteOffset,t.byteLength);return eB().randomFillSync(r),t}}},94403:(t,r)=>{/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */r.Q=parse;var a=Object.prototype.toString;function parse(t,r){if("string"!=typeof t)throw TypeError("argument str must be a string");for(var a={},n=(r||{}).decode||decode,o=0;o<t.length;){var i=t.indexOf("=",o);if(-1===i)break;var s=t.indexOf(";",o);if(-1===s)s=t.length;else if(s<i){o=t.lastIndexOf(";",i-1)+1;continue}var l=t.slice(o,i).trim();if(void 0===a[l]){var u=t.slice(i+1,s).trim();34===u.charCodeAt(0)&&(u=u.slice(1,-1)),a[l]=tryDecode(u,n)}o=s+1}return a}function decode(t){return -1!==t.indexOf("%")?decodeURIComponent(t):t}function tryDecode(t,r){try{return r(t)}catch(r){return t}}},93970:t=>{var isMergeableObject=function(t){return isNonNullObject(t)&&!isSpecial(t)};function isNonNullObject(t){return!!t&&"object"==typeof t}function isSpecial(t){var r=Object.prototype.toString.call(t);return"[object RegExp]"===r||"[object Date]"===r||isReactElement(t)}var r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function isReactElement(t){return t.$$typeof===r}function emptyTarget(t){return Array.isArray(t)?[]:{}}function cloneUnlessOtherwiseSpecified(t,r){return!1!==r.clone&&r.isMergeableObject(t)?deepmerge(emptyTarget(t),t,r):t}function defaultArrayMerge(t,r,a){return t.concat(r).map(function(t){return cloneUnlessOtherwiseSpecified(t,a)})}function getMergeFunction(t,r){if(!r.customMerge)return deepmerge;var a=r.customMerge(t);return"function"==typeof a?a:deepmerge}function getEnumerableOwnPropertySymbols(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(r){return t.propertyIsEnumerable(r)}):[]}function getKeys(t){return Object.keys(t).concat(getEnumerableOwnPropertySymbols(t))}function propertyIsOnObject(t,r){try{return r in t}catch(t){return!1}}function propertyIsUnsafe(t,r){return propertyIsOnObject(t,r)&&!(Object.hasOwnProperty.call(t,r)&&Object.propertyIsEnumerable.call(t,r))}function mergeObject(t,r,a){var n={};return a.isMergeableObject(t)&&getKeys(t).forEach(function(r){n[r]=cloneUnlessOtherwiseSpecified(t[r],a)}),getKeys(r).forEach(function(o){propertyIsUnsafe(t,o)||(propertyIsOnObject(t,o)&&a.isMergeableObject(r[o])?n[o]=getMergeFunction(o,a)(t[o],r[o],a):n[o]=cloneUnlessOtherwiseSpecified(r[o],a))}),n}function deepmerge(t,r,a){(a=a||{}).arrayMerge=a.arrayMerge||defaultArrayMerge,a.isMergeableObject=a.isMergeableObject||isMergeableObject,a.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var n=Array.isArray(r);return n!==Array.isArray(t)?cloneUnlessOtherwiseSpecified(r,a):n?a.arrayMerge(t,r,a):mergeObject(t,r,a)}deepmerge.all=function(t,r){if(!Array.isArray(t))throw Error("first argument should be an array");return t.reduce(function(t,a){return deepmerge(t,a,r)},{})};var a=deepmerge;t.exports=a},40322:t=>{let isObject=t=>"object"==typeof t&&null!==t,r=Symbol("skip"),isObjectCustom=t=>isObject(t)&&!(t instanceof RegExp)&&!(t instanceof Error)&&!(t instanceof Date),mapObject=(t,a,n,o=new WeakMap)=>{if(n={deep:!1,target:{},...n},o.has(t))return o.get(t);o.set(t,n.target);let{target:i}=n;delete n.target;let mapArray=t=>t.map(t=>isObjectCustom(t)?mapObject(t,a,n,o):t);if(Array.isArray(t))return mapArray(t);for(let[s,l]of Object.entries(t)){let u=a(s,l,t);if(u===r)continue;let[c,d,{shouldRecurse:h=!0}={}]=u;"__proto__"!==c&&(n.deep&&h&&isObjectCustom(d)&&(d=Array.isArray(d)?mapArray(d):mapObject(d,a,n,o)),i[c]=d)}return i};t.exports=(t,r,a)=>{if(!isObject(t))throw TypeError(`Expected an object, got \`${t}\` (${typeof t})`);return mapObject(t,r,a)},t.exports.mapObjectSkip=r},84535:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createProxy",{enumerable:!0,get:function(){return o}});let n=a(81821),o=n.createClientModuleProxy},49897:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"bailoutToClientRendering",{enumerable:!0,get:function(){return bailoutToClientRendering}});let n=a(24791),o=a(45869);function bailoutToClientRendering(){let t=o.staticGenerationAsyncStorage.getStore();return null!=t&&!!t.forceStatic||((null==t?void 0:t.isStaticGeneration)&&(0,n.throwWithNoSSR)(),!1)}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},52680:(t,r,a)=>{function clientHookInServerComponentError(t){}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"clientHookInServerComponentError",{enumerable:!0,get:function(){return clientHookInServerComponentError}}),a(46867),a(82667),("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},29705:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"DraftMode",{enumerable:!0,get:function(){return DraftMode}});let n=a(80987);let DraftMode=class DraftMode{get isEnabled(){return this._provider.isEnabled}enable(){if(!(0,n.staticGenerationBailout)("draftMode().enable()"))return this._provider.enable()}disable(){if(!(0,n.staticGenerationBailout)("draftMode().disable()"))return this._provider.disable()}constructor(t){this._provider=t}};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},74041:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{headers:function(){return headers},cookies:function(){return cookies},draftMode:function(){return draftMode}});let n=a(6179),o=a(35280),i=a(80495),s=a(54580),l=a(72934),u=a(80987),c=a(29705);function headers(){if((0,u.staticGenerationBailout)("headers",{link:"https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering"}))return o.HeadersAdapter.seal(new Headers({}));let t=s.requestAsyncStorage.getStore();if(!t)throw Error("Invariant: headers() expects to have requestAsyncStorage, none available.");return t.headers}function cookies(){if((0,u.staticGenerationBailout)("cookies",{link:"https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering"}))return n.RequestCookiesAdapter.seal(new i.RequestCookies(new Headers({})));let t=s.requestAsyncStorage.getStore();if(!t)throw Error("Invariant: cookies() expects to have requestAsyncStorage, none available.");let r=l.actionAsyncStorage.getStore();return r&&(r.isAction||r.isAppRoute)?t.mutableCookies:t.cookies}function draftMode(){let t=s.requestAsyncStorage.getStore();if(!t)throw Error("Invariant: draftMode() expects to have requestAsyncStorage, none available.");return new c.DraftMode(t.draftMode)}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},14832:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{DYNAMIC_ERROR_CODE:function(){return a},DynamicServerError:function(){return DynamicServerError}});let a="DYNAMIC_SERVER_USAGE";let DynamicServerError=class DynamicServerError extends Error{constructor(t){super("Dynamic server usage: "+t),this.digest=a}};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},37901:(t,r,a)=>{function maybePostpone(t,r){if(!t.isStaticGeneration||!t.experimental.ppr)return;let n=a(82667);"function"==typeof n.unstable_postpone&&n.unstable_postpone(r)}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"maybePostpone",{enumerable:!0,get:function(){return maybePostpone}}),("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},17158:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{ReadonlyURLSearchParams:function(){return ReadonlyURLSearchParams},useSearchParams:function(){return useSearchParams},usePathname:function(){return usePathname},ServerInsertedHTMLContext:function(){return u.ServerInsertedHTMLContext},useServerInsertedHTML:function(){return u.useServerInsertedHTML},useRouter:function(){return useRouter},useParams:function(){return useParams},useSelectedLayoutSegments:function(){return useSelectedLayoutSegments},useSelectedLayoutSegment:function(){return useSelectedLayoutSegment},redirect:function(){return c.redirect},permanentRedirect:function(){return c.permanentRedirect},RedirectType:function(){return c.RedirectType},notFound:function(){return d.notFound}});let n=a(82667),o=a(38505),i=a(60277),s=a(52680),l=a(75734),u=a(59295),c=a(77821),d=a(75668),h=Symbol("internal for urlsearchparams readonly");function readonlyURLSearchParamsError(){return Error("ReadonlyURLSearchParams cannot be modified")}let ReadonlyURLSearchParams=class ReadonlyURLSearchParams{[Symbol.iterator](){return this[h][Symbol.iterator]()}append(){throw readonlyURLSearchParamsError()}delete(){throw readonlyURLSearchParamsError()}set(){throw readonlyURLSearchParamsError()}sort(){throw readonlyURLSearchParamsError()}constructor(t){this[h]=t,this.entries=t.entries.bind(t),this.forEach=t.forEach.bind(t),this.get=t.get.bind(t),this.getAll=t.getAll.bind(t),this.has=t.has.bind(t),this.keys=t.keys.bind(t),this.values=t.values.bind(t),this.toString=t.toString.bind(t),this.size=t.size}};function useSearchParams(){(0,s.clientHookInServerComponentError)("useSearchParams");let t=(0,n.useContext)(i.SearchParamsContext),r=(0,n.useMemo)(()=>t?new ReadonlyURLSearchParams(t):null,[t]);{let{bailoutToClientRendering:t}=a(49897);t()}return r}function usePathname(){return(0,s.clientHookInServerComponentError)("usePathname"),(0,n.useContext)(i.PathnameContext)}function useRouter(){(0,s.clientHookInServerComponentError)("useRouter");let t=(0,n.useContext)(o.AppRouterContext);if(null===t)throw Error("invariant expected app router to be mounted");return t}function getSelectedParams(t,r){void 0===r&&(r={});let a=t[1];for(let t of Object.values(a)){let a=t[0],n=Array.isArray(a),o=n?a[1]:a;if(!o||o.startsWith("__PAGE__"))continue;let i=n&&("c"===a[2]||"oc"===a[2]);i?r[a[0]]=a[1].split("/"):n&&(r[a[0]]=a[1]),r=getSelectedParams(t,r)}return r}function useParams(){(0,s.clientHookInServerComponentError)("useParams");let t=(0,n.useContext)(o.GlobalLayoutRouterContext),r=(0,n.useContext)(i.PathParamsContext);return(0,n.useMemo)(()=>(null==t?void 0:t.tree)?getSelectedParams(t.tree):r,[null==t?void 0:t.tree,r])}function getSelectedLayoutSegmentPath(t,r,a,n){let o;if(void 0===a&&(a=!0),void 0===n&&(n=[]),a)o=t[1][r];else{var i;let r=t[1];o=null!=(i=r.children)?i:Object.values(r)[0]}if(!o)return n;let s=o[0],u=(0,l.getSegmentValue)(s);return!u||u.startsWith("__PAGE__")?n:(n.push(u),getSelectedLayoutSegmentPath(o,r,!1,n))}function useSelectedLayoutSegments(t){void 0===t&&(t="children"),(0,s.clientHookInServerComponentError)("useSelectedLayoutSegments");let{tree:r}=(0,n.useContext)(o.LayoutRouterContext);return getSelectedLayoutSegmentPath(r,t)}function useSelectedLayoutSegment(t){void 0===t&&(t="children"),(0,s.clientHookInServerComponentError)("useSelectedLayoutSegment");let r=useSelectedLayoutSegments(t);return 0===r.length?null:r[0]}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},75668:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{notFound:function(){return notFound},isNotFoundError:function(){return isNotFoundError}});let a="NEXT_NOT_FOUND";function notFound(){let t=Error(a);throw t.digest=a,t}function isNotFoundError(t){return(null==t?void 0:t.digest)===a}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},77821:(t,r,a)=>{var n;Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{RedirectType:function(){return n},getRedirectError:function(){return getRedirectError},redirect:function(){return redirect},permanentRedirect:function(){return permanentRedirect},isRedirectError:function(){return isRedirectError},getURLFromRedirectError:function(){return getURLFromRedirectError},getRedirectTypeFromError:function(){return getRedirectTypeFromError}});let o=a(54580),i="NEXT_REDIRECT";function getRedirectError(t,r,a){void 0===a&&(a=!1);let n=Error(i);n.digest=i+";"+r+";"+t+";"+a;let s=o.requestAsyncStorage.getStore();return s&&(n.mutableCookies=s.mutableCookies),n}function redirect(t,r){throw void 0===r&&(r="replace"),getRedirectError(t,r,!1)}function permanentRedirect(t,r){throw void 0===r&&(r="replace"),getRedirectError(t,r,!0)}function isRedirectError(t){if("string"!=typeof(null==t?void 0:t.digest))return!1;let[r,a,n,o]=t.digest.split(";",4);return r===i&&("replace"===a||"push"===a)&&"string"==typeof n&&("true"===o||"false"===o)}function getURLFromRedirectError(t){return isRedirectError(t)?t.digest.split(";",3)[2]:null}function getRedirectTypeFromError(t){if(!isRedirectError(t))throw Error("Not a redirect error");return t.digest.split(";",2)[1]}(function(t){t.push="push",t.replace="replace"})(n||(n={})),("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},75734:(t,r)=>{function getSegmentValue(t){return Array.isArray(t)?t[1]:t}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getSegmentValue",{enumerable:!0,get:function(){return getSegmentValue}}),("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},80987:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"staticGenerationBailout",{enumerable:!0,get:function(){return staticGenerationBailout}});let n=a(14832),o=a(37901),i=a(45869);let StaticGenBailoutError=class StaticGenBailoutError extends Error{constructor(...t){super(...t),this.code="NEXT_STATIC_GEN_BAILOUT"}};function formatErrorMessage(t,r){let{dynamic:a,link:n}=r||{};return"Page"+(a?' with `dynamic = "'+a+'"`':"")+" couldn't be rendered statically because it used `"+t+"`."+(n?" See more info here: "+n:"")}let staticGenerationBailout=(t,r)=>{let a=i.staticGenerationAsyncStorage.getStore();if(!a)return!1;if(a.forceStatic)return!0;if(a.dynamicShouldError){var s;throw new StaticGenBailoutError(formatErrorMessage(t,{...r,dynamic:null!=(s=null==r?void 0:r.dynamic)?s:"error"}))}let l=formatErrorMessage(t,{...r,link:"https://nextjs.org/docs/messages/dynamic-server-error"});if((0,o.maybePostpone)(a,l),a.revalidate=0,(null==r?void 0:r.dynamic)||(a.staticPrefetchBailout=!0),a.isStaticGeneration){let r=new n.DynamicServerError(l);throw a.dynamicUsageDescription=t,a.dynamicUsageStack=r.stack,r}return!1};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},29869:t=>{var r=Object.defineProperty,a=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,i={};function stringifyCookie(t){var r;let a=["path"in t&&t.path&&`Path=${t.path}`,"expires"in t&&(t.expires||0===t.expires)&&`Expires=${("number"==typeof t.expires?new Date(t.expires):t.expires).toUTCString()}`,"maxAge"in t&&"number"==typeof t.maxAge&&`Max-Age=${t.maxAge}`,"domain"in t&&t.domain&&`Domain=${t.domain}`,"secure"in t&&t.secure&&"Secure","httpOnly"in t&&t.httpOnly&&"HttpOnly","sameSite"in t&&t.sameSite&&`SameSite=${t.sameSite}`,"priority"in t&&t.priority&&`Priority=${t.priority}`].filter(Boolean);return`${t.name}=${encodeURIComponent(null!=(r=t.value)?r:"")}; ${a.join("; ")}`}function parseCookie(t){let r=new Map;for(let a of t.split(/; */)){if(!a)continue;let t=a.indexOf("=");if(-1===t){r.set(a,"true");continue}let[n,o]=[a.slice(0,t),a.slice(t+1)];try{r.set(n,decodeURIComponent(null!=o?o:"true"))}catch{}}return r}function parseSetCookie(t){if(!t)return;let[[r,a],...n]=parseCookie(t),{domain:o,expires:i,httponly:s,maxage:l,path:u,samesite:c,secure:d,priority:h}=Object.fromEntries(n.map(([t,r])=>[t.toLowerCase(),r])),p={name:r,value:decodeURIComponent(a),domain:o,...i&&{expires:new Date(i)},...s&&{httpOnly:!0},..."string"==typeof l&&{maxAge:Number(l)},path:u,...c&&{sameSite:parseSameSite(c)},...d&&{secure:!0},...h&&{priority:parsePriority(h)}};return compact(p)}function compact(t){let r={};for(let a in t)t[a]&&(r[a]=t[a]);return r}((t,a)=>{for(var n in a)r(t,n,{get:a[n],enumerable:!0})})(i,{RequestCookies:()=>u,ResponseCookies:()=>c,parseCookie:()=>parseCookie,parseSetCookie:()=>parseSetCookie,stringifyCookie:()=>stringifyCookie}),t.exports=((t,i,s,l)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let s of n(i))o.call(t,s)||void 0===s||r(t,s,{get:()=>i[s],enumerable:!(l=a(i,s))||l.enumerable});return t})(r({},"__esModule",{value:!0}),i);var s=["strict","lax","none"];function parseSameSite(t){return t=t.toLowerCase(),s.includes(t)?t:void 0}var l=["low","medium","high"];function parsePriority(t){return t=t.toLowerCase(),l.includes(t)?t:void 0}function splitCookiesString(t){if(!t)return[];var r,a,n,o,i,s=[],l=0;function skipWhitespace(){for(;l<t.length&&/\s/.test(t.charAt(l));)l+=1;return l<t.length}function notSpecialChar(){return"="!==(a=t.charAt(l))&&";"!==a&&","!==a}for(;l<t.length;){for(r=l,i=!1;skipWhitespace();)if(","===(a=t.charAt(l))){for(n=l,l+=1,skipWhitespace(),o=l;l<t.length&&notSpecialChar();)l+=1;l<t.length&&"="===t.charAt(l)?(i=!0,l=o,s.push(t.substring(r,n)),r=l):l=n+1}else l+=1;(!i||l>=t.length)&&s.push(t.substring(r,t.length))}return s}var u=class{constructor(t){this._parsed=new Map,this._headers=t;let r=t.get("cookie");if(r){let t=parseCookie(r);for(let[r,a]of t)this._parsed.set(r,{name:r,value:a})}}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...t){let r="string"==typeof t[0]?t[0]:t[0].name;return this._parsed.get(r)}getAll(...t){var r;let a=Array.from(this._parsed);if(!t.length)return a.map(([t,r])=>r);let n="string"==typeof t[0]?t[0]:null==(r=t[0])?void 0:r.name;return a.filter(([t])=>t===n).map(([t,r])=>r)}has(t){return this._parsed.has(t)}set(...t){let[r,a]=1===t.length?[t[0].name,t[0].value]:t,n=this._parsed;return n.set(r,{name:r,value:a}),this._headers.set("cookie",Array.from(n).map(([t,r])=>stringifyCookie(r)).join("; ")),this}delete(t){let r=this._parsed,a=Array.isArray(t)?t.map(t=>r.delete(t)):r.delete(t);return this._headers.set("cookie",Array.from(r).map(([t,r])=>stringifyCookie(r)).join("; ")),a}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(t=>`${t.name}=${encodeURIComponent(t.value)}`).join("; ")}},c=class{constructor(t){var r,a,n;this._parsed=new Map,this._headers=t;let o=null!=(n=null!=(a=null==(r=t.getSetCookie)?void 0:r.call(t))?a:t.get("set-cookie"))?n:[],i=Array.isArray(o)?o:splitCookiesString(o);for(let t of i){let r=parseSetCookie(t);r&&this._parsed.set(r.name,r)}}get(...t){let r="string"==typeof t[0]?t[0]:t[0].name;return this._parsed.get(r)}getAll(...t){var r;let a=Array.from(this._parsed.values());if(!t.length)return a;let n="string"==typeof t[0]?t[0]:null==(r=t[0])?void 0:r.name;return a.filter(t=>t.name===n)}has(t){return this._parsed.has(t)}set(...t){let[r,a,n]=1===t.length?[t[0].name,t[0].value,t[0]]:t,o=this._parsed;return o.set(r,normalizeCookie({name:r,value:a,...n})),replace(o,this._headers),this}delete(...t){let[r,a,n]="string"==typeof t[0]?[t[0]]:[t[0].name,t[0].path,t[0].domain];return this.set({name:r,path:a,domain:n,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(stringifyCookie).join("; ")}};function replace(t,r){for(let[,a]of(r.delete("set-cookie"),t)){let t=stringifyCookie(a);r.append("set-cookie",t)}}function normalizeCookie(t={name:"",value:""}){return"number"==typeof t.expires&&(t.expires=new Date(t.expires)),t.maxAge&&(t.expires=new Date(Date.now()+1e3*t.maxAge)),(null===t.path||void 0===t.path)&&(t.path="/"),t}},74576:(t,r)=>{var a;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return a}}),function(t){t.PAGES="PAGES",t.PAGES_API="PAGES_API",t.APP_PAGE="APP_PAGE",t.APP_ROUTE="APP_ROUTE"}(a||(a={}))},78336:(t,r,a)=>{t.exports=a(20399)},38505:(t,r,a)=>{t.exports=a(78336).vendored.contexts.AppRouterContext},60277:(t,r,a)=>{t.exports=a(78336).vendored.contexts.HooksClientContext},59295:(t,r,a)=>{t.exports=a(78336).vendored.contexts.ServerInsertedHtml},81821:(t,r,a)=>{t.exports=a(78336).vendored["react-rsc"].ReactServerDOMWebpackServerEdge},82667:(t,r,a)=>{t.exports=a(78336).vendored["react-rsc"].React},68412:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{PageSignatureError:function(){return PageSignatureError},RemovedPageError:function(){return RemovedPageError},RemovedUAError:function(){return RemovedUAError}});let PageSignatureError=class PageSignatureError extends Error{constructor({page:t}){super(`The middleware "${t}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}};let RemovedPageError=class RemovedPageError extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}};let RemovedUAError=class RemovedUAError extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}},50571:(t,r,a)=>{Object.defineProperty(r,"Z",{enumerable:!0,get:function(){return n.NextRequest}});let n=a(67325)},63366:(t,r,a)=>{Object.defineProperty(r,"Z",{enumerable:!0,get:function(){return n.NextResponse}});let n=a(82581)},99403:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"NextURL",{enumerable:!0,get:function(){return NextURL}});let n=a(93027),o=a(76389),i=a(16144),s=a(26680),l=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function parseURL(t,r){return new URL(String(t).replace(l,"localhost"),r&&String(r).replace(l,"localhost"))}let u=Symbol("NextURLInternal");let NextURL=class NextURL{constructor(t,r,a){let n,o;"object"==typeof r&&"pathname"in r||"string"==typeof r?(n=r,o=a||{}):o=a||r||{},this[u]={url:parseURL(t,n??o.base),options:o,basePath:""},this.analyze()}analyze(){var t,r,a,o,l;let c=(0,s.getNextPathnameInfo)(this[u].url.pathname,{nextConfig:this[u].options.nextConfig,parseData:!0,i18nProvider:this[u].options.i18nProvider}),d=(0,i.getHostname)(this[u].url,this[u].options.headers);this[u].domainLocale=this[u].options.i18nProvider?this[u].options.i18nProvider.detectDomainLocale(d):(0,n.detectDomainLocale)(null==(r=this[u].options.nextConfig)?void 0:null==(t=r.i18n)?void 0:t.domains,d);let h=(null==(a=this[u].domainLocale)?void 0:a.defaultLocale)||(null==(l=this[u].options.nextConfig)?void 0:null==(o=l.i18n)?void 0:o.defaultLocale);this[u].url.pathname=c.pathname,this[u].defaultLocale=h,this[u].basePath=c.basePath??"",this[u].buildId=c.buildId,this[u].locale=c.locale??h,this[u].trailingSlash=c.trailingSlash}formatPathname(){return(0,o.formatNextPathnameInfo)({basePath:this[u].basePath,buildId:this[u].buildId,defaultLocale:this[u].options.forceLocale?void 0:this[u].defaultLocale,locale:this[u].locale,pathname:this[u].url.pathname,trailingSlash:this[u].trailingSlash})}formatSearch(){return this[u].url.search}get buildId(){return this[u].buildId}set buildId(t){this[u].buildId=t}get locale(){return this[u].locale??""}set locale(t){var r,a;if(!this[u].locale||!(null==(a=this[u].options.nextConfig)?void 0:null==(r=a.i18n)?void 0:r.locales.includes(t)))throw TypeError(`The NextURL configuration includes no locale "${t}"`);this[u].locale=t}get defaultLocale(){return this[u].defaultLocale}get domainLocale(){return this[u].domainLocale}get searchParams(){return this[u].url.searchParams}get host(){return this[u].url.host}set host(t){this[u].url.host=t}get hostname(){return this[u].url.hostname}set hostname(t){this[u].url.hostname=t}get port(){return this[u].url.port}set port(t){this[u].url.port=t}get protocol(){return this[u].url.protocol}set protocol(t){this[u].url.protocol=t}get href(){let t=this.formatPathname(),r=this.formatSearch();return`${this.protocol}//${this.host}${t}${r}${this.hash}`}set href(t){this[u].url=parseURL(t),this.analyze()}get origin(){return this[u].url.origin}get pathname(){return this[u].url.pathname}set pathname(t){this[u].url.pathname=t}get hash(){return this[u].url.hash}set hash(t){this[u].url.hash=t}get search(){return this[u].url.search}set search(t){this[u].url.search=t}get password(){return this[u].url.password}set password(t){this[u].url.password=t}get username(){return this[u].url.username}set username(t){this[u].url.username=t}get basePath(){return this[u].basePath}set basePath(t){this[u].basePath=t.startsWith("/")?t:`/${t}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new NextURL(String(this),this[u].options)}}},35280:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{ReadonlyHeadersError:function(){return ReadonlyHeadersError},HeadersAdapter:function(){return HeadersAdapter}});let n=a(42757);let ReadonlyHeadersError=class ReadonlyHeadersError extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new ReadonlyHeadersError}};let HeadersAdapter=class HeadersAdapter extends Headers{constructor(t){super(),this.headers=new Proxy(t,{get(r,a,o){if("symbol"==typeof a)return n.ReflectAdapter.get(r,a,o);let i=a.toLowerCase(),s=Object.keys(t).find(t=>t.toLowerCase()===i);if(void 0!==s)return n.ReflectAdapter.get(r,s,o)},set(r,a,o,i){if("symbol"==typeof a)return n.ReflectAdapter.set(r,a,o,i);let s=a.toLowerCase(),l=Object.keys(t).find(t=>t.toLowerCase()===s);return n.ReflectAdapter.set(r,l??a,o,i)},has(r,a){if("symbol"==typeof a)return n.ReflectAdapter.has(r,a);let o=a.toLowerCase(),i=Object.keys(t).find(t=>t.toLowerCase()===o);return void 0!==i&&n.ReflectAdapter.has(r,i)},deleteProperty(r,a){if("symbol"==typeof a)return n.ReflectAdapter.deleteProperty(r,a);let o=a.toLowerCase(),i=Object.keys(t).find(t=>t.toLowerCase()===o);return void 0===i||n.ReflectAdapter.deleteProperty(r,i)}})}static seal(t){return new Proxy(t,{get(t,r,a){switch(r){case"append":case"delete":case"set":return ReadonlyHeadersError.callable;default:return n.ReflectAdapter.get(t,r,a)}}})}merge(t){return Array.isArray(t)?t.join(", "):t}static from(t){return t instanceof Headers?t:new HeadersAdapter(t)}append(t,r){let a=this.headers[t];"string"==typeof a?this.headers[t]=[a,r]:Array.isArray(a)?a.push(r):this.headers[t]=r}delete(t){delete this.headers[t]}get(t){let r=this.headers[t];return void 0!==r?this.merge(r):null}has(t){return void 0!==this.headers[t]}set(t,r){this.headers[t]=r}forEach(t,r){for(let[a,n]of this.entries())t.call(r,n,a,this)}*entries(){for(let t of Object.keys(this.headers)){let r=t.toLowerCase(),a=this.get(r);yield[r,a]}}*keys(){for(let t of Object.keys(this.headers)){let r=t.toLowerCase();yield r}}*values(){for(let t of Object.keys(this.headers)){let r=this.get(t);yield r}}[Symbol.iterator](){return this.entries()}}},42757:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReflectAdapter",{enumerable:!0,get:function(){return ReflectAdapter}});let ReflectAdapter=class ReflectAdapter{static get(t,r,a){let n=Reflect.get(t,r,a);return"function"==typeof n?n.bind(t):n}static set(t,r,a,n){return Reflect.set(t,r,a,n)}static has(t,r){return Reflect.has(t,r)}static deleteProperty(t,r){return Reflect.deleteProperty(t,r)}}},6179:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{ReadonlyRequestCookiesError:function(){return ReadonlyRequestCookiesError},RequestCookiesAdapter:function(){return RequestCookiesAdapter},getModifiedCookieValues:function(){return getModifiedCookieValues},appendMutableCookies:function(){return appendMutableCookies},MutableRequestCookiesAdapter:function(){return MutableRequestCookiesAdapter}});let n=a(80495),o=a(42757);let ReadonlyRequestCookiesError=class ReadonlyRequestCookiesError extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new ReadonlyRequestCookiesError}};let RequestCookiesAdapter=class RequestCookiesAdapter{static seal(t){return new Proxy(t,{get(t,r,a){switch(r){case"clear":case"delete":case"set":return ReadonlyRequestCookiesError.callable;default:return o.ReflectAdapter.get(t,r,a)}}})}};let i=Symbol.for("next.mutated.cookies");function getModifiedCookieValues(t){let r=t[i];return r&&Array.isArray(r)&&0!==r.length?r:[]}function appendMutableCookies(t,r){let a=getModifiedCookieValues(r);if(0===a.length)return!1;let o=new n.ResponseCookies(t),i=o.getAll();for(let t of a)o.set(t);for(let t of i)o.set(t);return!0}let MutableRequestCookiesAdapter=class MutableRequestCookiesAdapter{static wrap(t,r){let a=new n.ResponseCookies(new Headers);for(let r of t.getAll())a.set(r);let s=[],l=new Set,updateResponseCookies=()=>{var t;let o=null==fetch.__nextGetStaticStore?void 0:null==(t=fetch.__nextGetStaticStore.call(fetch))?void 0:t.getStore();o&&(o.pathWasRevalidated=!0);let i=a.getAll();if(s=i.filter(t=>l.has(t.name)),r){let t=[];for(let r of s){let a=new n.ResponseCookies(new Headers);a.set(r),t.push(a.toString())}r(t)}};return new Proxy(a,{get(t,r,a){switch(r){case i:return s;case"delete":return function(...r){l.add("string"==typeof r[0]?r[0]:r[0].name);try{t.delete(...r)}finally{updateResponseCookies()}};case"set":return function(...r){l.add("string"==typeof r[0]?r[0]:r[0].name);try{return t.set(...r)}finally{updateResponseCookies()}};default:return o.ReflectAdapter.get(t,r,a)}}})}}},80495:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{RequestCookies:function(){return n.RequestCookies},ResponseCookies:function(){return n.ResponseCookies}});let n=a(29869)},67325:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{INTERNALS:function(){return l},NextRequest:function(){return NextRequest}});let n=a(99403),o=a(89877),i=a(68412),s=a(80495),l=Symbol("internal request");let NextRequest=class NextRequest extends Request{constructor(t,r={}){let a="string"!=typeof t&&"url"in t?t.url:String(t);(0,o.validateURL)(a),t instanceof Request?super(t,r):super(a,r);let i=new n.NextURL(a,{headers:(0,o.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:r.nextConfig});this[l]={cookies:new s.RequestCookies(this.headers),geo:r.geo||{},ip:r.ip,nextUrl:i,url:i.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,geo:this.geo,ip:this.ip,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[l].cookies}get geo(){return this[l].geo}get ip(){return this[l].ip}get nextUrl(){return this[l].nextUrl}get page(){throw new i.RemovedPageError}get ua(){throw new i.RemovedUAError}get url(){return this[l].url}}},82581:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"NextResponse",{enumerable:!0,get:function(){return NextResponse}});let n=a(99403),o=a(89877),i=a(80495),s=Symbol("internal response"),l=new Set([301,302,303,307,308]);function handleMiddlewareField(t,r){var a;if(null==t?void 0:null==(a=t.request)?void 0:a.headers){if(!(t.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let a=[];for(let[n,o]of t.request.headers)r.set("x-middleware-request-"+n,o),a.push(n);r.set("x-middleware-override-headers",a.join(","))}}let NextResponse=class NextResponse extends Response{constructor(t,r={}){super(t,r),this[s]={cookies:new i.ResponseCookies(this.headers),url:r.url?new n.NextURL(r.url,{headers:(0,o.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:r.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[s].cookies}static json(t,r){let a=Response.json(t,r);return new NextResponse(a.body,a)}static redirect(t,r){let a="number"==typeof r?r:(null==r?void 0:r.status)??307;if(!l.has(a))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let n="object"==typeof r?r:{},i=new Headers(null==n?void 0:n.headers);return i.set("Location",(0,o.validateURL)(t)),new NextResponse(null,{...n,headers:i,status:a})}static rewrite(t,r){let a=new Headers(null==r?void 0:r.headers);return a.set("x-middleware-rewrite",(0,o.validateURL)(t)),handleMiddlewareField(r,a),new NextResponse(null,{...r,headers:a})}static next(t){let r=new Headers(null==t?void 0:t.headers);return r.set("x-middleware-next","1"),handleMiddlewareField(t,r),new NextResponse(null,{...t,headers:r})}}},89877:(t,r)=>{function fromNodeOutgoingHttpHeaders(t){let r=new Headers;for(let[a,n]of Object.entries(t)){let t=Array.isArray(n)?n:[n];for(let n of t)void 0!==n&&("number"==typeof n&&(n=n.toString()),r.append(a,n))}return r}function splitCookiesString(t){var r,a,n,o,i,s=[],l=0;function skipWhitespace(){for(;l<t.length&&/\s/.test(t.charAt(l));)l+=1;return l<t.length}function notSpecialChar(){return"="!==(a=t.charAt(l))&&";"!==a&&","!==a}for(;l<t.length;){for(r=l,i=!1;skipWhitespace();)if(","===(a=t.charAt(l))){for(n=l,l+=1,skipWhitespace(),o=l;l<t.length&&notSpecialChar();)l+=1;l<t.length&&"="===t.charAt(l)?(i=!0,l=o,s.push(t.substring(r,n)),r=l):l=n+1}else l+=1;(!i||l>=t.length)&&s.push(t.substring(r,t.length))}return s}function toNodeOutgoingHttpHeaders(t){let r={},a=[];if(t)for(let[n,o]of t.entries())"set-cookie"===n.toLowerCase()?(a.push(...splitCookiesString(o)),r[n]=1===a.length?a[0]:a):r[n]=o;return r}function validateURL(t){try{return String(new URL(String(t)))}catch(r){throw Error(`URL is malformed "${String(t)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:r})}}Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{fromNodeOutgoingHttpHeaders:function(){return fromNodeOutgoingHttpHeaders},splitCookiesString:function(){return splitCookiesString},toNodeOutgoingHttpHeaders:function(){return toNodeOutgoingHttpHeaders},validateURL:function(){return validateURL}})},16144:(t,r)=>{function getHostname(t,r){let a;if((null==r?void 0:r.host)&&!Array.isArray(r.host))a=r.host.toString().split(":",1)[0];else{if(!t.hostname)return;a=t.hostname}return a.toLowerCase()}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getHostname",{enumerable:!0,get:function(){return getHostname}})},93027:(t,r)=>{function detectDomainLocale(t,r,a){if(t)for(let i of(a&&(a=a.toLowerCase()),t)){var n,o;let t=null==(n=i.domain)?void 0:n.split(":",1)[0].toLowerCase();if(r===t||a===i.defaultLocale.toLowerCase()||(null==(o=i.locales)?void 0:o.some(t=>t.toLowerCase()===a)))return i}}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"detectDomainLocale",{enumerable:!0,get:function(){return detectDomainLocale}})},67262:(t,r)=>{function normalizeLocalePath(t,r){let a;let n=t.split("/");return(r||[]).some(r=>!!n[1]&&n[1].toLowerCase()===r.toLowerCase()&&(a=r,n.splice(1,1),t=n.join("/")||"/",!0)),{pathname:t,detectedLocale:a}}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"normalizeLocalePath",{enumerable:!0,get:function(){return normalizeLocalePath}})},24791:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var a in r)Object.defineProperty(t,a,{enumerable:!0,get:r[a]})}(r,{NEXT_DYNAMIC_NO_SSR_CODE:function(){return a},throwWithNoSSR:function(){return throwWithNoSSR}});let a="NEXT_DYNAMIC_NO_SSR_CODE";function throwWithNoSSR(){let t=Error(a);throw t.digest=a,t}},59069:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"addLocale",{enumerable:!0,get:function(){return addLocale}});let n=a(56988),o=a(25589);function addLocale(t,r,a,i){if(!r||r===a)return t;let s=t.toLowerCase();return!i&&((0,o.pathHasPrefix)(s,"/api")||(0,o.pathHasPrefix)(s,"/"+r.toLowerCase()))?t:(0,n.addPathPrefix)(t,"/"+r)}},56988:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"addPathPrefix",{enumerable:!0,get:function(){return addPathPrefix}});let n=a(9484);function addPathPrefix(t,r){if(!t.startsWith("/")||!r)return t;let{pathname:a,query:o,hash:i}=(0,n.parsePath)(t);return""+r+a+o+i}},54911:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"addPathSuffix",{enumerable:!0,get:function(){return addPathSuffix}});let n=a(9484);function addPathSuffix(t,r){if(!t.startsWith("/")||!r)return t;let{pathname:a,query:o,hash:i}=(0,n.parsePath)(t);return""+a+r+o+i}},76389:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"formatNextPathnameInfo",{enumerable:!0,get:function(){return formatNextPathnameInfo}});let n=a(86891),o=a(56988),i=a(54911),s=a(59069);function formatNextPathnameInfo(t){let r=(0,s.addLocale)(t.pathname,t.locale,t.buildId?void 0:t.defaultLocale,t.ignorePrefix);return(t.buildId||!t.trailingSlash)&&(r=(0,n.removeTrailingSlash)(r)),t.buildId&&(r=(0,i.addPathSuffix)((0,o.addPathPrefix)(r,"/_next/data/"+t.buildId),"/"===t.pathname?"index.json":".json")),r=(0,o.addPathPrefix)(r,t.basePath),!t.buildId&&t.trailingSlash?r.endsWith("/")?r:(0,i.addPathSuffix)(r,"/"):(0,n.removeTrailingSlash)(r)}},26680:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getNextPathnameInfo",{enumerable:!0,get:function(){return getNextPathnameInfo}});let n=a(67262),o=a(60490),i=a(25589);function getNextPathnameInfo(t,r){var a,s;let{basePath:l,i18n:u,trailingSlash:c}=null!=(a=r.nextConfig)?a:{},d={pathname:t,trailingSlash:"/"!==t?t.endsWith("/"):c};l&&(0,i.pathHasPrefix)(d.pathname,l)&&(d.pathname=(0,o.removePathPrefix)(d.pathname,l),d.basePath=l);let h=d.pathname;if(d.pathname.startsWith("/_next/data/")&&d.pathname.endsWith(".json")){let t=d.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),a=t[0];d.buildId=a,h="index"!==t[1]?"/"+t.slice(1).join("/"):"/",!0===r.parseData&&(d.pathname=h)}if(u){let t=r.i18nProvider?r.i18nProvider.analyze(d.pathname):(0,n.normalizeLocalePath)(d.pathname,u.locales);d.locale=t.detectedLocale,d.pathname=null!=(s=t.pathname)?s:d.pathname,!t.detectedLocale&&d.buildId&&(t=r.i18nProvider?r.i18nProvider.analyze(h):(0,n.normalizeLocalePath)(h,u.locales)).detectedLocale&&(d.locale=t.detectedLocale)}return d}},9484:(t,r)=>{function parsePath(t){let r=t.indexOf("#"),a=t.indexOf("?"),n=a>-1&&(r<0||a<r);return n||r>-1?{pathname:t.substring(0,n?a:r),query:n?t.substring(a,r>-1?r:void 0):"",hash:r>-1?t.slice(r):""}:{pathname:t,query:"",hash:""}}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"parsePath",{enumerable:!0,get:function(){return parsePath}})},25589:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"pathHasPrefix",{enumerable:!0,get:function(){return pathHasPrefix}});let n=a(9484);function pathHasPrefix(t,r){if("string"!=typeof t)return!1;let{pathname:a}=(0,n.parsePath)(t);return a===r||a.startsWith(r+"/")}},60490:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"removePathPrefix",{enumerable:!0,get:function(){return removePathPrefix}});let n=a(25589);function removePathPrefix(t,r){if(!(0,n.pathHasPrefix)(t,r))return t;let a=t.slice(r.length);return a.startsWith("/")?a:"/"+a}},86891:(t,r)=>{function removeTrailingSlash(t){return t.replace(/\/$/,"")||"/"}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"removeTrailingSlash",{enumerable:!0,get:function(){return removeTrailingSlash}})},28942:(t,r,a)=>{t.exports=a(74041)},52462:(t,r,a)=>{t.exports=a(17158)},89882:(t,r,a)=>{a.r(r),a.d(r,{snakeCase:()=>snakeCase});var n=a(90919);function lowerCase(t){return t.toLowerCase()}var o=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],i=/[^A-Z0-9]+/gi;function noCase(t,r){void 0===r&&(r={});for(var a=r.splitRegexp,n=r.stripRegexp,s=r.transform,l=void 0===s?lowerCase:s,u=r.delimiter,c=void 0===u?" ":u,d=replace(replace(t,void 0===a?o:a,"$1\x00$2"),void 0===n?i:n,"\x00"),h=0,p=d.length;"\x00"===d.charAt(h);)h++;for(;"\x00"===d.charAt(p-1);)p--;return d.slice(h,p).split("\x00").map(l).join(c)}function replace(t,r,a){return r instanceof RegExp?t.replace(r,a):r.reduce(function(t,r){return t.replace(r,a)},t)}function dotCase(t,r){return void 0===r&&(r={}),noCase(t,(0,n.pi)({delimiter:"."},r))}function snakeCase(t,r){return void 0===r&&(r={}),dotCase(t,(0,n.pi)({delimiter:"_"},r))}},42292:(t,r,a)=>{let n=a(40322),{snakeCase:o}=a(89882);function matches(t,r){return t.some(function(t){return"string"==typeof t?t===r:t.test(r)})}t.exports=function(t,r){return n(t,function(t,a){return[matches(r.exclude,t)?t:o(t,r.parsingOptions),a]},r=Object.assign({deep:!0,exclude:[],parsingOptions:{}},r))}},81448:(t,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0});let n=a(37377),o=a(87561),i=a(49411);a(88849),a(22286),a(65628),a(84492),a(72254),a(47261),a(41041),a(87503);let{stat:s}=o.promises,fromBlob=(t,r,a="")=>new n._Blob([new BlobDataItem({path:r,size:t.size,lastModified:t.mtimeMs,start:0})],{type:a}),fromFile=(t,r,a="")=>new n.File([new BlobDataItem({path:r,size:t.size,lastModified:t.mtimeMs,start:0})],i.basename(r),{type:a,lastModified:t.mtimeMs});let BlobDataItem=class BlobDataItem{#e;#t;constructor(t){this.#e=t.path,this.#t=t.start,this.size=t.size,this.lastModified=t.lastModified,this.originalSize=void 0===t.originalSize?t.size:t.originalSize}slice(t,r){return new BlobDataItem({path:this.#e,lastModified:this.lastModified,originalSize:this.originalSize,size:r-t,start:this.#t+t})}async *stream(){let{mtimeMs:t,size:r}=await s(this.#e);if(t>this.lastModified||this.originalSize!==r)throw new n.nodeDomexception("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*o.createReadStream(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}};let l=globalThis.fetch||n.fetch,u=globalThis.Blob||n._Blob,c=globalThis.File||n.File,d=globalThis.FormData||n.FormData,h=globalThis.Headers||n.Headers,p=globalThis.Request||n.Request,m=globalThis.Response||n.Response,y=globalThis.AbortController||n.AbortController;r.AbortError=n.AbortError,r.FetchError=n.FetchError,r.isRedirect=n.isRedirect,r.AbortController=y,r.Blob=u,r.File=c,r.FormData=d,r.Headers=h,r.Request=p,r.Response=m,r.blobFrom=(t,r)=>s(t).then(a=>fromBlob(a,t,r)),r.blobFromSync=(t,r)=>fromBlob(o.statSync(t),t,r),r.default=l,r.fetch=l,r.fileFrom=(t,r)=>s(t).then(a=>fromFile(a,t,r)),r.fileFromSync=(t,r)=>fromFile(o.statSync(t),t,r)},37377:(t,r,a)=>{let n=a(88849),o=a(22286),i=a(65628),s=a(84492),l=a(72254),u=a(47261),c=a(41041),d=a(87503);function dataUriToBuffer(t){if(!/^data:/i.test(t))throw TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');t=t.replace(/\r?\n/g,"");let r=t.indexOf(",");if(-1===r||r<=4)throw TypeError("malformed data: URI");let a=t.substring(5,r).split(";"),n="",o=!1,i=a[0]||"text/plain",s=i;for(let t=1;t<a.length;t++)"base64"===a[t]?o=!0:(s+=`;${a[t]}`,0===a[t].indexOf("charset=")&&(n=a[t].substring(8)));a[0]||n.length||(s+=";charset=US-ASCII",n="US-ASCII");let l=o?"base64":"ascii",u=unescape(t.substring(r+1)),c=Buffer.from(u,l);return c.type=i,c.typeFull=s,c.charset=n,c}a(87561),a(49411);var h,p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},m={exports:{}};function requirePonyfill_es2018(){return h||(h=1,function(t){let r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:t=>`Symbol(${t})`;function noop(){}function getGlobals(){return"undefined"!=typeof self?self:void 0!==p?p:void 0}let a=getGlobals();function typeIsObject(t){return"object"==typeof t&&null!==t||"function"==typeof t}let n=noop,o=Promise,i=Promise.prototype.then,s=Promise.resolve.bind(o),l=Promise.reject.bind(o);function newPromise(t){return new o(t)}function PerformPromiseThen(t,r,a){return i.call(t,r,a)}function uponPromise(t,r,a){PerformPromiseThen(PerformPromiseThen(t,r,a),void 0,n)}function uponRejection(t,r){uponPromise(t,void 0,r)}function setPromiseIsHandledToTrue(t){PerformPromiseThen(t,void 0,n)}let u=(()=>{let t=a&&a.queueMicrotask;if("function"==typeof t)return t;let r=s(void 0);return t=>PerformPromiseThen(r,t)})();function reflectCall(t,r,a){if("function"!=typeof t)throw TypeError("Argument is not a function");return Function.prototype.apply.call(t,r,a)}function promiseCall(t,r,a){try{var n;return n=reflectCall(t,r,a),s(n)}catch(t){return l(t)}}let SimpleQueue=class SimpleQueue{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){let r=this._back,a=r;16383===r._elements.length&&(a={_elements:[],_next:void 0}),r._elements.push(t),a!==r&&(this._back=a,r._next=a),++this._size}shift(){let t=this._front,r=t,a=this._cursor,n=a+1,o=t._elements,i=o[a];return 16384===n&&(r=t._next,n=0),--this._size,this._cursor=n,t!==r&&(this._front=r),o[a]=void 0,i}forEach(t){let r=this._cursor,a=this._front,n=a._elements;for(;(r!==n.length||void 0!==a._next)&&(r!==n.length||(n=(a=a._next)._elements,r=0,0!==n.length));)t(n[r]),++r}peek(){let t=this._front,r=this._cursor;return t._elements[r]}};function ReadableStreamReaderGenericInitialize(t,r){var a;t._ownerReadableStream=r,r._reader=t,"readable"===r._state?defaultReaderClosedPromiseInitialize(t):"closed"===r._state?defaultReaderClosedPromiseInitializeAsResolved(t):(a=r._storedError,defaultReaderClosedPromiseInitialize(t),defaultReaderClosedPromiseReject(t,a))}function ReadableStreamReaderGenericCancel(t,r){let a=t._ownerReadableStream;return ReadableStreamCancel(a,r)}function ReadableStreamReaderGenericRelease(t){"readable"===t._ownerReadableStream._state?defaultReaderClosedPromiseReject(t,TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):defaultReaderClosedPromiseResetToRejected(t,TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),t._ownerReadableStream._reader=void 0,t._ownerReadableStream=void 0}function readerLockException(t){return TypeError("Cannot "+t+" a stream using a released reader")}function defaultReaderClosedPromiseInitialize(t){t._closedPromise=newPromise((r,a)=>{t._closedPromise_resolve=r,t._closedPromise_reject=a})}function defaultReaderClosedPromiseInitializeAsResolved(t){defaultReaderClosedPromiseInitialize(t),defaultReaderClosedPromiseResolve(t)}function defaultReaderClosedPromiseReject(t,r){void 0!==t._closedPromise_reject&&(setPromiseIsHandledToTrue(t._closedPromise),t._closedPromise_reject(r),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0)}function defaultReaderClosedPromiseResetToRejected(t,r){defaultReaderClosedPromiseInitialize(t),defaultReaderClosedPromiseReject(t,r)}function defaultReaderClosedPromiseResolve(t){void 0!==t._closedPromise_resolve&&(t._closedPromise_resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0)}let c=r("[[AbortSteps]]"),d=r("[[ErrorSteps]]"),h=r("[[CancelSteps]]"),m=r("[[PullSteps]]"),y=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},g=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};function isDictionary(t){return"object"==typeof t||"function"==typeof t}function assertDictionary(t,r){if(void 0!==t&&!isDictionary(t))throw TypeError(`${r} is not an object.`)}function assertFunction(t,r){if("function"!=typeof t)throw TypeError(`${r} is not a function.`)}function isObject(t){return"object"==typeof t&&null!==t||"function"==typeof t}function assertObject(t,r){if(!isObject(t))throw TypeError(`${r} is not an object.`)}function assertRequiredArgument(t,r,a){if(void 0===t)throw TypeError(`Parameter ${r} is required in '${a}'.`)}function assertRequiredField(t,r,a){if(void 0===t)throw TypeError(`${r} is required in '${a}'.`)}function convertUnrestrictedDouble(t){return Number(t)}function integerPart(t){var r;return 0===(r=g(t))?0:r}function convertUnsignedLongLongWithEnforceRange(t,r){var a;let n=Number.MAX_SAFE_INTEGER,o=Number(t);if(!y(o=0===(a=o)?0:a))throw TypeError(`${r} is not a finite number`);if((o=integerPart(o))<0||o>n)throw TypeError(`${r} is outside the accepted range of 0 to ${n}, inclusive`);return y(o)&&0!==o?o:0}function assertReadableStream(t,r){if(!IsReadableStream(t))throw TypeError(`${r} is not a ReadableStream.`)}function AcquireReadableStreamDefaultReader(t){return new ReadableStreamDefaultReader(t)}function ReadableStreamAddReadRequest(t,r){t._reader._readRequests.push(r)}function ReadableStreamFulfillReadRequest(t,r,a){let n=t._reader,o=n._readRequests.shift();a?o._closeSteps():o._chunkSteps(r)}function ReadableStreamGetNumReadRequests(t){return t._reader._readRequests.length}function ReadableStreamHasDefaultReader(t){let r=t._reader;return!!(void 0!==r&&IsReadableStreamDefaultReader(r))}let ReadableStreamDefaultReader=class ReadableStreamDefaultReader{constructor(t){if(assertRequiredArgument(t,1,"ReadableStreamDefaultReader"),assertReadableStream(t,"First parameter"),IsReadableStreamLocked(t))throw TypeError("This stream has already been locked for exclusive reading by another reader");ReadableStreamReaderGenericInitialize(this,t),this._readRequests=new SimpleQueue}get closed(){return IsReadableStreamDefaultReader(this)?this._closedPromise:l(defaultReaderBrandCheckException("closed"))}cancel(t){return IsReadableStreamDefaultReader(this)?void 0===this._ownerReadableStream?l(readerLockException("cancel")):ReadableStreamReaderGenericCancel(this,t):l(defaultReaderBrandCheckException("cancel"))}read(){let t,r;if(!IsReadableStreamDefaultReader(this))return l(defaultReaderBrandCheckException("read"));if(void 0===this._ownerReadableStream)return l(readerLockException("read from"));let a=newPromise((a,n)=>{t=a,r=n});return ReadableStreamDefaultReaderRead(this,{_chunkSteps:r=>t({value:r,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:t=>r(t)}),a}releaseLock(){if(!IsReadableStreamDefaultReader(this))throw defaultReaderBrandCheckException("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ReadableStreamReaderGenericRelease(this)}}};function IsReadableStreamDefaultReader(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_readRequests"))&&t instanceof ReadableStreamDefaultReader}function ReadableStreamDefaultReaderRead(t,r){let a=t._ownerReadableStream;a._disturbed=!0,"closed"===a._state?r._closeSteps():"errored"===a._state?r._errorSteps(a._storedError):a._readableStreamController[m](r)}function defaultReaderBrandCheckException(t){return TypeError(`ReadableStreamDefaultReader.prototype.${t} can only be used on a ReadableStreamDefaultReader`)}Object.defineProperties(ReadableStreamDefaultReader.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(ReadableStreamDefaultReader.prototype,r.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});let b=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);let ReadableStreamAsyncIteratorImpl=class ReadableStreamAsyncIteratorImpl{constructor(t,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=r}next(){let nextSteps=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?PerformPromiseThen(this._ongoingPromise,nextSteps,nextSteps):nextSteps(),this._ongoingPromise}return(t){let returnSteps=()=>this._returnSteps(t);return this._ongoingPromise?PerformPromiseThen(this._ongoingPromise,returnSteps,returnSteps):returnSteps()}_nextSteps(){let t,r;if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let a=this._reader;if(void 0===a._ownerReadableStream)return l(readerLockException("iterate"));let n=newPromise((a,n)=>{t=a,r=n});return ReadableStreamDefaultReaderRead(a,{_chunkSteps:r=>{this._ongoingPromise=void 0,u(()=>t({value:r,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ReadableStreamReaderGenericRelease(a),t({value:void 0,done:!0})},_errorSteps:t=>{this._ongoingPromise=void 0,this._isFinished=!0,ReadableStreamReaderGenericRelease(a),r(t)}}),n}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;let r=this._reader;if(void 0===r._ownerReadableStream)return l(readerLockException("finish iterating"));if(!this._preventCancel){let a=ReadableStreamReaderGenericCancel(r,t);return ReadableStreamReaderGenericRelease(r),PerformPromiseThen(a,()=>({value:t,done:!0}),void 0)}return ReadableStreamReaderGenericRelease(r),s({value:t,done:!0})}};let S={next(){return IsReadableStreamAsyncIterator(this)?this._asyncIteratorImpl.next():l(streamAsyncIteratorBrandCheckException("next"))},return(t){return IsReadableStreamAsyncIterator(this)?this._asyncIteratorImpl.return(t):l(streamAsyncIteratorBrandCheckException("return"))}};function AcquireReadableStreamAsyncIterator(t,r){let a=AcquireReadableStreamDefaultReader(t),n=new ReadableStreamAsyncIteratorImpl(a,r),o=Object.create(S);return o._asyncIteratorImpl=n,o}function IsReadableStreamAsyncIterator(t){if(!typeIsObject(t)||!Object.prototype.hasOwnProperty.call(t,"_asyncIteratorImpl"))return!1;try{return t._asyncIteratorImpl instanceof ReadableStreamAsyncIteratorImpl}catch(t){return!1}}function streamAsyncIteratorBrandCheckException(t){return TypeError(`ReadableStreamAsyncIterator.${t} can only be used on a ReadableSteamAsyncIterator`)}void 0!==b&&Object.setPrototypeOf(S,b);let v=Number.isNaN||function(t){return t!=t};function CreateArrayFromList(t){return t.slice()}function CopyDataBlockBytes(t,r,a,n,o){new Uint8Array(t).set(new Uint8Array(a,n,o),r)}function ArrayBufferSlice(t,r,a){if(t.slice)return t.slice(r,a);let n=a-r,o=new ArrayBuffer(n);return CopyDataBlockBytes(o,0,t,r,n),o}function IsNonNegativeNumber(t){return!("number"!=typeof t||v(t))&&!(t<0)}function CloneAsUint8Array(t){let r=ArrayBufferSlice(t.buffer,t.byteOffset,t.byteOffset+t.byteLength);return new Uint8Array(r)}function DequeueValue(t){let r=t._queue.shift();return t._queueTotalSize-=r.size,t._queueTotalSize<0&&(t._queueTotalSize=0),r.value}function EnqueueValueWithSize(t,r,a){if(!IsNonNegativeNumber(a)||a===1/0)throw RangeError("Size must be a finite, non-NaN, non-negative number.");t._queue.push({value:r,size:a}),t._queueTotalSize+=a}function PeekQueueValue(t){let r=t._queue.peek();return r.value}function ResetQueue(t){t._queue=new SimpleQueue,t._queueTotalSize=0}let ReadableStreamBYOBRequest=class ReadableStreamBYOBRequest{constructor(){throw TypeError("Illegal constructor")}get view(){if(!IsReadableStreamBYOBRequest(this))throw byobRequestBrandCheckException("view");return this._view}respond(t){if(!IsReadableStreamBYOBRequest(this))throw byobRequestBrandCheckException("respond");if(assertRequiredArgument(t,1,"respond"),t=convertUnsignedLongLongWithEnforceRange(t,"First parameter"),void 0===this._associatedReadableByteStreamController)throw TypeError("This BYOB request has been invalidated");this._view.buffer,ReadableByteStreamControllerRespond(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!IsReadableStreamBYOBRequest(this))throw byobRequestBrandCheckException("respondWithNewView");if(assertRequiredArgument(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw TypeError("This BYOB request has been invalidated");t.buffer,ReadableByteStreamControllerRespondWithNewView(this._associatedReadableByteStreamController,t)}};Object.defineProperties(ReadableStreamBYOBRequest.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(ReadableStreamBYOBRequest.prototype,r.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});let ReadableByteStreamController=class ReadableByteStreamController{constructor(){throw TypeError("Illegal constructor")}get byobRequest(){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("byobRequest");return ReadableByteStreamControllerGetBYOBRequest(this)}get desiredSize(){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("desiredSize");return ReadableByteStreamControllerGetDesiredSize(this)}close(){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("close");if(this._closeRequested)throw TypeError("The stream has already been closed; do not close it again!");let t=this._controlledReadableByteStream._state;if("readable"!==t)throw TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);ReadableByteStreamControllerClose(this)}enqueue(t){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("enqueue");if(assertRequiredArgument(t,1,"enqueue"),!ArrayBuffer.isView(t))throw TypeError("chunk must be an array buffer view");if(0===t.byteLength)throw TypeError("chunk must have non-zero byteLength");if(0===t.buffer.byteLength)throw TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw TypeError("stream is closed or draining");let r=this._controlledReadableByteStream._state;if("readable"!==r)throw TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);ReadableByteStreamControllerEnqueue(this,t)}error(t){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("error");ReadableByteStreamControllerError(this,t)}[h](t){ReadableByteStreamControllerClearPendingPullIntos(this),ResetQueue(this);let r=this._cancelAlgorithm(t);return ReadableByteStreamControllerClearAlgorithms(this),r}[m](t){let r=this._controlledReadableByteStream;if(this._queueTotalSize>0){let r=this._queue.shift();this._queueTotalSize-=r.byteLength,ReadableByteStreamControllerHandleQueueDrain(this);let a=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);t._chunkSteps(a);return}let a=this._autoAllocateChunkSize;if(void 0!==a){let r;try{r=new ArrayBuffer(a)}catch(r){t._errorSteps(r);return}let n={buffer:r,bufferByteLength:a,byteOffset:0,byteLength:a,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(n)}ReadableStreamAddReadRequest(r,t),ReadableByteStreamControllerCallPullIfNeeded(this)}};function IsReadableByteStreamController(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_controlledReadableByteStream"))&&t instanceof ReadableByteStreamController}function IsReadableStreamBYOBRequest(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_associatedReadableByteStreamController"))&&t instanceof ReadableStreamBYOBRequest}function ReadableByteStreamControllerCallPullIfNeeded(t){let r=ReadableByteStreamControllerShouldCallPull(t);if(!r)return;if(t._pulling){t._pullAgain=!0;return}t._pulling=!0;let a=t._pullAlgorithm();uponPromise(a,()=>{t._pulling=!1,t._pullAgain&&(t._pullAgain=!1,ReadableByteStreamControllerCallPullIfNeeded(t))},r=>{ReadableByteStreamControllerError(t,r)})}function ReadableByteStreamControllerClearPendingPullIntos(t){ReadableByteStreamControllerInvalidateBYOBRequest(t),t._pendingPullIntos=new SimpleQueue}function ReadableByteStreamControllerCommitPullIntoDescriptor(t,r){let a=!1;"closed"===t._state&&(a=!0);let n=ReadableByteStreamControllerConvertPullIntoDescriptor(r);"default"===r.readerType?ReadableStreamFulfillReadRequest(t,n,a):ReadableStreamFulfillReadIntoRequest(t,n,a)}function ReadableByteStreamControllerConvertPullIntoDescriptor(t){let r=t.bytesFilled,a=t.elementSize;return new t.viewConstructor(t.buffer,t.byteOffset,r/a)}function ReadableByteStreamControllerEnqueueChunkToQueue(t,r,a,n){t._queue.push({buffer:r,byteOffset:a,byteLength:n}),t._queueTotalSize+=n}function ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(t,r){let a=r.elementSize,n=r.bytesFilled-r.bytesFilled%a,o=Math.min(t._queueTotalSize,r.byteLength-r.bytesFilled),i=r.bytesFilled+o,s=i-i%a,l=o,u=!1;s>n&&(l=s-r.bytesFilled,u=!0);let c=t._queue;for(;l>0;){let a=c.peek(),n=Math.min(l,a.byteLength),o=r.byteOffset+r.bytesFilled;CopyDataBlockBytes(r.buffer,o,a.buffer,a.byteOffset,n),a.byteLength===n?c.shift():(a.byteOffset+=n,a.byteLength-=n),t._queueTotalSize-=n,ReadableByteStreamControllerFillHeadPullIntoDescriptor(t,n,r),l-=n}return u}function ReadableByteStreamControllerFillHeadPullIntoDescriptor(t,r,a){a.bytesFilled+=r}function ReadableByteStreamControllerHandleQueueDrain(t){0===t._queueTotalSize&&t._closeRequested?(ReadableByteStreamControllerClearAlgorithms(t),ReadableStreamClose(t._controlledReadableByteStream)):ReadableByteStreamControllerCallPullIfNeeded(t)}function ReadableByteStreamControllerInvalidateBYOBRequest(t){null!==t._byobRequest&&(t._byobRequest._associatedReadableByteStreamController=void 0,t._byobRequest._view=null,t._byobRequest=null)}function ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(t){for(;t._pendingPullIntos.length>0;){if(0===t._queueTotalSize)return;let r=t._pendingPullIntos.peek();ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(t,r)&&(ReadableByteStreamControllerShiftPendingPullInto(t),ReadableByteStreamControllerCommitPullIntoDescriptor(t._controlledReadableByteStream,r))}}function ReadableByteStreamControllerPullInto(t,r,a){let n=t._controlledReadableByteStream,o=1;r.constructor!==DataView&&(o=r.constructor.BYTES_PER_ELEMENT);let i=r.constructor,s=r.buffer,l={buffer:s,bufferByteLength:s.byteLength,byteOffset:r.byteOffset,byteLength:r.byteLength,bytesFilled:0,elementSize:o,viewConstructor:i,readerType:"byob"};if(t._pendingPullIntos.length>0){t._pendingPullIntos.push(l),ReadableStreamAddReadIntoRequest(n,a);return}if("closed"===n._state){let t=new i(l.buffer,l.byteOffset,0);a._closeSteps(t);return}if(t._queueTotalSize>0){if(ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(t,l)){let r=ReadableByteStreamControllerConvertPullIntoDescriptor(l);ReadableByteStreamControllerHandleQueueDrain(t),a._chunkSteps(r);return}if(t._closeRequested){let r=TypeError("Insufficient bytes to fill elements in the given buffer");ReadableByteStreamControllerError(t,r),a._errorSteps(r);return}}t._pendingPullIntos.push(l),ReadableStreamAddReadIntoRequest(n,a),ReadableByteStreamControllerCallPullIfNeeded(t)}function ReadableByteStreamControllerRespondInClosedState(t,r){let a=t._controlledReadableByteStream;if(ReadableStreamHasBYOBReader(a))for(;ReadableStreamGetNumReadIntoRequests(a)>0;){let r=ReadableByteStreamControllerShiftPendingPullInto(t);ReadableByteStreamControllerCommitPullIntoDescriptor(a,r)}}function ReadableByteStreamControllerRespondInReadableState(t,r,a){if(ReadableByteStreamControllerFillHeadPullIntoDescriptor(t,r,a),a.bytesFilled<a.elementSize)return;ReadableByteStreamControllerShiftPendingPullInto(t);let n=a.bytesFilled%a.elementSize;if(n>0){let r=a.byteOffset+a.bytesFilled,o=ArrayBufferSlice(a.buffer,r-n,r);ReadableByteStreamControllerEnqueueChunkToQueue(t,o,0,o.byteLength)}a.bytesFilled-=n,ReadableByteStreamControllerCommitPullIntoDescriptor(t._controlledReadableByteStream,a),ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(t)}function ReadableByteStreamControllerRespondInternal(t,r){let a=t._pendingPullIntos.peek();ReadableByteStreamControllerInvalidateBYOBRequest(t);let n=t._controlledReadableByteStream._state;"closed"===n?ReadableByteStreamControllerRespondInClosedState(t):ReadableByteStreamControllerRespondInReadableState(t,r,a),ReadableByteStreamControllerCallPullIfNeeded(t)}function ReadableByteStreamControllerShiftPendingPullInto(t){let r=t._pendingPullIntos.shift();return r}function ReadableByteStreamControllerShouldCallPull(t){let r=t._controlledReadableByteStream;if("readable"!==r._state||t._closeRequested||!t._started)return!1;if(ReadableStreamHasDefaultReader(r)&&ReadableStreamGetNumReadRequests(r)>0||ReadableStreamHasBYOBReader(r)&&ReadableStreamGetNumReadIntoRequests(r)>0)return!0;let a=ReadableByteStreamControllerGetDesiredSize(t);return a>0}function ReadableByteStreamControllerClearAlgorithms(t){t._pullAlgorithm=void 0,t._cancelAlgorithm=void 0}function ReadableByteStreamControllerClose(t){let r=t._controlledReadableByteStream;if(!t._closeRequested&&"readable"===r._state){if(t._queueTotalSize>0){t._closeRequested=!0;return}if(t._pendingPullIntos.length>0){let r=t._pendingPullIntos.peek();if(r.bytesFilled>0){let r=TypeError("Insufficient bytes to fill elements in the given buffer");throw ReadableByteStreamControllerError(t,r),r}}ReadableByteStreamControllerClearAlgorithms(t),ReadableStreamClose(r)}}function ReadableByteStreamControllerEnqueue(t,r){let a=t._controlledReadableByteStream;if(t._closeRequested||"readable"!==a._state)return;let n=r.buffer,o=r.byteOffset,i=r.byteLength;if(t._pendingPullIntos.length>0){let r=t._pendingPullIntos.peek();r.buffer,r.buffer=r.buffer}if(ReadableByteStreamControllerInvalidateBYOBRequest(t),ReadableStreamHasDefaultReader(a)){if(0===ReadableStreamGetNumReadRequests(a))ReadableByteStreamControllerEnqueueChunkToQueue(t,n,o,i);else{t._pendingPullIntos.length>0&&ReadableByteStreamControllerShiftPendingPullInto(t);let r=new Uint8Array(n,o,i);ReadableStreamFulfillReadRequest(a,r,!1)}}else ReadableStreamHasBYOBReader(a)?(ReadableByteStreamControllerEnqueueChunkToQueue(t,n,o,i),ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(t)):ReadableByteStreamControllerEnqueueChunkToQueue(t,n,o,i);ReadableByteStreamControllerCallPullIfNeeded(t)}function ReadableByteStreamControllerError(t,r){let a=t._controlledReadableByteStream;"readable"===a._state&&(ReadableByteStreamControllerClearPendingPullIntos(t),ResetQueue(t),ReadableByteStreamControllerClearAlgorithms(t),ReadableStreamError(a,r))}function ReadableByteStreamControllerGetBYOBRequest(t){if(null===t._byobRequest&&t._pendingPullIntos.length>0){let r=t._pendingPullIntos.peek(),a=new Uint8Array(r.buffer,r.byteOffset+r.bytesFilled,r.byteLength-r.bytesFilled),n=Object.create(ReadableStreamBYOBRequest.prototype);SetUpReadableStreamBYOBRequest(n,t,a),t._byobRequest=n}return t._byobRequest}function ReadableByteStreamControllerGetDesiredSize(t){let r=t._controlledReadableByteStream._state;return"errored"===r?null:"closed"===r?0:t._strategyHWM-t._queueTotalSize}function ReadableByteStreamControllerRespond(t,r){let a=t._pendingPullIntos.peek(),n=t._controlledReadableByteStream._state;if("closed"===n){if(0!==r)throw TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===r)throw TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(a.bytesFilled+r>a.byteLength)throw RangeError("bytesWritten out of range")}a.buffer=a.buffer,ReadableByteStreamControllerRespondInternal(t,r)}function ReadableByteStreamControllerRespondWithNewView(t,r){let a=t._pendingPullIntos.peek(),n=t._controlledReadableByteStream._state;if("closed"===n){if(0!==r.byteLength)throw TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===r.byteLength)throw TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(a.byteOffset+a.bytesFilled!==r.byteOffset)throw RangeError("The region specified by view does not match byobRequest");if(a.bufferByteLength!==r.buffer.byteLength)throw RangeError("The buffer of view has different capacity than byobRequest");if(a.bytesFilled+r.byteLength>a.byteLength)throw RangeError("The region specified by view is larger than byobRequest");let o=r.byteLength;a.buffer=r.buffer,ReadableByteStreamControllerRespondInternal(t,o)}function SetUpReadableByteStreamController(t,r,a,n,o,i,l){r._controlledReadableByteStream=t,r._pullAgain=!1,r._pulling=!1,r._byobRequest=null,r._queue=r._queueTotalSize=void 0,ResetQueue(r),r._closeRequested=!1,r._started=!1,r._strategyHWM=i,r._pullAlgorithm=n,r._cancelAlgorithm=o,r._autoAllocateChunkSize=l,r._pendingPullIntos=new SimpleQueue,t._readableStreamController=r;let u=a();uponPromise(s(u),()=>{r._started=!0,ReadableByteStreamControllerCallPullIfNeeded(r)},t=>{ReadableByteStreamControllerError(r,t)})}function SetUpReadableByteStreamControllerFromUnderlyingSource(t,r,a){let n=Object.create(ReadableByteStreamController.prototype),startAlgorithm=()=>void 0,pullAlgorithm=()=>s(void 0),cancelAlgorithm=()=>s(void 0);void 0!==r.start&&(startAlgorithm=()=>r.start(n)),void 0!==r.pull&&(pullAlgorithm=()=>r.pull(n)),void 0!==r.cancel&&(cancelAlgorithm=t=>r.cancel(t));let o=r.autoAllocateChunkSize;if(0===o)throw TypeError("autoAllocateChunkSize must be greater than 0");SetUpReadableByteStreamController(t,n,startAlgorithm,pullAlgorithm,cancelAlgorithm,a,o)}function SetUpReadableStreamBYOBRequest(t,r,a){t._associatedReadableByteStreamController=r,t._view=a}function byobRequestBrandCheckException(t){return TypeError(`ReadableStreamBYOBRequest.prototype.${t} can only be used on a ReadableStreamBYOBRequest`)}function byteStreamControllerBrandCheckException(t){return TypeError(`ReadableByteStreamController.prototype.${t} can only be used on a ReadableByteStreamController`)}function ReadableStreamAddReadIntoRequest(t,r){t._reader._readIntoRequests.push(r)}function ReadableStreamFulfillReadIntoRequest(t,r,a){let n=t._reader,o=n._readIntoRequests.shift();a?o._closeSteps(r):o._chunkSteps(r)}function ReadableStreamGetNumReadIntoRequests(t){return t._reader._readIntoRequests.length}function ReadableStreamHasBYOBReader(t){let r=t._reader;return!!(void 0!==r&&IsReadableStreamBYOBReader(r))}Object.defineProperties(ReadableByteStreamController.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(ReadableByteStreamController.prototype,r.toStringTag,{value:"ReadableByteStreamController",configurable:!0});let ReadableStreamBYOBReader=class ReadableStreamBYOBReader{constructor(t){if(assertRequiredArgument(t,1,"ReadableStreamBYOBReader"),assertReadableStream(t,"First parameter"),IsReadableStreamLocked(t))throw TypeError("This stream has already been locked for exclusive reading by another reader");if(!IsReadableByteStreamController(t._readableStreamController))throw TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");ReadableStreamReaderGenericInitialize(this,t),this._readIntoRequests=new SimpleQueue}get closed(){return IsReadableStreamBYOBReader(this)?this._closedPromise:l(byobReaderBrandCheckException("closed"))}cancel(t){return IsReadableStreamBYOBReader(this)?void 0===this._ownerReadableStream?l(readerLockException("cancel")):ReadableStreamReaderGenericCancel(this,t):l(byobReaderBrandCheckException("cancel"))}read(t){let r,a;if(!IsReadableStreamBYOBReader(this))return l(byobReaderBrandCheckException("read"));if(!ArrayBuffer.isView(t))return l(TypeError("view must be an array buffer view"));if(0===t.byteLength)return l(TypeError("view must have non-zero byteLength"));if(0===t.buffer.byteLength)return l(TypeError("view's buffer must have non-zero byteLength"));if(t.buffer,void 0===this._ownerReadableStream)return l(readerLockException("read from"));let n=newPromise((t,n)=>{r=t,a=n});return ReadableStreamBYOBReaderRead(this,t,{_chunkSteps:t=>r({value:t,done:!1}),_closeSteps:t=>r({value:t,done:!0}),_errorSteps:t=>a(t)}),n}releaseLock(){if(!IsReadableStreamBYOBReader(this))throw byobReaderBrandCheckException("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ReadableStreamReaderGenericRelease(this)}}};function IsReadableStreamBYOBReader(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_readIntoRequests"))&&t instanceof ReadableStreamBYOBReader}function ReadableStreamBYOBReaderRead(t,r,a){let n=t._ownerReadableStream;n._disturbed=!0,"errored"===n._state?a._errorSteps(n._storedError):ReadableByteStreamControllerPullInto(n._readableStreamController,r,a)}function byobReaderBrandCheckException(t){return TypeError(`ReadableStreamBYOBReader.prototype.${t} can only be used on a ReadableStreamBYOBReader`)}function ExtractHighWaterMark(t,r){let{highWaterMark:a}=t;if(void 0===a)return r;if(v(a)||a<0)throw RangeError("Invalid highWaterMark");return a}function ExtractSizeAlgorithm(t){let{size:r}=t;return r||(()=>1)}function convertQueuingStrategy(t,r){assertDictionary(t,r);let a=null==t?void 0:t.highWaterMark,n=null==t?void 0:t.size;return{highWaterMark:void 0===a?void 0:convertUnrestrictedDouble(a),size:void 0===n?void 0:convertQueuingStrategySize(n,`${r} has member 'size' that`)}}function convertQueuingStrategySize(t,r){return assertFunction(t,r),r=>convertUnrestrictedDouble(t(r))}function convertUnderlyingSink(t,r){assertDictionary(t,r);let a=null==t?void 0:t.abort,n=null==t?void 0:t.close,o=null==t?void 0:t.start,i=null==t?void 0:t.type,s=null==t?void 0:t.write;return{abort:void 0===a?void 0:convertUnderlyingSinkAbortCallback(a,t,`${r} has member 'abort' that`),close:void 0===n?void 0:convertUnderlyingSinkCloseCallback(n,t,`${r} has member 'close' that`),start:void 0===o?void 0:convertUnderlyingSinkStartCallback(o,t,`${r} has member 'start' that`),write:void 0===s?void 0:convertUnderlyingSinkWriteCallback(s,t,`${r} has member 'write' that`),type:i}}function convertUnderlyingSinkAbortCallback(t,r,a){return assertFunction(t,a),a=>promiseCall(t,r,[a])}function convertUnderlyingSinkCloseCallback(t,r,a){return assertFunction(t,a),()=>promiseCall(t,r,[])}function convertUnderlyingSinkStartCallback(t,r,a){return assertFunction(t,a),a=>reflectCall(t,r,[a])}function convertUnderlyingSinkWriteCallback(t,r,a){return assertFunction(t,a),(a,n)=>promiseCall(t,r,[a,n])}function assertWritableStream(t,r){if(!IsWritableStream(t))throw TypeError(`${r} is not a WritableStream.`)}function isAbortSignal(t){if("object"!=typeof t||null===t)return!1;try{return"boolean"==typeof t.aborted}catch(t){return!1}}Object.defineProperties(ReadableStreamBYOBReader.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(ReadableStreamBYOBReader.prototype,r.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});let C="function"==typeof AbortController;function createAbortController(){if(C)return new AbortController}let WritableStream=class WritableStream{constructor(t={},r={}){void 0===t?t=null:assertObject(t,"First parameter");let a=convertQueuingStrategy(r,"Second parameter"),n=convertUnderlyingSink(t,"First parameter");InitializeWritableStream(this);let o=n.type;if(void 0!==o)throw RangeError("Invalid type is specified");let i=ExtractSizeAlgorithm(a),s=ExtractHighWaterMark(a,1);SetUpWritableStreamDefaultControllerFromUnderlyingSink(this,n,s,i)}get locked(){if(!IsWritableStream(this))throw streamBrandCheckException$2("locked");return IsWritableStreamLocked(this)}abort(t){return IsWritableStream(this)?IsWritableStreamLocked(this)?l(TypeError("Cannot abort a stream that already has a writer")):WritableStreamAbort(this,t):l(streamBrandCheckException$2("abort"))}close(){return IsWritableStream(this)?IsWritableStreamLocked(this)?l(TypeError("Cannot close a stream that already has a writer")):WritableStreamCloseQueuedOrInFlight(this)?l(TypeError("Cannot close an already-closing stream")):WritableStreamClose(this):l(streamBrandCheckException$2("close"))}getWriter(){if(!IsWritableStream(this))throw streamBrandCheckException$2("getWriter");return new WritableStreamDefaultWriter(this)}};function CreateWritableStream(t,r,a,n,o=1,i=()=>1){let s=Object.create(WritableStream.prototype);InitializeWritableStream(s);let l=Object.create(WritableStreamDefaultController.prototype);return SetUpWritableStreamDefaultController(s,l,t,r,a,n,o,i),s}function InitializeWritableStream(t){t._state="writable",t._storedError=void 0,t._writer=void 0,t._writableStreamController=void 0,t._writeRequests=new SimpleQueue,t._inFlightWriteRequest=void 0,t._closeRequest=void 0,t._inFlightCloseRequest=void 0,t._pendingAbortRequest=void 0,t._backpressure=!1}function IsWritableStream(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_writableStreamController"))&&t instanceof WritableStream}function IsWritableStreamLocked(t){return void 0!==t._writer}function WritableStreamAbort(t,r){var a;if("closed"===t._state||"errored"===t._state)return s(void 0);t._writableStreamController._abortReason=r,null===(a=t._writableStreamController._abortController)||void 0===a||a.abort();let n=t._state;if("closed"===n||"errored"===n)return s(void 0);if(void 0!==t._pendingAbortRequest)return t._pendingAbortRequest._promise;let o=!1;"erroring"===n&&(o=!0,r=void 0);let i=newPromise((a,n)=>{t._pendingAbortRequest={_promise:void 0,_resolve:a,_reject:n,_reason:r,_wasAlreadyErroring:o}});return t._pendingAbortRequest._promise=i,o||WritableStreamStartErroring(t,r),i}function WritableStreamClose(t){let r=t._state;if("closed"===r||"errored"===r)return l(TypeError(`The stream (in ${r} state) is not in the writable state and cannot be closed`));let a=newPromise((r,a)=>{t._closeRequest={_resolve:r,_reject:a}}),n=t._writer;return void 0!==n&&t._backpressure&&"writable"===r&&defaultWriterReadyPromiseResolve(n),WritableStreamDefaultControllerClose(t._writableStreamController),a}function WritableStreamAddWriteRequest(t){let r=newPromise((r,a)=>{t._writeRequests.push({_resolve:r,_reject:a})});return r}function WritableStreamDealWithRejection(t,r){let a=t._state;if("writable"===a){WritableStreamStartErroring(t,r);return}WritableStreamFinishErroring(t)}function WritableStreamStartErroring(t,r){let a=t._writableStreamController;t._state="erroring",t._storedError=r;let n=t._writer;void 0!==n&&WritableStreamDefaultWriterEnsureReadyPromiseRejected(n,r),!WritableStreamHasOperationMarkedInFlight(t)&&a._started&&WritableStreamFinishErroring(t)}function WritableStreamFinishErroring(t){t._state="errored",t._writableStreamController[d]();let r=t._storedError;if(t._writeRequests.forEach(t=>{t._reject(r)}),t._writeRequests=new SimpleQueue,void 0===t._pendingAbortRequest){WritableStreamRejectCloseAndClosedPromiseIfNeeded(t);return}let a=t._pendingAbortRequest;if(t._pendingAbortRequest=void 0,a._wasAlreadyErroring){a._reject(r),WritableStreamRejectCloseAndClosedPromiseIfNeeded(t);return}let n=t._writableStreamController[c](a._reason);uponPromise(n,()=>{a._resolve(),WritableStreamRejectCloseAndClosedPromiseIfNeeded(t)},r=>{a._reject(r),WritableStreamRejectCloseAndClosedPromiseIfNeeded(t)})}function WritableStreamFinishInFlightWrite(t){t._inFlightWriteRequest._resolve(void 0),t._inFlightWriteRequest=void 0}function WritableStreamFinishInFlightWriteWithError(t,r){t._inFlightWriteRequest._reject(r),t._inFlightWriteRequest=void 0,WritableStreamDealWithRejection(t,r)}function WritableStreamFinishInFlightClose(t){t._inFlightCloseRequest._resolve(void 0),t._inFlightCloseRequest=void 0;let r=t._state;"erroring"===r&&(t._storedError=void 0,void 0!==t._pendingAbortRequest&&(t._pendingAbortRequest._resolve(),t._pendingAbortRequest=void 0)),t._state="closed";let a=t._writer;void 0!==a&&defaultWriterClosedPromiseResolve(a)}function WritableStreamFinishInFlightCloseWithError(t,r){t._inFlightCloseRequest._reject(r),t._inFlightCloseRequest=void 0,void 0!==t._pendingAbortRequest&&(t._pendingAbortRequest._reject(r),t._pendingAbortRequest=void 0),WritableStreamDealWithRejection(t,r)}function WritableStreamCloseQueuedOrInFlight(t){return void 0!==t._closeRequest||void 0!==t._inFlightCloseRequest}function WritableStreamHasOperationMarkedInFlight(t){return void 0!==t._inFlightWriteRequest||void 0!==t._inFlightCloseRequest}function WritableStreamMarkCloseRequestInFlight(t){t._inFlightCloseRequest=t._closeRequest,t._closeRequest=void 0}function WritableStreamMarkFirstWriteRequestInFlight(t){t._inFlightWriteRequest=t._writeRequests.shift()}function WritableStreamRejectCloseAndClosedPromiseIfNeeded(t){void 0!==t._closeRequest&&(t._closeRequest._reject(t._storedError),t._closeRequest=void 0);let r=t._writer;void 0!==r&&defaultWriterClosedPromiseReject(r,t._storedError)}function WritableStreamUpdateBackpressure(t,r){let a=t._writer;void 0!==a&&r!==t._backpressure&&(r?defaultWriterReadyPromiseReset(a):defaultWriterReadyPromiseResolve(a)),t._backpressure=r}Object.defineProperties(WritableStream.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(WritableStream.prototype,r.toStringTag,{value:"WritableStream",configurable:!0});let WritableStreamDefaultWriter=class WritableStreamDefaultWriter{constructor(t){if(assertRequiredArgument(t,1,"WritableStreamDefaultWriter"),assertWritableStream(t,"First parameter"),IsWritableStreamLocked(t))throw TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;let r=t._state;if("writable"===r)!WritableStreamCloseQueuedOrInFlight(t)&&t._backpressure?defaultWriterReadyPromiseInitialize(this):(defaultWriterReadyPromiseInitialize(this),defaultWriterReadyPromiseResolve(this)),defaultWriterClosedPromiseInitialize(this);else if("erroring"===r)defaultWriterReadyPromiseInitializeAsRejected(this,t._storedError),defaultWriterClosedPromiseInitialize(this);else if("closed"===r)defaultWriterReadyPromiseInitialize(this),defaultWriterReadyPromiseResolve(this),defaultWriterClosedPromiseInitializeAsResolved(this);else{let r=t._storedError;defaultWriterReadyPromiseInitializeAsRejected(this,r),defaultWriterClosedPromiseInitialize(this),defaultWriterClosedPromiseReject(this,r)}}get closed(){return IsWritableStreamDefaultWriter(this)?this._closedPromise:l(defaultWriterBrandCheckException("closed"))}get desiredSize(){if(!IsWritableStreamDefaultWriter(this))throw defaultWriterBrandCheckException("desiredSize");if(void 0===this._ownerWritableStream)throw defaultWriterLockException("desiredSize");return WritableStreamDefaultWriterGetDesiredSize(this)}get ready(){return IsWritableStreamDefaultWriter(this)?this._readyPromise:l(defaultWriterBrandCheckException("ready"))}abort(t){return IsWritableStreamDefaultWriter(this)?void 0===this._ownerWritableStream?l(defaultWriterLockException("abort")):WritableStreamDefaultWriterAbort(this,t):l(defaultWriterBrandCheckException("abort"))}close(){if(!IsWritableStreamDefaultWriter(this))return l(defaultWriterBrandCheckException("close"));let t=this._ownerWritableStream;return void 0===t?l(defaultWriterLockException("close")):WritableStreamCloseQueuedOrInFlight(t)?l(TypeError("Cannot close an already-closing stream")):WritableStreamDefaultWriterClose(this)}releaseLock(){if(!IsWritableStreamDefaultWriter(this))throw defaultWriterBrandCheckException("releaseLock");let t=this._ownerWritableStream;void 0!==t&&WritableStreamDefaultWriterRelease(this)}write(t){return IsWritableStreamDefaultWriter(this)?void 0===this._ownerWritableStream?l(defaultWriterLockException("write to")):WritableStreamDefaultWriterWrite(this,t):l(defaultWriterBrandCheckException("write"))}};function IsWritableStreamDefaultWriter(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_ownerWritableStream"))&&t instanceof WritableStreamDefaultWriter}function WritableStreamDefaultWriterAbort(t,r){let a=t._ownerWritableStream;return WritableStreamAbort(a,r)}function WritableStreamDefaultWriterClose(t){let r=t._ownerWritableStream;return WritableStreamClose(r)}function WritableStreamDefaultWriterCloseWithErrorPropagation(t){let r=t._ownerWritableStream,a=r._state;return WritableStreamCloseQueuedOrInFlight(r)||"closed"===a?s(void 0):"errored"===a?l(r._storedError):WritableStreamDefaultWriterClose(t)}function WritableStreamDefaultWriterEnsureClosedPromiseRejected(t,r){"pending"===t._closedPromiseState?defaultWriterClosedPromiseReject(t,r):defaultWriterClosedPromiseResetToRejected(t,r)}function WritableStreamDefaultWriterEnsureReadyPromiseRejected(t,r){"pending"===t._readyPromiseState?defaultWriterReadyPromiseReject(t,r):defaultWriterReadyPromiseResetToRejected(t,r)}function WritableStreamDefaultWriterGetDesiredSize(t){let r=t._ownerWritableStream,a=r._state;return"errored"===a||"erroring"===a?null:"closed"===a?0:WritableStreamDefaultControllerGetDesiredSize(r._writableStreamController)}function WritableStreamDefaultWriterRelease(t){let r=t._ownerWritableStream,a=TypeError("Writer was released and can no longer be used to monitor the stream's closedness");WritableStreamDefaultWriterEnsureReadyPromiseRejected(t,a),WritableStreamDefaultWriterEnsureClosedPromiseRejected(t,a),r._writer=void 0,t._ownerWritableStream=void 0}function WritableStreamDefaultWriterWrite(t,r){let a=t._ownerWritableStream,n=a._writableStreamController,o=WritableStreamDefaultControllerGetChunkSize(n,r);if(a!==t._ownerWritableStream)return l(defaultWriterLockException("write to"));let i=a._state;if("errored"===i)return l(a._storedError);if(WritableStreamCloseQueuedOrInFlight(a)||"closed"===i)return l(TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===i)return l(a._storedError);let s=WritableStreamAddWriteRequest(a);return WritableStreamDefaultControllerWrite(n,r,o),s}Object.defineProperties(WritableStreamDefaultWriter.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(WritableStreamDefaultWriter.prototype,r.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});let w={};let WritableStreamDefaultController=class WritableStreamDefaultController{constructor(){throw TypeError("Illegal constructor")}get abortReason(){if(!IsWritableStreamDefaultController(this))throw defaultControllerBrandCheckException$2("abortReason");return this._abortReason}get signal(){if(!IsWritableStreamDefaultController(this))throw defaultControllerBrandCheckException$2("signal");if(void 0===this._abortController)throw TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t){if(!IsWritableStreamDefaultController(this))throw defaultControllerBrandCheckException$2("error");let r=this._controlledWritableStream._state;"writable"===r&&WritableStreamDefaultControllerError(this,t)}[c](t){let r=this._abortAlgorithm(t);return WritableStreamDefaultControllerClearAlgorithms(this),r}[d](){ResetQueue(this)}};function IsWritableStreamDefaultController(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_controlledWritableStream"))&&t instanceof WritableStreamDefaultController}function SetUpWritableStreamDefaultController(t,r,a,n,o,i,l,u){r._controlledWritableStream=t,t._writableStreamController=r,r._queue=void 0,r._queueTotalSize=void 0,ResetQueue(r),r._abortReason=void 0,r._abortController=createAbortController(),r._started=!1,r._strategySizeAlgorithm=u,r._strategyHWM=l,r._writeAlgorithm=n,r._closeAlgorithm=o,r._abortAlgorithm=i;let c=WritableStreamDefaultControllerGetBackpressure(r);WritableStreamUpdateBackpressure(t,c);let d=a(),h=s(d);uponPromise(h,()=>{r._started=!0,WritableStreamDefaultControllerAdvanceQueueIfNeeded(r)},a=>{r._started=!0,WritableStreamDealWithRejection(t,a)})}function SetUpWritableStreamDefaultControllerFromUnderlyingSink(t,r,a,n){let o=Object.create(WritableStreamDefaultController.prototype),startAlgorithm=()=>void 0,writeAlgorithm=()=>s(void 0),closeAlgorithm=()=>s(void 0),abortAlgorithm=()=>s(void 0);void 0!==r.start&&(startAlgorithm=()=>r.start(o)),void 0!==r.write&&(writeAlgorithm=t=>r.write(t,o)),void 0!==r.close&&(closeAlgorithm=()=>r.close()),void 0!==r.abort&&(abortAlgorithm=t=>r.abort(t)),SetUpWritableStreamDefaultController(t,o,startAlgorithm,writeAlgorithm,closeAlgorithm,abortAlgorithm,a,n)}function WritableStreamDefaultControllerClearAlgorithms(t){t._writeAlgorithm=void 0,t._closeAlgorithm=void 0,t._abortAlgorithm=void 0,t._strategySizeAlgorithm=void 0}function WritableStreamDefaultControllerClose(t){EnqueueValueWithSize(t,w,0),WritableStreamDefaultControllerAdvanceQueueIfNeeded(t)}function WritableStreamDefaultControllerGetChunkSize(t,r){try{return t._strategySizeAlgorithm(r)}catch(r){return WritableStreamDefaultControllerErrorIfNeeded(t,r),1}}function WritableStreamDefaultControllerGetDesiredSize(t){return t._strategyHWM-t._queueTotalSize}function WritableStreamDefaultControllerWrite(t,r,a){try{EnqueueValueWithSize(t,r,a)}catch(r){WritableStreamDefaultControllerErrorIfNeeded(t,r);return}let n=t._controlledWritableStream;if(!WritableStreamCloseQueuedOrInFlight(n)&&"writable"===n._state){let r=WritableStreamDefaultControllerGetBackpressure(t);WritableStreamUpdateBackpressure(n,r)}WritableStreamDefaultControllerAdvanceQueueIfNeeded(t)}function WritableStreamDefaultControllerAdvanceQueueIfNeeded(t){let r=t._controlledWritableStream;if(!t._started||void 0!==r._inFlightWriteRequest)return;let a=r._state;if("erroring"===a){WritableStreamFinishErroring(r);return}if(0===t._queue.length)return;let n=PeekQueueValue(t);n===w?WritableStreamDefaultControllerProcessClose(t):WritableStreamDefaultControllerProcessWrite(t,n)}function WritableStreamDefaultControllerErrorIfNeeded(t,r){"writable"===t._controlledWritableStream._state&&WritableStreamDefaultControllerError(t,r)}function WritableStreamDefaultControllerProcessClose(t){let r=t._controlledWritableStream;WritableStreamMarkCloseRequestInFlight(r),DequeueValue(t);let a=t._closeAlgorithm();WritableStreamDefaultControllerClearAlgorithms(t),uponPromise(a,()=>{WritableStreamFinishInFlightClose(r)},t=>{WritableStreamFinishInFlightCloseWithError(r,t)})}function WritableStreamDefaultControllerProcessWrite(t,r){let a=t._controlledWritableStream;WritableStreamMarkFirstWriteRequestInFlight(a);let n=t._writeAlgorithm(r);uponPromise(n,()=>{WritableStreamFinishInFlightWrite(a);let r=a._state;if(DequeueValue(t),!WritableStreamCloseQueuedOrInFlight(a)&&"writable"===r){let r=WritableStreamDefaultControllerGetBackpressure(t);WritableStreamUpdateBackpressure(a,r)}WritableStreamDefaultControllerAdvanceQueueIfNeeded(t)},r=>{"writable"===a._state&&WritableStreamDefaultControllerClearAlgorithms(t),WritableStreamFinishInFlightWriteWithError(a,r)})}function WritableStreamDefaultControllerGetBackpressure(t){let r=WritableStreamDefaultControllerGetDesiredSize(t);return r<=0}function WritableStreamDefaultControllerError(t,r){let a=t._controlledWritableStream;WritableStreamDefaultControllerClearAlgorithms(t),WritableStreamStartErroring(a,r)}function streamBrandCheckException$2(t){return TypeError(`WritableStream.prototype.${t} can only be used on a WritableStream`)}function defaultControllerBrandCheckException$2(t){return TypeError(`WritableStreamDefaultController.prototype.${t} can only be used on a WritableStreamDefaultController`)}function defaultWriterBrandCheckException(t){return TypeError(`WritableStreamDefaultWriter.prototype.${t} can only be used on a WritableStreamDefaultWriter`)}function defaultWriterLockException(t){return TypeError("Cannot "+t+" a stream using a released writer")}function defaultWriterClosedPromiseInitialize(t){t._closedPromise=newPromise((r,a)=>{t._closedPromise_resolve=r,t._closedPromise_reject=a,t._closedPromiseState="pending"})}function defaultWriterClosedPromiseInitializeAsResolved(t){defaultWriterClosedPromiseInitialize(t),defaultWriterClosedPromiseResolve(t)}function defaultWriterClosedPromiseReject(t,r){void 0!==t._closedPromise_reject&&(setPromiseIsHandledToTrue(t._closedPromise),t._closedPromise_reject(r),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="rejected")}function defaultWriterClosedPromiseResetToRejected(t,r){defaultWriterClosedPromiseInitialize(t),defaultWriterClosedPromiseReject(t,r)}function defaultWriterClosedPromiseResolve(t){void 0!==t._closedPromise_resolve&&(t._closedPromise_resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="resolved")}function defaultWriterReadyPromiseInitialize(t){t._readyPromise=newPromise((r,a)=>{t._readyPromise_resolve=r,t._readyPromise_reject=a}),t._readyPromiseState="pending"}function defaultWriterReadyPromiseInitializeAsRejected(t,r){defaultWriterReadyPromiseInitialize(t),defaultWriterReadyPromiseReject(t,r)}function defaultWriterReadyPromiseReject(t,r){void 0!==t._readyPromise_reject&&(setPromiseIsHandledToTrue(t._readyPromise),t._readyPromise_reject(r),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="rejected")}function defaultWriterReadyPromiseReset(t){defaultWriterReadyPromiseInitialize(t)}function defaultWriterReadyPromiseResetToRejected(t,r){defaultWriterReadyPromiseInitializeAsRejected(t,r)}function defaultWriterReadyPromiseResolve(t){void 0!==t._readyPromise_resolve&&(t._readyPromise_resolve(void 0),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="fulfilled")}Object.defineProperties(WritableStreamDefaultController.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(WritableStreamDefaultController.prototype,r.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});let A="undefined"!=typeof DOMException?DOMException:void 0;function isDOMExceptionConstructor(t){if(!("function"==typeof t||"object"==typeof t))return!1;try{return new t,!0}catch(t){return!1}}function createDOMExceptionPolyfill(){let ctor=function(t,r){this.message=t||"",this.name=r||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return ctor.prototype=Object.create(Error.prototype),Object.defineProperty(ctor.prototype,"constructor",{value:ctor,writable:!0,configurable:!0}),ctor}let _=isDOMExceptionConstructor(A)?A:createDOMExceptionPolyfill();function ReadableStreamPipeTo(t,r,a,n,o,i){let l=AcquireReadableStreamDefaultReader(t),u=new WritableStreamDefaultWriter(r);t._disturbed=!0;let c=!1,d=s(void 0);return newPromise((h,p)=>{let m;if(void 0!==i){if(m=()=>{let a=new _("Aborted","AbortError"),i=[];n||i.push(()=>"writable"===r._state?WritableStreamAbort(r,a):s(void 0)),o||i.push(()=>"readable"===t._state?ReadableStreamCancel(t,a):s(void 0)),shutdownWithAction(()=>Promise.all(i.map(t=>t())),!0,a)},i.aborted){m();return}i.addEventListener("abort",m)}function pipeLoop(){return newPromise((t,r)=>{function next(a){a?t():PerformPromiseThen(pipeStep(),next,r)}next(!1)})}function pipeStep(){return c?s(!0):PerformPromiseThen(u._readyPromise,()=>newPromise((t,r)=>{ReadableStreamDefaultReaderRead(l,{_chunkSteps:r=>{d=PerformPromiseThen(WritableStreamDefaultWriterWrite(u,r),void 0,noop),t(!1)},_closeSteps:()=>t(!0),_errorSteps:r})}))}if(isOrBecomesErrored(t,l._closedPromise,t=>{n?shutdown(!0,t):shutdownWithAction(()=>WritableStreamAbort(r,t),!0,t)}),isOrBecomesErrored(r,u._closedPromise,r=>{o?shutdown(!0,r):shutdownWithAction(()=>ReadableStreamCancel(t,r),!0,r)}),isOrBecomesClosed(t,l._closedPromise,()=>{a?shutdown():shutdownWithAction(()=>WritableStreamDefaultWriterCloseWithErrorPropagation(u))}),WritableStreamCloseQueuedOrInFlight(r)||"closed"===r._state){let r=TypeError("the destination writable stream closed before all data could be piped to it");o?shutdown(!0,r):shutdownWithAction(()=>ReadableStreamCancel(t,r),!0,r)}function waitForWritesToFinish(){let t=d;return PerformPromiseThen(d,()=>t!==d?waitForWritesToFinish():void 0)}function isOrBecomesErrored(t,r,a){"errored"===t._state?a(t._storedError):uponRejection(r,a)}function isOrBecomesClosed(t,r,a){"closed"===t._state?a():uponPromise(r,a)}function shutdownWithAction(t,a,n){!c&&((c=!0,"writable"!==r._state||WritableStreamCloseQueuedOrInFlight(r))?doTheRest():uponPromise(waitForWritesToFinish(),doTheRest));function doTheRest(){uponPromise(t(),()=>finalize(a,n),t=>finalize(!0,t))}}function shutdown(t,a){!c&&((c=!0,"writable"!==r._state||WritableStreamCloseQueuedOrInFlight(r))?finalize(t,a):uponPromise(waitForWritesToFinish(),()=>finalize(t,a)))}function finalize(t,r){WritableStreamDefaultWriterRelease(u),ReadableStreamReaderGenericRelease(l),void 0!==i&&i.removeEventListener("abort",m),t?p(r):h(void 0)}setPromiseIsHandledToTrue(pipeLoop())})}let ReadableStreamDefaultController=class ReadableStreamDefaultController{constructor(){throw TypeError("Illegal constructor")}get desiredSize(){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("desiredSize");return ReadableStreamDefaultControllerGetDesiredSize(this)}close(){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("close");if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(this))throw TypeError("The stream is not in a state that permits close");ReadableStreamDefaultControllerClose(this)}enqueue(t){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("enqueue");if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(this))throw TypeError("The stream is not in a state that permits enqueue");return ReadableStreamDefaultControllerEnqueue(this,t)}error(t){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("error");ReadableStreamDefaultControllerError(this,t)}[h](t){ResetQueue(this);let r=this._cancelAlgorithm(t);return ReadableStreamDefaultControllerClearAlgorithms(this),r}[m](t){let r=this._controlledReadableStream;if(this._queue.length>0){let a=DequeueValue(this);this._closeRequested&&0===this._queue.length?(ReadableStreamDefaultControllerClearAlgorithms(this),ReadableStreamClose(r)):ReadableStreamDefaultControllerCallPullIfNeeded(this),t._chunkSteps(a)}else ReadableStreamAddReadRequest(r,t),ReadableStreamDefaultControllerCallPullIfNeeded(this)}};function IsReadableStreamDefaultController(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_controlledReadableStream"))&&t instanceof ReadableStreamDefaultController}function ReadableStreamDefaultControllerCallPullIfNeeded(t){let r=ReadableStreamDefaultControllerShouldCallPull(t);if(!r)return;if(t._pulling){t._pullAgain=!0;return}t._pulling=!0;let a=t._pullAlgorithm();uponPromise(a,()=>{t._pulling=!1,t._pullAgain&&(t._pullAgain=!1,ReadableStreamDefaultControllerCallPullIfNeeded(t))},r=>{ReadableStreamDefaultControllerError(t,r)})}function ReadableStreamDefaultControllerShouldCallPull(t){let r=t._controlledReadableStream;if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(t)||!t._started)return!1;if(IsReadableStreamLocked(r)&&ReadableStreamGetNumReadRequests(r)>0)return!0;let a=ReadableStreamDefaultControllerGetDesiredSize(t);return a>0}function ReadableStreamDefaultControllerClearAlgorithms(t){t._pullAlgorithm=void 0,t._cancelAlgorithm=void 0,t._strategySizeAlgorithm=void 0}function ReadableStreamDefaultControllerClose(t){if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(t))return;let r=t._controlledReadableStream;t._closeRequested=!0,0===t._queue.length&&(ReadableStreamDefaultControllerClearAlgorithms(t),ReadableStreamClose(r))}function ReadableStreamDefaultControllerEnqueue(t,r){if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(t))return;let a=t._controlledReadableStream;if(IsReadableStreamLocked(a)&&ReadableStreamGetNumReadRequests(a)>0)ReadableStreamFulfillReadRequest(a,r,!1);else{let a;try{a=t._strategySizeAlgorithm(r)}catch(r){throw ReadableStreamDefaultControllerError(t,r),r}try{EnqueueValueWithSize(t,r,a)}catch(r){throw ReadableStreamDefaultControllerError(t,r),r}}ReadableStreamDefaultControllerCallPullIfNeeded(t)}function ReadableStreamDefaultControllerError(t,r){let a=t._controlledReadableStream;"readable"===a._state&&(ResetQueue(t),ReadableStreamDefaultControllerClearAlgorithms(t),ReadableStreamError(a,r))}function ReadableStreamDefaultControllerGetDesiredSize(t){let r=t._controlledReadableStream._state;return"errored"===r?null:"closed"===r?0:t._strategyHWM-t._queueTotalSize}function ReadableStreamDefaultControllerHasBackpressure(t){return!ReadableStreamDefaultControllerShouldCallPull(t)}function ReadableStreamDefaultControllerCanCloseOrEnqueue(t){let r=t._controlledReadableStream._state;return!t._closeRequested&&"readable"===r}function SetUpReadableStreamDefaultController(t,r,a,n,o,i,l){r._controlledReadableStream=t,r._queue=void 0,r._queueTotalSize=void 0,ResetQueue(r),r._started=!1,r._closeRequested=!1,r._pullAgain=!1,r._pulling=!1,r._strategySizeAlgorithm=l,r._strategyHWM=i,r._pullAlgorithm=n,r._cancelAlgorithm=o,t._readableStreamController=r;let u=a();uponPromise(s(u),()=>{r._started=!0,ReadableStreamDefaultControllerCallPullIfNeeded(r)},t=>{ReadableStreamDefaultControllerError(r,t)})}function SetUpReadableStreamDefaultControllerFromUnderlyingSource(t,r,a,n){let o=Object.create(ReadableStreamDefaultController.prototype),startAlgorithm=()=>void 0,pullAlgorithm=()=>s(void 0),cancelAlgorithm=()=>s(void 0);void 0!==r.start&&(startAlgorithm=()=>r.start(o)),void 0!==r.pull&&(pullAlgorithm=()=>r.pull(o)),void 0!==r.cancel&&(cancelAlgorithm=t=>r.cancel(t)),SetUpReadableStreamDefaultController(t,o,startAlgorithm,pullAlgorithm,cancelAlgorithm,a,n)}function defaultControllerBrandCheckException$1(t){return TypeError(`ReadableStreamDefaultController.prototype.${t} can only be used on a ReadableStreamDefaultController`)}function ReadableStreamTee(t,r){return IsReadableByteStreamController(t._readableStreamController)?ReadableByteStreamTee(t):ReadableStreamDefaultTee(t)}function ReadableStreamDefaultTee(t,r){let a,n,o,i,l;let c=AcquireReadableStreamDefaultReader(t),d=!1,h=!1,p=!1,m=!1,y=newPromise(t=>{l=t});function pullAlgorithm(){return d?h=!0:(d=!0,ReadableStreamDefaultReaderRead(c,{_chunkSteps:t=>{u(()=>{h=!1,p||ReadableStreamDefaultControllerEnqueue(o._readableStreamController,t),m||ReadableStreamDefaultControllerEnqueue(i._readableStreamController,t),d=!1,h&&pullAlgorithm()})},_closeSteps:()=>{d=!1,p||ReadableStreamDefaultControllerClose(o._readableStreamController),m||ReadableStreamDefaultControllerClose(i._readableStreamController),p&&m||l(void 0)},_errorSteps:()=>{d=!1}})),s(void 0)}function cancel2Algorithm(r){if(m=!0,n=r,p){let r=CreateArrayFromList([a,n]),o=ReadableStreamCancel(t,r);l(o)}return y}function startAlgorithm(){}return o=CreateReadableStream(startAlgorithm,pullAlgorithm,function(r){if(p=!0,a=r,m){let r=CreateArrayFromList([a,n]),o=ReadableStreamCancel(t,r);l(o)}return y}),i=CreateReadableStream(startAlgorithm,pullAlgorithm,cancel2Algorithm),uponRejection(c._closedPromise,t=>{ReadableStreamDefaultControllerError(o._readableStreamController,t),ReadableStreamDefaultControllerError(i._readableStreamController,t),p&&m||l(void 0)}),[o,i]}function ReadableByteStreamTee(t){let r,a,n,o,i,l=AcquireReadableStreamDefaultReader(t),c=!1,d=!1,h=!1,p=!1,m=!1,y=newPromise(t=>{i=t});function forwardReaderError(t){uponRejection(t._closedPromise,r=>{t===l&&(ReadableByteStreamControllerError(n._readableStreamController,r),ReadableByteStreamControllerError(o._readableStreamController,r),p&&m||i(void 0))})}function pullWithDefaultReader(){IsReadableStreamBYOBReader(l)&&(ReadableStreamReaderGenericRelease(l),forwardReaderError(l=AcquireReadableStreamDefaultReader(t))),ReadableStreamDefaultReaderRead(l,{_chunkSteps:r=>{u(()=>{d=!1,h=!1;let a=r;if(!p&&!m)try{a=CloneAsUint8Array(r)}catch(r){ReadableByteStreamControllerError(n._readableStreamController,r),ReadableByteStreamControllerError(o._readableStreamController,r),i(ReadableStreamCancel(t,r));return}p||ReadableByteStreamControllerEnqueue(n._readableStreamController,r),m||ReadableByteStreamControllerEnqueue(o._readableStreamController,a),c=!1,d?pull1Algorithm():h&&pull2Algorithm()})},_closeSteps:()=>{c=!1,p||ReadableByteStreamControllerClose(n._readableStreamController),m||ReadableByteStreamControllerClose(o._readableStreamController),n._readableStreamController._pendingPullIntos.length>0&&ReadableByteStreamControllerRespond(n._readableStreamController,0),o._readableStreamController._pendingPullIntos.length>0&&ReadableByteStreamControllerRespond(o._readableStreamController,0),p&&m||i(void 0)},_errorSteps:()=>{c=!1}})}function pullWithBYOBReader(r,a){IsReadableStreamDefaultReader(l)&&(ReadableStreamReaderGenericRelease(l),forwardReaderError(l=new ReadableStreamBYOBReader(t)));let s=a?o:n,y=a?n:o;ReadableStreamBYOBReaderRead(l,r,{_chunkSteps:r=>{u(()=>{d=!1,h=!1;let n=a?m:p,o=a?p:m;if(o)n||ReadableByteStreamControllerRespondWithNewView(s._readableStreamController,r);else{let a;try{a=CloneAsUint8Array(r)}catch(r){ReadableByteStreamControllerError(s._readableStreamController,r),ReadableByteStreamControllerError(y._readableStreamController,r),i(ReadableStreamCancel(t,r));return}n||ReadableByteStreamControllerRespondWithNewView(s._readableStreamController,r),ReadableByteStreamControllerEnqueue(y._readableStreamController,a)}c=!1,d?pull1Algorithm():h&&pull2Algorithm()})},_closeSteps:t=>{c=!1;let r=a?m:p,n=a?p:m;r||ReadableByteStreamControllerClose(s._readableStreamController),n||ReadableByteStreamControllerClose(y._readableStreamController),void 0!==t&&(r||ReadableByteStreamControllerRespondWithNewView(s._readableStreamController,t),!n&&y._readableStreamController._pendingPullIntos.length>0&&ReadableByteStreamControllerRespond(y._readableStreamController,0)),r&&n||i(void 0)},_errorSteps:()=>{c=!1}})}function pull1Algorithm(){if(c)return d=!0,s(void 0);c=!0;let t=ReadableByteStreamControllerGetBYOBRequest(n._readableStreamController);return null===t?pullWithDefaultReader():pullWithBYOBReader(t._view,!1),s(void 0)}function pull2Algorithm(){if(c)return h=!0,s(void 0);c=!0;let t=ReadableByteStreamControllerGetBYOBRequest(o._readableStreamController);return null===t?pullWithDefaultReader():pullWithBYOBReader(t._view,!0),s(void 0)}function cancel2Algorithm(n){if(m=!0,a=n,p){let n=CreateArrayFromList([r,a]),o=ReadableStreamCancel(t,n);i(o)}return y}function startAlgorithm(){}return n=CreateReadableByteStream(startAlgorithm,pull1Algorithm,function(n){if(p=!0,r=n,m){let n=CreateArrayFromList([r,a]),o=ReadableStreamCancel(t,n);i(o)}return y}),o=CreateReadableByteStream(startAlgorithm,pull2Algorithm,cancel2Algorithm),forwardReaderError(l),[n,o]}function convertUnderlyingDefaultOrByteSource(t,r){assertDictionary(t,r);let a=null==t?void 0:t.autoAllocateChunkSize,n=null==t?void 0:t.cancel,o=null==t?void 0:t.pull,i=null==t?void 0:t.start,s=null==t?void 0:t.type;return{autoAllocateChunkSize:void 0===a?void 0:convertUnsignedLongLongWithEnforceRange(a,`${r} has member 'autoAllocateChunkSize' that`),cancel:void 0===n?void 0:convertUnderlyingSourceCancelCallback(n,t,`${r} has member 'cancel' that`),pull:void 0===o?void 0:convertUnderlyingSourcePullCallback(o,t,`${r} has member 'pull' that`),start:void 0===i?void 0:convertUnderlyingSourceStartCallback(i,t,`${r} has member 'start' that`),type:void 0===s?void 0:convertReadableStreamType(s,`${r} has member 'type' that`)}}function convertUnderlyingSourceCancelCallback(t,r,a){return assertFunction(t,a),a=>promiseCall(t,r,[a])}function convertUnderlyingSourcePullCallback(t,r,a){return assertFunction(t,a),a=>promiseCall(t,r,[a])}function convertUnderlyingSourceStartCallback(t,r,a){return assertFunction(t,a),a=>reflectCall(t,r,[a])}function convertReadableStreamType(t,r){if("bytes"!=(t=`${t}`))throw TypeError(`${r} '${t}' is not a valid enumeration value for ReadableStreamType`);return t}function convertReaderOptions(t,r){assertDictionary(t,r);let a=null==t?void 0:t.mode;return{mode:void 0===a?void 0:convertReadableStreamReaderMode(a,`${r} has member 'mode' that`)}}function convertReadableStreamReaderMode(t,r){if("byob"!=(t=`${t}`))throw TypeError(`${r} '${t}' is not a valid enumeration value for ReadableStreamReaderMode`);return t}function convertIteratorOptions(t,r){assertDictionary(t,r);let a=null==t?void 0:t.preventCancel;return{preventCancel:!!a}}function convertPipeOptions(t,r){assertDictionary(t,r);let a=null==t?void 0:t.preventAbort,n=null==t?void 0:t.preventCancel,o=null==t?void 0:t.preventClose,i=null==t?void 0:t.signal;return void 0!==i&&assertAbortSignal(i,`${r} has member 'signal' that`),{preventAbort:!!a,preventCancel:!!n,preventClose:!!o,signal:i}}function assertAbortSignal(t,r){if(!isAbortSignal(t))throw TypeError(`${r} is not an AbortSignal.`)}function convertReadableWritablePair(t,r){assertDictionary(t,r);let a=null==t?void 0:t.readable;assertRequiredField(a,"readable","ReadableWritablePair"),assertReadableStream(a,`${r} has member 'readable' that`);let n=null==t?void 0:t.writable;return assertRequiredField(n,"writable","ReadableWritablePair"),assertWritableStream(n,`${r} has member 'writable' that`),{readable:a,writable:n}}Object.defineProperties(ReadableStreamDefaultController.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(ReadableStreamDefaultController.prototype,r.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});let ReadableStream1=class ReadableStream1{constructor(t={},r={}){void 0===t?t=null:assertObject(t,"First parameter");let a=convertQueuingStrategy(r,"Second parameter"),n=convertUnderlyingDefaultOrByteSource(t,"First parameter");if(InitializeReadableStream(this),"bytes"===n.type){if(void 0!==a.size)throw RangeError("The strategy for a byte stream cannot have a size function");let t=ExtractHighWaterMark(a,0);SetUpReadableByteStreamControllerFromUnderlyingSource(this,n,t)}else{let t=ExtractSizeAlgorithm(a),r=ExtractHighWaterMark(a,1);SetUpReadableStreamDefaultControllerFromUnderlyingSource(this,n,r,t)}}get locked(){if(!IsReadableStream(this))throw streamBrandCheckException$1("locked");return IsReadableStreamLocked(this)}cancel(t){return IsReadableStream(this)?IsReadableStreamLocked(this)?l(TypeError("Cannot cancel a stream that already has a reader")):ReadableStreamCancel(this,t):l(streamBrandCheckException$1("cancel"))}getReader(t){if(!IsReadableStream(this))throw streamBrandCheckException$1("getReader");let r=convertReaderOptions(t,"First parameter");return void 0===r.mode?AcquireReadableStreamDefaultReader(this):new ReadableStreamBYOBReader(this)}pipeThrough(t,r={}){if(!IsReadableStream(this))throw streamBrandCheckException$1("pipeThrough");assertRequiredArgument(t,1,"pipeThrough");let a=convertReadableWritablePair(t,"First parameter"),n=convertPipeOptions(r,"Second parameter");if(IsReadableStreamLocked(this))throw TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(IsWritableStreamLocked(a.writable))throw TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let o=ReadableStreamPipeTo(this,a.writable,n.preventClose,n.preventAbort,n.preventCancel,n.signal);return setPromiseIsHandledToTrue(o),a.readable}pipeTo(t,r={}){let a;if(!IsReadableStream(this))return l(streamBrandCheckException$1("pipeTo"));if(void 0===t)return l("Parameter 1 is required in 'pipeTo'.");if(!IsWritableStream(t))return l(TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));try{a=convertPipeOptions(r,"Second parameter")}catch(t){return l(t)}return IsReadableStreamLocked(this)?l(TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):IsWritableStreamLocked(t)?l(TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):ReadableStreamPipeTo(this,t,a.preventClose,a.preventAbort,a.preventCancel,a.signal)}tee(){if(!IsReadableStream(this))throw streamBrandCheckException$1("tee");let t=ReadableStreamTee(this);return CreateArrayFromList(t)}values(t){if(!IsReadableStream(this))throw streamBrandCheckException$1("values");let r=convertIteratorOptions(t,"First parameter");return AcquireReadableStreamAsyncIterator(this,r.preventCancel)}};function CreateReadableStream(t,r,a,n=1,o=()=>1){let i=Object.create(ReadableStream1.prototype);InitializeReadableStream(i);let s=Object.create(ReadableStreamDefaultController.prototype);return SetUpReadableStreamDefaultController(i,s,t,r,a,n,o),i}function CreateReadableByteStream(t,r,a){let n=Object.create(ReadableStream1.prototype);InitializeReadableStream(n);let o=Object.create(ReadableByteStreamController.prototype);return SetUpReadableByteStreamController(n,o,t,r,a,0,void 0),n}function InitializeReadableStream(t){t._state="readable",t._reader=void 0,t._storedError=void 0,t._disturbed=!1}function IsReadableStream(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_readableStreamController"))&&t instanceof ReadableStream1}function IsReadableStreamLocked(t){return void 0!==t._reader}function ReadableStreamCancel(t,r){if(t._disturbed=!0,"closed"===t._state)return s(void 0);if("errored"===t._state)return l(t._storedError);ReadableStreamClose(t);let a=t._reader;void 0!==a&&IsReadableStreamBYOBReader(a)&&(a._readIntoRequests.forEach(t=>{t._closeSteps(void 0)}),a._readIntoRequests=new SimpleQueue);let n=t._readableStreamController[h](r);return PerformPromiseThen(n,noop,void 0)}function ReadableStreamClose(t){t._state="closed";let r=t._reader;void 0!==r&&(defaultReaderClosedPromiseResolve(r),IsReadableStreamDefaultReader(r)&&(r._readRequests.forEach(t=>{t._closeSteps()}),r._readRequests=new SimpleQueue))}function ReadableStreamError(t,r){t._state="errored",t._storedError=r;let a=t._reader;void 0!==a&&(defaultReaderClosedPromiseReject(a,r),IsReadableStreamDefaultReader(a)?(a._readRequests.forEach(t=>{t._errorSteps(r)}),a._readRequests=new SimpleQueue):(a._readIntoRequests.forEach(t=>{t._errorSteps(r)}),a._readIntoRequests=new SimpleQueue))}function streamBrandCheckException$1(t){return TypeError(`ReadableStream.prototype.${t} can only be used on a ReadableStream`)}function convertQueuingStrategyInit(t,r){assertDictionary(t,r);let a=null==t?void 0:t.highWaterMark;return assertRequiredField(a,"highWaterMark","QueuingStrategyInit"),{highWaterMark:convertUnrestrictedDouble(a)}}Object.defineProperties(ReadableStream1.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(ReadableStream1.prototype,r.toStringTag,{value:"ReadableStream",configurable:!0}),"symbol"==typeof r.asyncIterator&&Object.defineProperty(ReadableStream1.prototype,r.asyncIterator,{value:ReadableStream1.prototype.values,writable:!0,configurable:!0});let byteLengthSizeFunction=t=>t.byteLength;try{Object.defineProperty(byteLengthSizeFunction,"name",{value:"size",configurable:!0})}catch(t){}let ByteLengthQueuingStrategy=class ByteLengthQueuingStrategy{constructor(t){assertRequiredArgument(t,1,"ByteLengthQueuingStrategy"),t=convertQueuingStrategyInit(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!IsByteLengthQueuingStrategy(this))throw byteLengthBrandCheckException("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!IsByteLengthQueuingStrategy(this))throw byteLengthBrandCheckException("size");return byteLengthSizeFunction}};function byteLengthBrandCheckException(t){return TypeError(`ByteLengthQueuingStrategy.prototype.${t} can only be used on a ByteLengthQueuingStrategy`)}function IsByteLengthQueuingStrategy(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_byteLengthQueuingStrategyHighWaterMark"))&&t instanceof ByteLengthQueuingStrategy}Object.defineProperties(ByteLengthQueuingStrategy.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(ByteLengthQueuingStrategy.prototype,r.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});let countSizeFunction=()=>1;try{Object.defineProperty(countSizeFunction,"name",{value:"size",configurable:!0})}catch(t){}let CountQueuingStrategy=class CountQueuingStrategy{constructor(t){assertRequiredArgument(t,1,"CountQueuingStrategy"),t=convertQueuingStrategyInit(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!IsCountQueuingStrategy(this))throw countBrandCheckException("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!IsCountQueuingStrategy(this))throw countBrandCheckException("size");return countSizeFunction}};function countBrandCheckException(t){return TypeError(`CountQueuingStrategy.prototype.${t} can only be used on a CountQueuingStrategy`)}function IsCountQueuingStrategy(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_countQueuingStrategyHighWaterMark"))&&t instanceof CountQueuingStrategy}function convertTransformer(t,r){assertDictionary(t,r);let a=null==t?void 0:t.flush,n=null==t?void 0:t.readableType,o=null==t?void 0:t.start,i=null==t?void 0:t.transform,s=null==t?void 0:t.writableType;return{flush:void 0===a?void 0:convertTransformerFlushCallback(a,t,`${r} has member 'flush' that`),readableType:n,start:void 0===o?void 0:convertTransformerStartCallback(o,t,`${r} has member 'start' that`),transform:void 0===i?void 0:convertTransformerTransformCallback(i,t,`${r} has member 'transform' that`),writableType:s}}function convertTransformerFlushCallback(t,r,a){return assertFunction(t,a),a=>promiseCall(t,r,[a])}function convertTransformerStartCallback(t,r,a){return assertFunction(t,a),a=>reflectCall(t,r,[a])}function convertTransformerTransformCallback(t,r,a){return assertFunction(t,a),(a,n)=>promiseCall(t,r,[a,n])}Object.defineProperties(CountQueuingStrategy.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(CountQueuingStrategy.prototype,r.toStringTag,{value:"CountQueuingStrategy",configurable:!0});let TransformStream=class TransformStream{constructor(t={},r={},a={}){let n;void 0===t&&(t=null);let o=convertQueuingStrategy(r,"Second parameter"),i=convertQueuingStrategy(a,"Third parameter"),s=convertTransformer(t,"First parameter");if(void 0!==s.readableType)throw RangeError("Invalid readableType specified");if(void 0!==s.writableType)throw RangeError("Invalid writableType specified");let l=ExtractHighWaterMark(i,0),u=ExtractSizeAlgorithm(i),c=ExtractHighWaterMark(o,1),d=ExtractSizeAlgorithm(o),h=newPromise(t=>{n=t});InitializeTransformStream(this,h,c,d,l,u),SetUpTransformStreamDefaultControllerFromTransformer(this,s),void 0!==s.start?n(s.start(this._transformStreamController)):n(void 0)}get readable(){if(!IsTransformStream(this))throw streamBrandCheckException("readable");return this._readable}get writable(){if(!IsTransformStream(this))throw streamBrandCheckException("writable");return this._writable}};function InitializeTransformStream(t,r,a,n,o,i){function startAlgorithm(){return r}function writeAlgorithm(r){return TransformStreamDefaultSinkWriteAlgorithm(t,r)}function abortAlgorithm(r){return TransformStreamDefaultSinkAbortAlgorithm(t,r)}function closeAlgorithm(){return TransformStreamDefaultSinkCloseAlgorithm(t)}function pullAlgorithm(){return TransformStreamDefaultSourcePullAlgorithm(t)}function cancelAlgorithm(r){return TransformStreamErrorWritableAndUnblockWrite(t,r),s(void 0)}t._writable=CreateWritableStream(startAlgorithm,writeAlgorithm,closeAlgorithm,abortAlgorithm,a,n),t._readable=CreateReadableStream(startAlgorithm,pullAlgorithm,cancelAlgorithm,o,i),t._backpressure=void 0,t._backpressureChangePromise=void 0,t._backpressureChangePromise_resolve=void 0,TransformStreamSetBackpressure(t,!0),t._transformStreamController=void 0}function IsTransformStream(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_transformStreamController"))&&t instanceof TransformStream}function TransformStreamError(t,r){ReadableStreamDefaultControllerError(t._readable._readableStreamController,r),TransformStreamErrorWritableAndUnblockWrite(t,r)}function TransformStreamErrorWritableAndUnblockWrite(t,r){TransformStreamDefaultControllerClearAlgorithms(t._transformStreamController),WritableStreamDefaultControllerErrorIfNeeded(t._writable._writableStreamController,r),t._backpressure&&TransformStreamSetBackpressure(t,!1)}function TransformStreamSetBackpressure(t,r){void 0!==t._backpressureChangePromise&&t._backpressureChangePromise_resolve(),t._backpressureChangePromise=newPromise(r=>{t._backpressureChangePromise_resolve=r}),t._backpressure=r}Object.defineProperties(TransformStream.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(TransformStream.prototype,r.toStringTag,{value:"TransformStream",configurable:!0});let TransformStreamDefaultController=class TransformStreamDefaultController{constructor(){throw TypeError("Illegal constructor")}get desiredSize(){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("desiredSize");let t=this._controlledTransformStream._readable._readableStreamController;return ReadableStreamDefaultControllerGetDesiredSize(t)}enqueue(t){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("enqueue");TransformStreamDefaultControllerEnqueue(this,t)}error(t){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("error");TransformStreamDefaultControllerError(this,t)}terminate(){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("terminate");TransformStreamDefaultControllerTerminate(this)}};function IsTransformStreamDefaultController(t){return!!(typeIsObject(t)&&Object.prototype.hasOwnProperty.call(t,"_controlledTransformStream"))&&t instanceof TransformStreamDefaultController}function SetUpTransformStreamDefaultController(t,r,a,n){r._controlledTransformStream=t,t._transformStreamController=r,r._transformAlgorithm=a,r._flushAlgorithm=n}function SetUpTransformStreamDefaultControllerFromTransformer(t,r){let a=Object.create(TransformStreamDefaultController.prototype),transformAlgorithm=t=>{try{return TransformStreamDefaultControllerEnqueue(a,t),s(void 0)}catch(t){return l(t)}},flushAlgorithm=()=>s(void 0);void 0!==r.transform&&(transformAlgorithm=t=>r.transform(t,a)),void 0!==r.flush&&(flushAlgorithm=()=>r.flush(a)),SetUpTransformStreamDefaultController(t,a,transformAlgorithm,flushAlgorithm)}function TransformStreamDefaultControllerClearAlgorithms(t){t._transformAlgorithm=void 0,t._flushAlgorithm=void 0}function TransformStreamDefaultControllerEnqueue(t,r){let a=t._controlledTransformStream,n=a._readable._readableStreamController;if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(n))throw TypeError("Readable side is not in a state that permits enqueue");try{ReadableStreamDefaultControllerEnqueue(n,r)}catch(t){throw TransformStreamErrorWritableAndUnblockWrite(a,t),a._readable._storedError}let o=ReadableStreamDefaultControllerHasBackpressure(n);o!==a._backpressure&&TransformStreamSetBackpressure(a,!0)}function TransformStreamDefaultControllerError(t,r){TransformStreamError(t._controlledTransformStream,r)}function TransformStreamDefaultControllerPerformTransform(t,r){let a=t._transformAlgorithm(r);return PerformPromiseThen(a,void 0,r=>{throw TransformStreamError(t._controlledTransformStream,r),r})}function TransformStreamDefaultControllerTerminate(t){let r=t._controlledTransformStream,a=r._readable._readableStreamController;ReadableStreamDefaultControllerClose(a);let n=TypeError("TransformStream terminated");TransformStreamErrorWritableAndUnblockWrite(r,n)}function TransformStreamDefaultSinkWriteAlgorithm(t,r){let a=t._transformStreamController;if(t._backpressure){let n=t._backpressureChangePromise;return PerformPromiseThen(n,()=>{let n=t._writable,o=n._state;if("erroring"===o)throw n._storedError;return TransformStreamDefaultControllerPerformTransform(a,r)},void 0)}return TransformStreamDefaultControllerPerformTransform(a,r)}function TransformStreamDefaultSinkAbortAlgorithm(t,r){return TransformStreamError(t,r),s(void 0)}function TransformStreamDefaultSinkCloseAlgorithm(t){let r=t._readable,a=t._transformStreamController,n=a._flushAlgorithm();return TransformStreamDefaultControllerClearAlgorithms(a),PerformPromiseThen(n,()=>{if("errored"===r._state)throw r._storedError;ReadableStreamDefaultControllerClose(r._readableStreamController)},a=>{throw TransformStreamError(t,a),r._storedError})}function TransformStreamDefaultSourcePullAlgorithm(t){return TransformStreamSetBackpressure(t,!1),t._backpressureChangePromise}function defaultControllerBrandCheckException(t){return TypeError(`TransformStreamDefaultController.prototype.${t} can only be used on a TransformStreamDefaultController`)}function streamBrandCheckException(t){return TypeError(`TransformStream.prototype.${t} can only be used on a TransformStream`)}Object.defineProperties(TransformStreamDefaultController.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(TransformStreamDefaultController.prototype,r.toStringTag,{value:"TransformStreamDefaultController",configurable:!0}),t.ByteLengthQueuingStrategy=ByteLengthQueuingStrategy,t.CountQueuingStrategy=CountQueuingStrategy,t.ReadableByteStreamController=ReadableByteStreamController,t.ReadableStream=ReadableStream1,t.ReadableStreamBYOBReader=ReadableStreamBYOBReader,t.ReadableStreamBYOBRequest=ReadableStreamBYOBRequest,t.ReadableStreamDefaultController=ReadableStreamDefaultController,t.ReadableStreamDefaultReader=ReadableStreamDefaultReader,t.TransformStream=TransformStream,t.TransformStreamDefaultController=TransformStreamDefaultController,t.WritableStream=WritableStream,t.WritableStreamDefaultController=WritableStreamDefaultController,t.WritableStreamDefaultWriter=WritableStreamDefaultWriter,Object.defineProperty(t,"__esModule",{value:!0})}(m.exports)),m.exports}if(!globalThis.ReadableStream)try{let t=a(97742),{emitWarning:r}=t;try{t.emitWarning=()=>{},Object.assign(globalThis,a(72477)),t.emitWarning=r}catch(a){throw t.emitWarning=r,a}}catch(t){Object.assign(globalThis,requirePonyfill_es2018())}try{let{Blob:t}=a(14300);t&&!t.prototype.stream&&(t.prototype.stream=function(t){let r=0,a=this;return new ReadableStream({type:"bytes",async pull(t){let n=a.slice(r,Math.min(a.size,r+65536)),o=await n.arrayBuffer();r+=o.byteLength,t.enqueue(new Uint8Array(o)),r===a.size&&t.close()}})})}catch(t){}async function*toIterator(t,r=!0){for(let a of t)if("stream"in a)yield*a.stream();else if(ArrayBuffer.isView(a)){if(r){let t=a.byteOffset,r=a.byteOffset+a.byteLength;for(;t!==r;){let n=Math.min(r-t,65536),o=a.buffer.slice(t,t+n);t+=o.byteLength,yield new Uint8Array(o)}}else yield a}else{let t=0;for(;t!==a.size;){let r=a.slice(t,Math.min(a.size,t+65536)),n=await r.arrayBuffer();t+=n.byteLength,yield new Uint8Array(n)}}}let y=class Blob{#r;#a;#n;#o;constructor(t=[],r={}){if(this.#r=[],this.#a="",this.#n=0,this.#o="transparent","object"!=typeof t||null===t)throw TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if("function"!=typeof t[Symbol.iterator])throw TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if("object"!=typeof r&&"function"!=typeof r)throw TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");null===r&&(r={});let a=new TextEncoder;for(let r of t){let t;t=ArrayBuffer.isView(r)?new Uint8Array(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)):r instanceof ArrayBuffer?new Uint8Array(r.slice(0)):r instanceof Blob?r:a.encode(`${r}`);let n=ArrayBuffer.isView(t)?t.byteLength:t.size;n&&(this.#n+=n,this.#r.push(t))}this.#o=`${void 0===r.endings?"transparent":r.endings}`;let n=void 0===r.type?"":String(r.type);this.#a=/^[\x20-\x7E]*$/.test(n)?n:""}get size(){return this.#n}get type(){return this.#a}async text(){let t=new TextDecoder,r="";for await(let a of toIterator(this.#r,!1))r+=t.decode(a,{stream:!0});return r+t.decode()}async arrayBuffer(){let t=new Uint8Array(this.size),r=0;for await(let a of toIterator(this.#r,!1))t.set(a,r),r+=a.length;return t.buffer}stream(){let t=toIterator(this.#r,!0);return new globalThis.ReadableStream({type:"bytes",async pull(r){let a=await t.next();a.done?r.close():r.enqueue(a.value)},async cancel(){await t.return()}})}slice(t=0,r=this.size,a=""){let{size:n}=this,o=t<0?Math.max(n+t,0):Math.min(t,n),i=r<0?Math.max(n+r,0):Math.min(r,n),s=Math.max(i-o,0),l=this.#r,u=[],c=0;for(let t of l){if(c>=s)break;let r=ArrayBuffer.isView(t)?t.byteLength:t.size;if(o&&r<=o)o-=r,i-=r;else{let a;ArrayBuffer.isView(t)?c+=(a=t.subarray(o,Math.min(r,i))).byteLength:c+=(a=t.slice(o,Math.min(r,i))).size,i-=r,u.push(a),o=0}}let d=new Blob([],{type:String(a).toLowerCase()});return d.#n=s,d.#r=u,d}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&"object"==typeof t&&"function"==typeof t.constructor&&("function"==typeof t.stream||"function"==typeof t.arrayBuffer)&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(y.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});let g=y,b=class extends g{#i;#s;constructor(t,r,a={}){if(arguments.length<2)throw TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,a),this.#i=0,this.#s="",null===a&&(a={});let n=void 0===a.lastModified?Date.now():Number(a.lastModified);Number.isNaN(n)||(this.#i=n),this.#s=String(r)}get name(){return this.#s}get lastModified(){return this.#i}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](t){return!!t&&t instanceof g&&/^(File)$/.test(t[Symbol.toStringTag])}};/*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */var{toStringTag:S,iterator:v,hasInstance:C}=Symbol,w=Math.random,A="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),f=(t,r,a)=>(t+="",/^(Blob|File)$/.test(r&&r[S])?[(a=void 0!==a?a+"":"File"==r[S]?r.name:"blob",t),r.name!==a||"blob"==r[S]?new b([r],a,r):r]:[t,r+""]),e=(t,r)=>(r?t:t.replace(/\r?\n|\r/g,"\r\n")).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),x=(t,r,a)=>{if(r.length<a)throw TypeError(`Failed to execute '${t}' on 'FormData': ${a} arguments required, but only ${r.length} present.`)};let _=class{#l;constructor(...t){if(this.#l=[],t.length)throw TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[S](){return"FormData"}[v](){return this.entries()}static[C](t){return t&&"object"==typeof t&&"FormData"===t[S]&&!A.some(r=>"function"!=typeof t[r])}append(...t){x("append",arguments,2),this.#l.push(f(...t))}delete(t){x("delete",arguments,1),t+="",this.#l=this.#l.filter(([r])=>r!==t)}get(t){x("get",arguments,1),t+="";for(var r=this.#l,a=r.length,n=0;n<a;n++)if(r[n][0]===t)return r[n][1];return null}getAll(t,r){return x("getAll",arguments,1),r=[],t+="",this.#l.forEach(a=>a[0]===t&&r.push(a[1])),r}has(t){return x("has",arguments,1),t+="",this.#l.some(r=>r[0]===t)}forEach(t,r){for(var[a,n]of(x("forEach",arguments,1),this))t.call(r,n,a,this)}set(...t){x("set",arguments,2);var r=[],a=!0;t=f(...t),this.#l.forEach(n=>{n[0]===t[0]?a&&(a=!r.push(t)):r.push(n)}),a&&r.push(t),this.#l=r}*entries(){yield*this.#l}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}};function formDataToBlob(t,r=g){var a=`${w()}${w()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),n=[],o=`--${a}\r
Content-Disposition: form-data; name="`;return t.forEach((t,r)=>"string"==typeof t?n.push(o+e(r)+`"\r
\r
${t.replace(/\r(?!\n)|(?<!\r)\n/g,"\r\n")}\r
`):n.push(o+e(r)+`"; filename="${e(t.name,1)}"\r
Content-Type: ${t.type||"application/octet-stream"}\r
\r
`,t,"\r\n")),n.push(`--${a}--`),new r(n,{type:"multipart/form-data; boundary="+a})}let FetchBaseError=class FetchBaseError extends Error{constructor(t,r){super(t),Error.captureStackTrace(this,this.constructor),this.type=r}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};let FetchError=class FetchError extends FetchBaseError{constructor(t,r,a){super(t,r),a&&(this.code=this.errno=a.code,this.erroredSysCall=a.syscall)}};let k=Symbol.toStringTag,isURLSearchParameters=t=>"object"==typeof t&&"function"==typeof t.append&&"function"==typeof t.delete&&"function"==typeof t.get&&"function"==typeof t.getAll&&"function"==typeof t.has&&"function"==typeof t.set&&"function"==typeof t.sort&&"URLSearchParams"===t[k],isBlob=t=>t&&"object"==typeof t&&"function"==typeof t.arrayBuffer&&"string"==typeof t.type&&"function"==typeof t.stream&&"function"==typeof t.constructor&&/^(Blob|File)$/.test(t[k]),isAbortSignal=t=>"object"==typeof t&&("AbortSignal"===t[k]||"EventTarget"===t[k]),isDomainOrSubdomain=(t,r)=>{let a=new URL(r).hostname,n=new URL(t).hostname;return a===n||a.endsWith(`.${n}`)},isSameProtocol=(t,r)=>{let a=new URL(r).protocol,n=new URL(t).protocol;return a===n},E=u.promisify(s.pipeline),R=Symbol("Body internals");let Body=class Body{constructor(t,{size:r=0}={}){let a=null;null===t?t=null:isURLSearchParameters(t)?t=l.Buffer.from(t.toString()):isBlob(t)||l.Buffer.isBuffer(t)||(u.types.isAnyArrayBuffer(t)?t=l.Buffer.from(t):ArrayBuffer.isView(t)?t=l.Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof s||(t instanceof _?a=(t=formDataToBlob(t)).type.split("=")[1]:t=l.Buffer.from(String(t))));let n=t;l.Buffer.isBuffer(t)?n=s.Readable.from(t):isBlob(t)&&(n=s.Readable.from(t.stream())),this[R]={body:t,stream:n,boundary:a,disturbed:!1,error:null},this.size=r,t instanceof s&&t.on("error",t=>{let r=t instanceof FetchBaseError?t:new FetchError(`Invalid response body while trying to fetch ${this.url}: ${t.message}`,"system",t);this[R].error=r})}get body(){return this[R].stream}get bodyUsed(){return this[R].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:r,byteLength:a}=await consumeBody(this);return t.slice(r,r+a)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let t=new _,r=new URLSearchParams(await this.text());for(let[a,n]of r)t.append(a,n);return t}let{toFormData:r}=await a.e(874).then(a.t.bind(a,33039,19));return r(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[R].body&&this[R].body.type||"",r=await this.arrayBuffer();return new g([r],{type:t})}async json(){let t=await this.text();return JSON.parse(t)}async text(){let t=await consumeBody(this);return new TextDecoder().decode(t)}buffer(){return consumeBody(this)}};async function consumeBody(t){if(t[R].disturbed)throw TypeError(`body used already for: ${t.url}`);if(t[R].disturbed=!0,t[R].error)throw t[R].error;let{body:r}=t;if(null===r||!(r instanceof s))return l.Buffer.alloc(0);let a=[],n=0;try{for await(let o of r){if(t.size>0&&n+o.length>t.size){let a=new FetchError(`content size at ${t.url} over limit: ${t.size}`,"max-size");throw r.destroy(a),a}n+=o.length,a.push(o)}}catch(a){let r=a instanceof FetchBaseError?a:new FetchError(`Invalid response body while trying to fetch ${t.url}: ${a.message}`,"system",a);throw r}if(!0===r.readableEnded||!0===r._readableState.ended)try{if(a.every(t=>"string"==typeof t))return l.Buffer.from(a.join(""));return l.Buffer.concat(a,n)}catch(r){throw new FetchError(`Could not create Buffer from response body for ${t.url}: ${r.message}`,"system",r)}else throw new FetchError(`Premature close of server response while trying to fetch ${t.url}`)}Body.prototype.buffer=u.deprecate(Body.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer"),Object.defineProperties(Body.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:u.deprecate(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});let clone=(t,r)=>{let a,n;let{body:o}=t[R];if(t.bodyUsed)throw Error("cannot clone body after it is used");return o instanceof s&&"function"!=typeof o.getBoundary&&(a=new s.PassThrough({highWaterMark:r}),n=new s.PassThrough({highWaterMark:r}),o.pipe(a),o.pipe(n),t[R].stream=a,o=n),o},B=u.deprecate(t=>t.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),extractContentType=(t,r)=>null===t?null:"string"==typeof t?"text/plain;charset=UTF-8":isURLSearchParameters(t)?"application/x-www-form-urlencoded;charset=UTF-8":isBlob(t)?t.type||null:l.Buffer.isBuffer(t)||u.types.isAnyArrayBuffer(t)||ArrayBuffer.isView(t)?null:t instanceof _?`multipart/form-data; boundary=${r[R].boundary}`:t&&"function"==typeof t.getBoundary?`multipart/form-data;boundary=${B(t)}`:t instanceof s?null:"text/plain;charset=UTF-8",getTotalBytes=t=>{let{body:r}=t[R];return null===r?0:isBlob(r)?r.size:l.Buffer.isBuffer(r)?r.length:r&&"function"==typeof r.getLengthSync&&r.hasKnownLength&&r.hasKnownLength()?r.getLengthSync():null},writeToStream=async(t,{body:r})=>{null===r?t.end():await E(r,t)},P="function"==typeof n.validateHeaderName?n.validateHeaderName:t=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(t)){let r=TypeError(`Header name must be a valid HTTP token [${t}]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),r}},I="function"==typeof n.validateHeaderValue?n.validateHeaderValue:(t,r)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(r)){let r=TypeError(`Invalid character in header content ["${t}"]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_CHAR"}),r}};let Headers=class Headers extends URLSearchParams{constructor(t){let r=[];if(t instanceof Headers){let a=t.raw();for(let[t,n]of Object.entries(a))r.push(...n.map(r=>[t,r]))}else if(null==t);else if("object"!=typeof t||u.types.isBoxedPrimitive(t))throw TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");else{let a=t[Symbol.iterator];if(null==a)r.push(...Object.entries(t));else{if("function"!=typeof a)throw TypeError("Header pairs must be iterable");r=[...t].map(t=>{if("object"!=typeof t||u.types.isBoxedPrimitive(t))throw TypeError("Each header pair must be an iterable object");return[...t]}).map(t=>{if(2!==t.length)throw TypeError("Each header pair must be a name/value tuple");return[...t]})}}return super(r=r.length>0?r.map(([t,r])=>(P(t),I(t,String(r)),[String(t).toLowerCase(),String(r)])):void 0),new Proxy(this,{get(t,r,a){switch(r){case"append":case"set":return(a,n)=>(P(a),I(a,String(n)),URLSearchParams.prototype[r].call(t,String(a).toLowerCase(),String(n)));case"delete":case"has":case"getAll":return a=>(P(a),URLSearchParams.prototype[r].call(t,String(a).toLowerCase()));case"keys":return()=>(t.sort(),new Set(URLSearchParams.prototype.keys.call(t)).keys());default:return Reflect.get(t,r,a)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let r=this.getAll(t);if(0===r.length)return null;let a=r.join(", ");return/^content-encoding$/i.test(t)&&(a=a.toLowerCase()),a}forEach(t,r){for(let a of this.keys())Reflect.apply(t,r,[this.get(a),a,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,r)=>(t[r]=this.getAll(r),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,r)=>{let a=this.getAll(r);return"host"===r?t[r]=a[0]:t[r]=a.length>1?a:a[0],t},{})}};function fromRawHeaders(t=[]){return new Headers(t.reduce((t,r,a,n)=>(a%2==0&&t.push(n.slice(a,a+2)),t),[]).filter(([t,r])=>{try{return P(t),I(t,String(r)),!0}catch{return!1}}))}Object.defineProperties(Headers.prototype,["get","entries","forEach","values"].reduce((t,r)=>(t[r]={enumerable:!0},t),{}));let T=new Set([301,302,303,307,308]),isRedirect=t=>T.has(t),O=Symbol("Response internals");let Response=class Response extends Body{constructor(t=null,r={}){super(t,r);let a=null!=r.status?r.status:200,n=new Headers(r.headers);if(null!==t&&!n.has("Content-Type")){let r=extractContentType(t,this);r&&n.append("Content-Type",r)}this[O]={type:"default",url:r.url,status:a,statusText:r.statusText||"",headers:n,counter:r.counter,highWaterMark:r.highWaterMark}}get type(){return this[O].type}get url(){return this[O].url||""}get status(){return this[O].status}get ok(){return this[O].status>=200&&this[O].status<300}get redirected(){return this[O].counter>0}get statusText(){return this[O].statusText}get headers(){return this[O].headers}get highWaterMark(){return this[O].highWaterMark}clone(){return new Response(clone(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,r=302){if(!isRedirect(r))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');return new Response(null,{headers:{location:new URL(t).toString()},status:r})}static error(){let t=new Response(null,{status:0,statusText:""});return t[O].type="error",t}static json(t,r={}){let a=JSON.stringify(t);if(void 0===a)throw TypeError("data is not JSON serializable");let n=new Headers(r&&r.headers);return n.has("content-type")||n.set("content-type","application/json"),new Response(a,{...r,headers:n})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(Response.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});let getSearch=t=>{if(t.search)return t.search;let r=t.href.length-1,a=t.hash||("#"===t.href[r]?"#":"");return"?"===t.href[r-a.length]?"?":""};function stripURLForUseAsAReferrer(t,r=!1){return null==t?"no-referrer":(t=new URL(t),/^(about|blob|data):$/.test(t.protocol))?"no-referrer":(t.username="",t.password="",t.hash="",r&&(t.pathname="",t.search=""),t)}let K=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]);function validateReferrerPolicy(t){if(!K.has(t))throw TypeError(`Invalid referrerPolicy: ${t}`);return t}function isOriginPotentiallyTrustworthy(t){if(/^(http|ws)s:$/.test(t.protocol))return!0;let r=t.host.replace(/(^\[)|(]$)/g,""),a=d.isIP(r);return!!(4===a&&/^127\./.test(r)||6===a&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(r))||!("localhost"===t.host||t.host.endsWith(".localhost"))&&"file:"===t.protocol}function isUrlPotentiallyTrustworthy(t){return!!(/^about:(blank|srcdoc)$/.test(t)||"data:"===t.protocol||/^(blob|filesystem):$/.test(t.protocol))||isOriginPotentiallyTrustworthy(t)}function determineRequestsReferrer(t,{referrerURLCallback:r,referrerOriginCallback:a}={}){if("no-referrer"===t.referrer||""===t.referrerPolicy)return null;let n=t.referrerPolicy;if("about:client"===t.referrer)return"no-referrer";let o=t.referrer,i=stripURLForUseAsAReferrer(o),s=stripURLForUseAsAReferrer(o,!0);i.toString().length>4096&&(i=s),r&&(i=r(i)),a&&(s=a(s));let l=new URL(t.url);switch(n){case"no-referrer":return"no-referrer";case"origin":return s;case"unsafe-url":return i;case"strict-origin":if(isUrlPotentiallyTrustworthy(i)&&!isUrlPotentiallyTrustworthy(l))return"no-referrer";return s.toString();case"strict-origin-when-cross-origin":if(i.origin===l.origin)return i;if(isUrlPotentiallyTrustworthy(i)&&!isUrlPotentiallyTrustworthy(l))return"no-referrer";return s;case"same-origin":if(i.origin===l.origin)return i;return"no-referrer";case"origin-when-cross-origin":if(i.origin===l.origin)return i;return s;case"no-referrer-when-downgrade":if(isUrlPotentiallyTrustworthy(i)&&!isUrlPotentiallyTrustworthy(l))return"no-referrer";return i;default:throw TypeError(`Invalid referrerPolicy: ${n}`)}}function parseReferrerPolicyFromHeader(t){let r=(t.get("referrer-policy")||"").split(/[,\s]+/),a="";for(let t of r)t&&K.has(t)&&(a=t);return a}let U=Symbol("Request internals"),isRequest=t=>"object"==typeof t&&"object"==typeof t[U],N=u.deprecate(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)");let Request=class Request extends Body{constructor(t,r={}){let a;if(isRequest(t)?a=new URL(t.url):(a=new URL(t),t={}),""!==a.username||""!==a.password)throw TypeError(`${a} is an url with embedded credentials.`);let n=r.method||t.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(n)&&(n=n.toUpperCase()),!isRequest(r)&&"data"in r&&N(),(null!=r.body||isRequest(t)&&null!==t.body)&&("GET"===n||"HEAD"===n))throw TypeError("Request with GET/HEAD method cannot have body");let o=r.body?r.body:isRequest(t)&&null!==t.body?clone(t):null;super(o,{size:r.size||t.size||0});let i=new Headers(r.headers||t.headers||{});if(null!==o&&!i.has("Content-Type")){let t=extractContentType(o,this);t&&i.set("Content-Type",t)}let s=isRequest(t)?t.signal:null;if("signal"in r&&(s=r.signal),null!=s&&!isAbortSignal(s))throw TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let l=null==r.referrer?t.referrer:r.referrer;if(""===l)l="no-referrer";else if(l){let t=new URL(l);l=/^about:(\/\/)?client$/.test(t)?"client":t}else l=void 0;this[U]={method:n,redirect:r.redirect||t.redirect||"follow",headers:i,parsedURL:a,signal:s,referrer:l},this.follow=void 0===r.follow?void 0===t.follow?20:t.follow:r.follow,this.compress=void 0===r.compress?void 0===t.compress||t.compress:r.compress,this.counter=r.counter||t.counter||0,this.agent=r.agent||t.agent,this.highWaterMark=r.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=r.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=r.referrerPolicy||t.referrerPolicy||""}get method(){return this[U].method}get url(){return c.format(this[U].parsedURL)}get headers(){return this[U].headers}get redirect(){return this[U].redirect}get signal(){return this[U].signal}get referrer(){return"no-referrer"===this[U].referrer?"":"client"===this[U].referrer?"about:client":this[U].referrer?this[U].referrer.toString():void 0}get referrerPolicy(){return this[U].referrerPolicy}set referrerPolicy(t){this[U].referrerPolicy=validateReferrerPolicy(t)}clone(){return new Request(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Request.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});let getNodeRequestOptions=t=>{let{parsedURL:r}=t[U],a=new Headers(t[U].headers);a.has("Accept")||a.set("Accept","*/*");let n=null;if(null===t.body&&/^(post|put)$/i.test(t.method)&&(n="0"),null!==t.body){let r=getTotalBytes(t);"number"!=typeof r||Number.isNaN(r)||(n=String(r))}n&&a.set("Content-Length",n),""===t.referrerPolicy&&(t.referrerPolicy="strict-origin-when-cross-origin"),t.referrer&&"no-referrer"!==t.referrer?t[U].referrer=determineRequestsReferrer(t):t[U].referrer="no-referrer",t[U].referrer instanceof URL&&a.set("Referer",t.referrer),a.has("User-Agent")||a.set("User-Agent","node-fetch"),t.compress&&!a.has("Accept-Encoding")&&a.set("Accept-Encoding","gzip, deflate, br");let{agent:o}=t;"function"==typeof o&&(o=o(r)),a.has("Connection")||o||a.set("Connection","close");let i=getSearch(r),s={path:r.pathname+i,method:t.method,headers:a[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:t.insecureHTTPParser,agent:o};return{parsedURL:r,options:s}};let AbortError=class AbortError extends FetchBaseError{constructor(t,r="aborted"){super(t,r)}};/*! node-domexception. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */if(!globalThis.DOMException)try{let{MessageChannel:t}=a(71267),r=new t().port1,n=new ArrayBuffer;r.postMessage(n,[n,n])}catch(t){"DOMException"===t.constructor.name&&(globalThis.DOMException=t.constructor)}var L=globalThis.DOMException;let D=new Set(["data:","http:","https:"]);async function fetch(t,r){return new Promise((a,l)=>{let u=new Request(t,r),{parsedURL:c,options:d}=getNodeRequestOptions(u);if(!D.has(c.protocol))throw TypeError(`node-fetch cannot load ${t}. URL scheme "${c.protocol.replace(/:$/,"")}" is not supported.`);if("data:"===c.protocol){let t=dataUriToBuffer(u.url),r=new Response(t,{headers:{"Content-Type":t.typeFull}});a(r);return}let h=("https:"===c.protocol?o:n).request,{signal:p}=u,m=null,abort=()=>{let t=new AbortError("The operation was aborted.");l(t),u.body&&u.body instanceof s.Readable&&u.body.destroy(t),m&&m.body&&m.body.emit("error",t)};if(p&&p.aborted){abort();return}let abortAndFinalize=()=>{abort(),finalize()},y=h(c.toString(),d);p&&p.addEventListener("abort",abortAndFinalize);let finalize=()=>{y.abort(),p&&p.removeEventListener("abort",abortAndFinalize)};y.on("error",t=>{l(new FetchError(`request to ${u.url} failed, reason: ${t.message}`,"system",t)),finalize()}),fixResponseChunkedTransferBadEnding(y,t=>{m&&m.body&&m.body.destroy(t)}),process.version<"v14"&&y.on("socket",t=>{let r;t.prependListener("end",()=>{r=t._eventsCount}),t.prependListener("close",a=>{if(m&&r<t._eventsCount&&!a){let t=Error("Premature close");t.code="ERR_STREAM_PREMATURE_CLOSE",m.body.emit("error",t)}})}),y.on("response",t=>{y.setTimeout(0);let n=fromRawHeaders(t.rawHeaders);if(isRedirect(t.statusCode)){let o=n.get("Location"),i=null;try{i=null===o?null:new URL(o,u.url)}catch{if("manual"!==u.redirect){l(new FetchError(`uri requested responds with an invalid redirect URL: ${o}`,"invalid-redirect")),finalize();return}}switch(u.redirect){case"error":l(new FetchError(`uri requested responds with a redirect, redirect mode is set to error: ${u.url}`,"no-redirect")),finalize();return;case"manual":break;case"follow":{if(null===i)break;if(u.counter>=u.follow){l(new FetchError(`maximum redirect reached at: ${u.url}`,"max-redirect")),finalize();return}let o={headers:new Headers(u.headers),follow:u.follow,counter:u.counter+1,agent:u.agent,compress:u.compress,method:u.method,body:clone(u),signal:u.signal,size:u.size,referrer:u.referrer,referrerPolicy:u.referrerPolicy};if(!isDomainOrSubdomain(u.url,i)||!isSameProtocol(u.url,i))for(let t of["authorization","www-authenticate","cookie","cookie2"])o.headers.delete(t);if(303!==t.statusCode&&u.body&&r.body instanceof s.Readable){l(new FetchError("Cannot follow redirect with body being a readable stream","unsupported-redirect")),finalize();return}(303===t.statusCode||(301===t.statusCode||302===t.statusCode)&&"POST"===u.method)&&(o.method="GET",o.body=void 0,o.headers.delete("content-length"));let c=parseReferrerPolicyFromHeader(n);c&&(o.referrerPolicy=c),a(fetch(new Request(i,o))),finalize();return}default:return l(TypeError(`Redirect option '${u.redirect}' is not a valid value of RequestRedirect`))}}p&&t.once("end",()=>{p.removeEventListener("abort",abortAndFinalize)});let o=s.pipeline(t,new s.PassThrough,t=>{t&&l(t)});process.version<"v12.10"&&t.on("aborted",abortAndFinalize);let c={url:u.url,status:t.statusCode,statusText:t.statusMessage,headers:n,size:u.size,counter:u.counter,highWaterMark:u.highWaterMark},d=n.get("Content-Encoding");if(!u.compress||"HEAD"===u.method||null===d||204===t.statusCode||304===t.statusCode){a(m=new Response(o,c));return}let h={flush:i.Z_SYNC_FLUSH,finishFlush:i.Z_SYNC_FLUSH};if("gzip"===d||"x-gzip"===d){a(m=new Response(o=s.pipeline(o,i.createGunzip(h),t=>{t&&l(t)}),c));return}if("deflate"===d||"x-deflate"===d){let r=s.pipeline(t,new s.PassThrough,t=>{t&&l(t)});r.once("data",t=>{a(m=new Response(o=(15&t[0])==8?s.pipeline(o,i.createInflate(),t=>{t&&l(t)}):s.pipeline(o,i.createInflateRaw(),t=>{t&&l(t)}),c))}),r.once("end",()=>{m||a(m=new Response(o,c))});return}if("br"===d){a(m=new Response(o=s.pipeline(o,i.createBrotliDecompress(),t=>{t&&l(t)}),c));return}a(m=new Response(o,c))}),writeToStream(y,u).catch(l)})}function fixResponseChunkedTransferBadEnding(t,r){let a;let n=l.Buffer.from("0\r\n\r\n"),o=!1,i=!1;t.on("response",t=>{let{headers:r}=t;o="chunked"===r["transfer-encoding"]&&!r["content-length"]}),t.on("socket",s=>{let onSocketClose=()=>{if(o&&!i){let t=Error("Premature close");t.code="ERR_STREAM_PREMATURE_CLOSE",r(t)}},onData=t=>{(i=0===l.Buffer.compare(t.slice(-5),n))||!a||(i=0===l.Buffer.compare(a.slice(-3),n.slice(0,3))&&0===l.Buffer.compare(t.slice(-2),n.slice(3))),a=t};s.prependListener("close",onSocketClose),s.on("data",onData),t.on("close",()=>{s.removeListener("close",onSocketClose),s.removeListener("data",onData)})})}/**
 * @author Toru Nagashima <https://github.com/mysticatea>
 * @copyright 2015 Toru Nagashima. All rights reserved.
 * See LICENSE file in root directory for full license.
 */let j=new WeakMap,W=new WeakMap;function pd(t){let r=j.get(t);return console.assert(null!=r,"'this' is expected an Event object, but got",t),r}function setCancelFlag(t){if(null!=t.passiveListener){"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",t.passiveListener);return}t.event.cancelable&&(t.canceled=!0,"function"==typeof t.event.preventDefault&&t.event.preventDefault())}function Event(t,r){j.set(this,{eventTarget:t,event:r,eventPhase:2,currentTarget:t,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:r.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let a=Object.keys(r);for(let t=0;t<a.length;++t){let r=a[t];r in this||Object.defineProperty(this,r,defineRedirectDescriptor(r))}}function defineRedirectDescriptor(t){return{get(){return pd(this).event[t]},set(r){pd(this).event[t]=r},configurable:!0,enumerable:!0}}function defineCallDescriptor(t){return{value(){let r=pd(this).event;return r[t].apply(r,arguments)},configurable:!0,enumerable:!0}}function defineWrapper(t,r){let a=Object.keys(r);if(0===a.length)return t;function CustomEvent(r,a){t.call(this,r,a)}CustomEvent.prototype=Object.create(t.prototype,{constructor:{value:CustomEvent,configurable:!0,writable:!0}});for(let n=0;n<a.length;++n){let o=a[n];if(!(o in t.prototype)){let t=Object.getOwnPropertyDescriptor(r,o),a="function"==typeof t.value;Object.defineProperty(CustomEvent.prototype,o,a?defineCallDescriptor(o):defineRedirectDescriptor(o))}}return CustomEvent}function getWrapper(t){if(null==t||t===Object.prototype)return Event;let r=W.get(t);return null==r&&(r=defineWrapper(getWrapper(Object.getPrototypeOf(t)),t),W.set(t,r)),r}function wrapEvent(t,r){let a=getWrapper(Object.getPrototypeOf(r));return new a(t,r)}function isStopped(t){return pd(t).immediateStopped}function setEventPhase(t,r){pd(t).eventPhase=r}function setCurrentTarget(t,r){pd(t).currentTarget=r}function setPassiveListener(t,r){pd(t).passiveListener=r}Event.prototype={get type(){return pd(this).event.type},get target(){return pd(this).eventTarget},get currentTarget(){return pd(this).currentTarget},composedPath(){let t=pd(this).currentTarget;return null==t?[]:[t]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return pd(this).eventPhase},stopPropagation(){let t=pd(this);t.stopped=!0,"function"==typeof t.event.stopPropagation&&t.event.stopPropagation()},stopImmediatePropagation(){let t=pd(this);t.stopped=!0,t.immediateStopped=!0,"function"==typeof t.event.stopImmediatePropagation&&t.event.stopImmediatePropagation()},get bubbles(){return!!pd(this).event.bubbles},get cancelable(){return!!pd(this).event.cancelable},preventDefault(){setCancelFlag(pd(this))},get defaultPrevented(){return pd(this).canceled},get composed(){return!!pd(this).event.composed},get timeStamp(){return pd(this).timeStamp},get srcElement(){return pd(this).eventTarget},get cancelBubble(){return pd(this).stopped},set cancelBubble(value){if(!value)return;let t=pd(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)},get returnValue(){return!pd(this).canceled},set returnValue(value){value||setCancelFlag(pd(this))},initEvent(){}},Object.defineProperty(Event.prototype,"constructor",{value:Event,configurable:!0,writable:!0});let q=new WeakMap;function isObject(t){return null!==t&&"object"==typeof t}function getListeners(t){let r=q.get(t);if(null==r)throw TypeError("'this' is expected an EventTarget object, but got another value.");return r}function defineEventAttributeDescriptor(t){return{get(){let r=getListeners(this),a=r.get(t);for(;null!=a;){if(3===a.listenerType)return a.listener;a=a.next}return null},set(r){"function"==typeof r||isObject(r)||(r=null);let a=getListeners(this),n=null,o=a.get(t);for(;null!=o;)3===o.listenerType?null!==n?n.next=o.next:null!==o.next?a.set(t,o.next):a.delete(t):n=o,o=o.next;if(null!==r){let o={listener:r,listenerType:3,passive:!1,once:!1,next:null};null===n?a.set(t,o):n.next=o}},configurable:!0,enumerable:!0}}function defineEventAttribute(t,r){Object.defineProperty(t,`on${r}`,defineEventAttributeDescriptor(r))}function defineCustomEventTarget(t){function CustomEventTarget(){EventTarget.call(this)}CustomEventTarget.prototype=Object.create(EventTarget.prototype,{constructor:{value:CustomEventTarget,configurable:!0,writable:!0}});for(let r=0;r<t.length;++r)defineEventAttribute(CustomEventTarget.prototype,t[r]);return CustomEventTarget}function EventTarget(){if(this instanceof EventTarget){q.set(this,new Map);return}if(1==arguments.length&&Array.isArray(arguments[0]))return defineCustomEventTarget(arguments[0]);if(arguments.length>0){let t=Array(arguments.length);for(let r=0;r<arguments.length;++r)t[r]=arguments[r];return defineCustomEventTarget(t)}throw TypeError("Cannot call a class as a function")}EventTarget.prototype={addEventListener(t,r,a){if(null==r)return;if("function"!=typeof r&&!isObject(r))throw TypeError("'listener' should be a function or an object.");let n=getListeners(this),o=isObject(a),i=o?!!a.capture:!!a,s=i?1:2,l={listener:r,listenerType:s,passive:o&&!!a.passive,once:o&&!!a.once,next:null},u=n.get(t);if(void 0===u){n.set(t,l);return}let c=null;for(;null!=u;){if(u.listener===r&&u.listenerType===s)return;c=u,u=u.next}c.next=l},removeEventListener(t,r,a){if(null==r)return;let n=getListeners(this),o=isObject(a)?!!a.capture:!!a,i=o?1:2,s=null,l=n.get(t);for(;null!=l;){if(l.listener===r&&l.listenerType===i){null!==s?s.next=l.next:null!==l.next?n.set(t,l.next):n.delete(t);return}s=l,l=l.next}},dispatchEvent(t){if(null==t||"string"!=typeof t.type)throw TypeError('"event.type" should be a string.');let r=getListeners(this),a=t.type,n=r.get(a);if(null==n)return!0;let o=wrapEvent(this,t),i=null;for(;null!=n;){if(n.once?null!==i?i.next=n.next:null!==n.next?r.set(a,n.next):r.delete(a):i=n,setPassiveListener(o,n.passive?n.listener:null),"function"==typeof n.listener)try{n.listener.call(this,o)}catch(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t)}else 3!==n.listenerType&&"function"==typeof n.listener.handleEvent&&n.listener.handleEvent(o);if(isStopped(o))break;n=n.next}return setPassiveListener(o,null),setEventPhase(o,0),setCurrentTarget(o,null),!o.defaultPrevented}},Object.defineProperty(EventTarget.prototype,"constructor",{value:EventTarget,configurable:!0,writable:!0});let AbortSignal=class AbortSignal extends EventTarget{constructor(){throw super(),TypeError("AbortSignal cannot be constructed directly")}get aborted(){let t=H.get(this);if("boolean"!=typeof t)throw TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`);return t}};function createAbortSignal(){let t=Object.create(AbortSignal.prototype);return EventTarget.call(t),H.set(t,!1),t}function abortSignal(t){!1===H.get(t)&&(H.set(t,!0),t.dispatchEvent({type:"abort"}))}defineEventAttribute(AbortSignal.prototype,"abort");let H=new WeakMap;Object.defineProperties(AbortSignal.prototype,{aborted:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(AbortSignal.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});let AbortController$1=class AbortController$1{constructor(){M.set(this,createAbortSignal())}get signal(){return getSignal(this)}abort(){abortSignal(getSignal(this))}};let M=new WeakMap;function getSignal(t){let r=M.get(t);if(null==r)throw TypeError(`Expected 'this' to be an 'AbortController' object, but got ${null===t?"null":typeof t}`);return r}Object.defineProperties(AbortController$1.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(AbortController$1.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"}),r.AbortController=AbortController$1,r.AbortError=AbortError,r.FetchError=FetchError,r.File=b,r.FormData=_,r.Headers=Headers,r.Request=Request,r.Response=Response,r._Blob=g,r.fetch=fetch,r.isRedirect=isRedirect,r.nodeDomexception=L},88829:(t,r,a)=>{let n=a(81448);function fetch(t,r){return n.fetch(t,r)}for(let t in n)fetch[t]=n[t];t.exports=fetch},46867:(t,r,a)=>{function _interop_require_default(t){return t&&t.__esModule?t:{default:t}}a.r(r),a.d(r,{_:()=>_interop_require_default,_interop_require_default:()=>_interop_require_default})},90919:(t,r,a)=>{a.d(r,{gn:()=>__decorate,pi:()=>__assign});var extendStatics=function(t,r){return(Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])})(t,r)},__assign=function(){return(__assign=Object.assign||function(t){for(var r,a=1,n=arguments.length;a<n;a++)for(var o in r=arguments[a])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t}).apply(this,arguments)};function __decorate(t,r,a,n){var o,i=arguments.length,s=i<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,r,a,n);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(i<3?o(s):i>3?o(r,a,s):o(r,a))||s);return i>3&&s&&Object.defineProperty(r,a,s),s}Object.create;Object.create,"function"==typeof SuppressedError&&SuppressedError}};